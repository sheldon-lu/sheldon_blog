<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Kubernetes_Istio-Gateway_Ingress-Controller</title>
      <link href="/sheldon_blog/passages/Kubernetes-Istio-Gateway-Ingress-Controller/"/>
      <url>/sheldon_blog/passages/Kubernetes-Istio-Gateway-Ingress-Controller/</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近在istio，然后想总结下ingress-controller和istio-gateway的区别。</p><p>在Kubernetes环境中，Kubernetes Ingress用于配置需要在集群外部公开的服务。</p><p>但是在Istio服务网格中，更好的方法是使用新的配置模型，即Istio Gateway；Gateway允许将Istio流量管理的功能应用于进入集群的流量。</p><p>这里的ingress为nginx ingress</p></blockquote><p>通过灰度发布，来看一下ingress与istio的实现方式的差异</p><h3 id="环境准备："><a href="#环境准备：" class="headerlink" title="环境准备："></a>环境准备：</h3><blockquote><p>kubernetes环境     1.13.5</p><p>部署istio                 1.1.1</p></blockquote><h3 id="Istio："><a href="#Istio：" class="headerlink" title="Istio："></a>Istio：</h3><blockquote><p>部署两个服务：</p><p>old</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    matchLabels:</span></span><br><span class="line"><span class="attr">      run:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">  template:</span></span><br><span class="line"><span class="attr">    metadata:</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">        run:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">    spec:</span></span><br><span class="line"><span class="attr">      containers:</span></span><br><span class="line"><span class="attr">      - image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/xxxxx/old-nginx</span></span><br><span class="line"><span class="attr">        imagePullPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">        name:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="attr">        - containerPort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">          protocol:</span> <span class="string">TCP</span></span><br><span class="line"><span class="attr">      restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="attr">  - port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">    protocol:</span> <span class="string">TCP</span></span><br><span class="line"><span class="attr">    targetPort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    run:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">  sessionAffinity:</span> <span class="string">None</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure><blockquote><p>new</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    matchLabels:</span></span><br><span class="line"><span class="attr">      run:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">  template:</span></span><br><span class="line"><span class="attr">    metadata:</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">        run:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">    spec:</span></span><br><span class="line"><span class="attr">      containers:</span></span><br><span class="line"><span class="attr">      - image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/xxxxx/new-nginx</span></span><br><span class="line"><span class="attr">        imagePullPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">        name:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="attr">        - containerPort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">          protocol:</span> <span class="string">TCP</span></span><br><span class="line"><span class="attr">      restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="attr">  - port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">    protocol:</span> <span class="string">TCP</span></span><br><span class="line"><span class="attr">    targetPort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    run:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">  sessionAffinity:</span> <span class="string">None</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure><blockquote><p>输出</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> kubectl get svc</span><br><span class="line">NAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE</span><br><span class="line">kubernetes   ClusterIP   172.19.0.1      &lt;none&gt;        443/TCP        9h</span><br><span class="line">new-nginx    NodePort    172.19.8.168    &lt;none&gt;        80:31904/TCP   4h</span><br><span class="line">old-nginx    NodePort    172.19.12.148   &lt;none&gt;        80:31545/TCP   4h</span><br></pre></td></tr></table></figure><blockquote><p>测试两个服务</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> kubectl run -it --rm bash --image=appropriate/curl --restart=Never curl 172.19.8.168</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> kubectl run -it --rm bash --image=appropriate/curl --restart=Never curl 172.19.12.148</span><br><span class="line">old</span><br></pre></td></tr></table></figure><blockquote><p>创建Gateway对象/用的istio官方yaml</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Gateway</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">helloworld-gateway</span> <span class="comment"># name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    istio:</span> <span class="string">ingressgateway</span>  <span class="comment"># use istio default controller</span></span><br><span class="line"><span class="attr">  servers:</span></span><br><span class="line"><span class="attr">  - port:</span></span><br><span class="line"><span class="attr">      number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">http</span></span><br><span class="line"><span class="attr">      protocol:</span> <span class="string">HTTP</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">"*"</span></span><br></pre></td></tr></table></figure><blockquote><p>确定Istio入口IP和port</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> kubectl get svc istio-ingressgateway -n istio-system</span><br><span class="line">NAME                   TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)                                      AGE</span><br><span class="line">istio-ingressgateway   LoadBalancer   172.19.14.182   (pending)   80:31380/TCP,443:31390/TCP,31400:31400/...   10h</span><br></pre></td></tr></table></figure><blockquote><p>确认<code>EXTERNAL-IP</code>设置了值</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export INGRESS_HOST= $(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='&#123;.status.loadBalancer.ingress[0].ip&#125;')</span><br><span class="line">export INGRESS_PORT= $(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='&#123;.spec.ports[?(@.name=="http")].port&#125;')</span><br><span class="line">export SECURE_INGRESS_PORT= $(kubectl -n istio-system get service istio-ingressgateway -o jsonpath='&#123;.spec.ports[?(@.name=="https")].port&#125;')</span><br></pre></td></tr></table></figure><blockquote><p>满足特定规则：</p><p>例如，我们希望请求头中带有user且值为new的客户端请求才能访问new service</p><p>我们可以创建一个对应的<code>VirtualService</code>为通过<code>Gateway</code>进入的流量配置路由</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span>   <span class="comment"># istio route rule </span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">helloworld</span>     <span class="comment"># name</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  gateways:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">helloworld-gateway</span> <span class="comment"># link Gateway</span></span><br><span class="line"><span class="attr">  hosts:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'*'</span></span><br><span class="line"><span class="attr">  http:</span></span><br><span class="line"><span class="attr">  - match:</span></span><br><span class="line"><span class="attr">    - headers:</span></span><br><span class="line"><span class="attr">        user:</span></span><br><span class="line"><span class="attr">          exact:</span> <span class="string">new</span>       <span class="comment"># match headers -&gt; user (-&gt; exact -&gt;) new  [headers: user: new]</span></span><br><span class="line"><span class="attr">    route:</span>                 <span class="comment"># 会访问new-nginx，满足头部要求即可</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">  - route:</span>                 <span class="comment"># 否则就访问old-nginx</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><blockquote><p>客户端测试</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br></pre></td></tr></table></figure><blockquote><p>在满足特定规则和权重：</p><p>例如，我们希望请求头中带有user且值为new的客户端请求有50%的比例访问new service，那么我们可以创建一个这样的<code>VirtualService</code></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">helloworld</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  gateways:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">helloworld-gateway</span></span><br><span class="line"><span class="attr">  hosts:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'*'</span></span><br><span class="line"><span class="attr">  http:</span></span><br><span class="line"><span class="attr">  - match:</span></span><br><span class="line"><span class="attr">    - headers:</span></span><br><span class="line"><span class="attr">        user:</span></span><br><span class="line"><span class="attr">          exact:</span> <span class="string">new</span>          <span class="comment"># 这里跟上面的一样，符合头部 user: new就会访问到这一层</span></span><br><span class="line"><span class="attr">    route:</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      weight:</span> <span class="number">50</span>              </span><br><span class="line">                             <span class="comment"># 另外因为这里设置了两个访问规则，即首先符合头部，然后会有50%的几率会访问到new-nginx，另外50%会访问到old-nginx</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      weight:</span> <span class="number">50</span></span><br><span class="line"><span class="attr">  - route:</span>                    <span class="comment"># 如果不匹配头部，那就全部访问到old-nginx</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><blockquote><p>客户端测试</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br><span class="line"><span class="meta">$</span> curl -H "user: new" http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br></pre></td></tr></table></figure><blockquote><p>权重随机访问：</p><p>例如，我们仅仅希望20%的客户端请求访问new service，那么我们可以创建一个这样的<code>VirtualService</code></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">helloworld</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  gateways:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">helloworld-gateway</span></span><br><span class="line"><span class="attr">  hosts:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'*'</span></span><br><span class="line"><span class="attr">  http:</span></span><br><span class="line"><span class="attr">  - route:</span>                        </span><br><span class="line">  <span class="comment"># 这条virtual Service 设置了权重来几率性访问nginx；20%new-nginx，80% old-nginx</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      weight:</span> <span class="number">20</span></span><br><span class="line"><span class="attr">    - destination:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">        port:</span></span><br><span class="line"><span class="attr">          number:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">      weight:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure><p>客户端测试</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">old</span><br><span class="line"><span class="meta">$</span> curl http://$INGRESS_HOST:$INGRESS_PORT</span><br><span class="line">new</span><br></pre></td></tr></table></figure><h3 id="Nginx-Ingress"><a href="#Nginx-Ingress" class="headerlink" title="Nginx Ingress"></a>Nginx Ingress</h3><blockquote><p>不支持权重，貌似能够支持headers头</p></blockquote><p>Nginx:</p><blockquote><p>使用$http_ 获取http请求的header，根据配置中是否为完整或者正则匹配，匹配foo的值</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    ....</span><br><span class="line">    if ($http_foo = "bar") &#123;  //完全匹配</span><br><span class="line">    #if ($http_foo ~ "bar") &#123;  //正则匹配</span><br><span class="line">           proxy_pass http://default-new-nginx-80;</span><br><span class="line">           break;</span><br><span class="line">    &#125;</span><br><span class="line">    proxy_pass http://default-old-nginx-80;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>使用$cookie_获取http请求的cookie，根据配置中是否为完整或者正则匹配，匹配foo的值</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    ....</span><br><span class="line">    if ($cookie_foo ~ "^bar") &#123;  //正则匹配</span><br><span class="line">    # if ($cookie_foo = "bar") &#123;  //完全匹配</span><br><span class="line">         proxy_pass http://default-new-nginx-80;</span><br><span class="line">         break;</span><br><span class="line">    &#125;</span><br><span class="line">    proxy_pass http://default-old-nginx-80;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><blockquote><p>使用$arg_获取http的请求参数，根据配置中是否为完整或者正则匹配，匹配foo的值</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    ....</span><br><span class="line">    if ($arg_foo ~ "^bar") &#123;  //正则匹配</span><br><span class="line">    # if ($arg_foo = "bar") &#123;  //完全匹配</span><br><span class="line">         proxy_pass http://default-new-nginx-80;</span><br><span class="line">         break;</span><br><span class="line">    &#125;</span><br><span class="line">    proxy_pass http://default-old-nginx-80;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>这里用到的两个服务为istio用的两个服务：</p><blockquote><p>应用部署完毕后，我们看要怎么配置ingress才能够正确的刷新到ngixn.conf，在nginx-ingress-controller中，它支持 nginx.ingress.kubernetes.io/configuration-snippet 这样一个注解允许我们在location里配置自定义需求。同时结合nginx-ingress-controller的upstream命名方式namespace-serviceName-port的方式配置注解信息。如下ingress yaml所示:</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">extensions/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  annotations:</span></span><br><span class="line">    <span class="string">nginx.ingress.kubernetes.io/configuration-snippet:</span> <span class="string">|</span></span><br><span class="line"><span class="string">       if ($http_foo ~ "^.*bar$") &#123;</span></span><br><span class="line"><span class="string">         proxy_pass http://default-new-nginx-80;</span></span><br><span class="line"><span class="string">         break;</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string"></span><span class="attr">  name:</span> <span class="string">gray-release</span></span><br><span class="line"><span class="attr">  namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  rules:</span></span><br><span class="line"><span class="attr">    - host:</span> <span class="string">www.example.com</span></span><br><span class="line"><span class="attr">      http:</span></span><br><span class="line"><span class="attr">        paths:</span></span><br><span class="line"><span class="attr">          - backend:</span></span><br><span class="line"><span class="attr">              serviceName:</span> <span class="string">old-nginx</span></span><br><span class="line"><span class="attr">              servicePort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">            path:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">          - backend:</span></span><br><span class="line"><span class="attr">              serviceName:</span> <span class="string">new-nginx</span></span><br><span class="line"><span class="attr">              servicePort:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">            path:</span> <span class="string">/</span></span><br></pre></td></tr></table></figure><blockquote><p>输出</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> curl -H "Host: www.example.com"  http://172.16.0.9</span><br><span class="line">old</span><br><span class="line"> curl -H "Host: www.example.com"  http://172.16.0.9</span><br><span class="line">old</span><br><span class="line"> curl -H "Host: www.example.com"  http://172.16.0.9</span><br><span class="line">old</span><br><span class="line"> curl -H "Host: www.example.com" -H "foo: bar" http://172.16.0.9</span><br><span class="line">new</span><br><span class="line"> curl -H "Host: www.example.com" -H "foo: bar" http://172.16.0.9</span><br><span class="line">new</span><br><span class="line"> curl -H "Host: www.example.com" -H "foo: bar" http://172.16.0.9</span><br><span class="line">new</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> Istio </tag>
            
            <tag> Ingress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes_1.13.5_ingress</title>
      <link href="/sheldon_blog/passages/Kubernetes-1-13-5%E9%83%A8%E7%BD%B2ingress/"/>
      <url>/sheldon_blog/passages/Kubernetes-1-13-5%E9%83%A8%E7%BD%B2ingress/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes部署mysql-opreator</title>
      <link href="/sheldon_blog/passages/Kubernetes%E9%83%A8%E7%BD%B2mysql-opreator/"/>
      <url>/sheldon_blog/passages/Kubernetes%E9%83%A8%E7%BD%B2mysql-opreator/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> kubernetes_problem </tag>
            
            <tag> kubernetes-opreator </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes安装-kubeadm_1.13.5(非外部etcd)</title>
      <link href="/sheldon_blog/passages/Kubernetes%E5%AE%89%E8%A3%85-kubeadm-1-13-5-%E9%9D%9E%E5%A4%96%E9%83%A8etcd/"/>
      <url>/sheldon_blog/passages/Kubernetes%E5%AE%89%E8%A3%85-kubeadm-1-13-5-%E9%9D%9E%E5%A4%96%E9%83%A8etcd/</url>
      
        <content type="html"><![CDATA[<blockquote><p>之前写过一篇kubernetes安装的，用到的是外部的etcd，即etcd单独二进制安装，kubeadm初始化指定即可；</p><p>本篇用的纯kubeadm安装高可用集群，master组件静态pod</p></blockquote><h2 id="环境描述"><a href="#环境描述" class="headerlink" title="环境描述"></a>环境描述</h2><blockquote><p>kubernetes version：1.13.5</p><p>docker version：18.6.3</p><p>Redhat：7.6</p></blockquote><a id="more"></a><table><thead><tr><th style="text-align:left">x.x.x.1</th><th style="text-align:center">master-1</th><th>kube-apiserver、kube-controller-manager、kube-scheduler、etcd、keepalive、docker</th></tr></thead><tbody><tr><td style="text-align:left"><strong>x.x.x.2</strong></td><td style="text-align:center"><strong>master-2</strong></td><td><strong>kube-apiserver、kube-controller-manager、kube-scheduler、etcd、keepalive、docker</strong></td></tr><tr><td style="text-align:left"><strong>x.x.x.3</strong></td><td style="text-align:center"><strong>master-3</strong></td><td><strong>kube-apiserver、kube-controller-manager、kube-scheduler、etcd、keepalive、docker</strong></td></tr><tr><td style="text-align:left"><strong>x.x.x.4</strong></td><td style="text-align:center"><strong>vip</strong></td><td></td></tr><tr><td style="text-align:left"><strong>x.x.x.5</strong></td><td style="text-align:center"><strong>node-1</strong></td><td><strong>kubelet、docker</strong></td></tr><tr><td style="text-align:left"><strong>x.x.x.6</strong></td><td style="text-align:center"><strong>node-2</strong></td><td><strong>kubelet、docker</strong></td></tr></tbody></table><p>因为担心kubeadm起来的etcd不稳定，这里用到的etcd对于kubernetes来说作为外部etcd集群。即使用二进制安装etcd集群，其余组件用kubeadm来完成安装。</p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="1、准备工作"><a href="#1、准备工作" class="headerlink" title="1、准备工作"></a>1、准备工作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">echo "1" &gt; /proc/sys/net/bridge/bridge-nf-call-iptables</span><br><span class="line"><span class="meta">#</span> 停防火墙</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta">#</span> 关闭Swap</span><br><span class="line">swapoff -a</span><br><span class="line">sed 's/.*swap.*/#&amp;/' /etc/fstab</span><br><span class="line"><span class="meta">#</span> 关闭防火墙</span><br><span class="line">systemctl disable firewalld &amp;&amp; systemctl stop firewalld &amp;&amp; systemctl status firewalld</span><br><span class="line"><span class="meta">#</span> 关闭Selinux</span><br><span class="line">setenforce  0</span><br><span class="line">sed -i "s/^SELINUX=enforcing/SELINUX=disabled/g" /etc/sysconfig/selinux</span><br><span class="line">sed -i "s/^SELINUX=enforcing/SELINUX=disabled/g" /etc/selinux/config</span><br><span class="line">sed -i "s/^SELINUX=permissive/SELINUX=disabled/g" /etc/sysconfig/selinux</span><br><span class="line">sed -i "s/^SELINUX=permissive/SELINUX=disabled/g" /etc/selinux/config</span><br></pre></td></tr></table></figure><h3 id="2、docker安装"><a href="#2、docker安装" class="headerlink" title="2、docker安装"></a>2、docker安装</h3><h4 id="1、下载设置源"><a href="#1、下载设置源" class="headerlink" title="1、下载设置源"></a>1、下载设置源</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils \</span><br><span class="line">  device-mapper-persistent-data \</span><br><span class="line">  lvm2</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line">https://download.daocloud.io/docker/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><h4 id="2、安装docker"><a href="#2、安装docker" class="headerlink" title="2、安装docker"></a>2、安装docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | sort -r  # 列出docker-ce的版本list</span><br><span class="line">yum install docker-ce-&lt;版本号&gt; -y # -y 安装docker需要的依赖，其中有个container-selinux的也可以单独下载</span><br><span class="line"><span class="meta">#</span> rpm -ivh container-selinux-2.33-1.git86f33cd.el7.noarch.rpm</span><br></pre></td></tr></table></figure><h4 id="3、启动docker"><a href="#3、启动docker" class="headerlink" title="3、启动docker"></a>3、启动docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line">docker version # 验证docker安装是否完成并启动成功</span><br></pre></td></tr></table></figure><h3 id="3、kubeadm-kubelet-kubectl安装"><a href="#3、kubeadm-kubelet-kubectl安装" class="headerlink" title="3、kubeadm/kubelet/kubectl安装"></a>3、kubeadm/kubelet/kubectl安装</h3><blockquote><p>各节点安装</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum install -y kubelet-1.13.5 kubeadm-1.13.5 kubectl-1.13.5 --disableexcludes=kubernetes  #禁用除kubernetes之外的仓库,要用 -y 参数，会自动安装kube-cni等插件</span><br><span class="line"></span><br><span class="line">systemctl start kubelet</span><br><span class="line">systemctl enable kubelet # kubeadm 要求kubelet保持开机自启状态</span><br></pre></td></tr></table></figure><h3 id="4、keepalive安装"><a href="#4、keepalive安装" class="headerlink" title="4、keepalive安装"></a>4、keepalive安装</h3><blockquote><p>master节点安装：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">yum install -y keepalived</span><br><span class="line">systemctl start keepalived</span><br><span class="line"></span><br><span class="line">vim /etc/keepalived/keepalived.conf</span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id LVS_k8s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_script CheckK8sMaster &#123;</span><br><span class="line">    script &quot;curl -k https://10.70.49.130:6443&quot;</span><br><span class="line">    interval 3</span><br><span class="line">    timeout 9</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface ens256 # 网卡</span><br><span class="line">    virtual_router_id 61</span><br><span class="line">    # 主节点权重最高 依次减少</span><br><span class="line">    priority 120</span><br><span class="line">    advert_int 1</span><br><span class="line">    #修改为本地IP </span><br><span class="line">    mcast_src_ip x.x.x.2</span><br><span class="line">    nopreempt</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass sqP05dQgMSlzrxHj</span><br><span class="line">    &#125;</span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">        x.x.x.1</span><br><span class="line">        #x.x.x.2</span><br><span class="line">        x.x.x.3</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        x.x.x.4</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        CheckK8sMaster</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="kubernetes部署"><a href="#kubernetes部署" class="headerlink" title="kubernetes部署"></a>kubernetes部署</h2><h4 id="1、master部署"><a href="#1、master部署" class="headerlink" title="1、master部署"></a>1、master部署</h4><blockquote><p>部署之前请确保下载好相关image，翻墙下载或者国内dockerhub下载kubernetes镜像</p></blockquote><h5 id="1、初始化master1"><a href="#1、初始化master1" class="headerlink" title="1、初始化master1"></a>1、初始化master1</h5><blockquote><p>创建master1的初始化配置文件,网络插件采用flannel，CIDR地址是 “10.244.0.0/16”，如下为1.13.5新版本配置文件。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; kubeadm-master.yaml &lt;&lt; EOF</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta1</span><br><span class="line">kind: InitConfiguration</span><br><span class="line">nodeRegistration:</span><br><span class="line">  name: 10.78.229.193        # 指定node name，kubectl get no会显示ip</span><br><span class="line">localAPIEndpoint:</span><br><span class="line">  advertiseAddress: x.x.x.1  # 本机ip，这里为x.x.x.1-3</span><br><span class="line">  bindPort: 6443</span><br><span class="line">---</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta1</span><br><span class="line">kind: ClusterConfiguration</span><br><span class="line">kubernetesVersion: v1.13.5   # kubernetes版本 对应下载的image</span><br><span class="line">imageRepository: k8s.gcr.io  # 自己修改为自己的镜像库名</span><br><span class="line"></span><br><span class="line">apiServer:</span><br><span class="line">  certSANs:</span><br><span class="line">  - "master1"</span><br><span class="line">  - "master2"</span><br><span class="line">  - "master3"</span><br><span class="line">  - "x.x.x.1"</span><br><span class="line">  - "x.x.x.2"</span><br><span class="line">  - "x.x.x.3"</span><br><span class="line">  - "x.x.x.4"</span><br><span class="line">  - "127.0.0.1"</span><br><span class="line"></span><br><span class="line">controlPlaneEndpoint: "x.x.x.4:8443" # 控制台ip指定，即vip 实现apiserver高可用</span><br><span class="line">etcd:</span><br><span class="line">  local:</span><br><span class="line">    dataDir: /var/lib/etcd     # 随意指定即可</span><br><span class="line">networking:</span><br><span class="line">  podSubnet: "10.244.0.0/16"</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 运行初始化命令即可，前提要把相关设置关闭，详情至准备工作</span><br><span class="line"><span class="meta">#</span> 其中在kubelet配置里加入--pod-infra-container-image 参数指定 pause私有镜像库镜像</span><br><span class="line">kubeadm init --config kubeadm-master.yaml</span><br></pre></td></tr></table></figure><blockquote><p>在初始化配置里，对于etcd有两种高可用的选项，一个使用内部etcd，一个使用外部etcd(独立搭建的etcd集群，而不是在初始化中搭建的)，两者初始化配置文件略有不同。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 使用内部etcd的话，初始化yaml文件中etcd配置如下：</span><br><span class="line">etcd:</span><br><span class="line">  local:</span><br><span class="line">    extraArgs:</span><br><span class="line">      listen-client-urls: "https://127.0.0.1:2379,https://x.x.x.x:2379"</span><br><span class="line">      advertise-client-urls: "https://x.x.x.x:2379"</span><br><span class="line">      listen-peer-urls: "https://x.x.x.x:2380"</span><br><span class="line">      initial-advertise-peer-urls: "https://x.x.x.x:2380"</span><br><span class="line">      initial-cluster: "master1.hanli.com=https://x.x.x.x:2380"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 使用外部etcd的话，</span><br><span class="line">etcd:    #ETCD的地址</span><br><span class="line">   external:</span><br><span class="line">     endpoints:</span><br><span class="line">     - https://x.x.x.1:2379</span><br><span class="line">     - https://x.x.x.2:2379</span><br><span class="line">     - https://x.x.x.3:2379</span><br></pre></td></tr></table></figure><blockquote><p>init初始化之后，如果成功会出现<code>join</code>，这时就可以运行一下命令</p><p>机器上的用户要使用<code>kubectl</code>来管理集群操作集群</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure><blockquote><p>验证命令</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kubectl get cs # 如下信息</span><br><span class="line">NAME                 STATUS    MESSAGE              ERROR</span><br><span class="line">controller-manager   Healthy   ok</span><br><span class="line">scheduler            Healthy   ok</span><br><span class="line">etcd-0               Healthy   &#123;"health": "true"&#125;</span><br><span class="line"></span><br><span class="line">kubectl get node # notReady 状态，是因为没有安装网络插件 Name成ip，可修改kubelet的启动参数即可</span><br><span class="line">NAME         STATUS       ROLES     AGE     VERSION</span><br><span class="line">master1     NotReady      master     1m      v1.13.5</span><br></pre></td></tr></table></figure><h5 id="2、启动flannel服务"><a href="#2、启动flannel服务" class="headerlink" title="2、启动flannel服务"></a>2、启动flannel服务</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br><span class="line"><span class="meta">#</span> flannel 默认会使用主机的第一张网卡，如果你有多张网卡，需要通过配置单独指定。修改 kube-flannel.yml 中的以下部分</span><br><span class="line">cat kube-flannel.yml </span><br><span class="line"> containers:</span><br><span class="line">      - name: kube-flannel</span><br><span class="line">        image: quay.io/coreos/flannel:v0.11.0-amd64 # 修改下自己私有镜像库的flannel镜像名</span><br><span class="line">        command:</span><br><span class="line">        - /opt/bin/flanneld</span><br><span class="line">        args:</span><br><span class="line">        - --ip-masq</span><br><span class="line">        - --kube-subnet-mgr</span><br><span class="line">        - --iface=ens33              #添加</span><br></pre></td></tr></table></figure><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f kube-flannel.yml # 创建pod，因为是ds的所以后续集群里面加节点就会自动启动flannel</span><br><span class="line">kubectl get node # 会发现 node状态变成了 Ready</span><br><span class="line">NAME         STATUS       ROLES     AGE     VERSION</span><br><span class="line">master1       Ready      master     10m      v1.13.5</span><br><span class="line"></span><br><span class="line">kubectl get po --all-namespaces</span><br><span class="line">NAMESPACE     NAME                                       READY   STATUS    RESTARTS   AGE</span><br><span class="line">kube-system   coredns-86c58d9df4-r59rv                   1/1     Running   0          59m</span><br><span class="line">kube-system   coredns-86c58d9df4-rbzx5                   1/1     Running   0          59m</span><br><span class="line">kube-system   kube-apiserver-master1                     1/1     Running   0          58m</span><br><span class="line">kube-system   kube-controller-manager-master1            1/1     Running   16         58m</span><br><span class="line">kube-system   kube-flannel-ds-amd64-229j2                1/1     Running   0          42m</span><br><span class="line">kube-system   kube-proxy-4wrg5                           1/1     Running   0          59m</span><br><span class="line">kube-system   kube-scheduler-master1                     1/1     Running   13         58m</span><br></pre></td></tr></table></figure><blockquote><p>不是running状态，就说明出错了，通过查看</p><p>描述：kubectl describe pod kube-scheduler-master.hanli.com -n kube-system</p><p>日志：kubectl logs kube-scheduler-master.hanli.com -n kube-system</p><p>flannel服务启动成功后，coredns也就会自动启动成功，状态为Running</p></blockquote><h5 id="3、初始化其他master节点"><a href="#3、初始化其他master节点" class="headerlink" title="3、初始化其他master节点"></a>3、初始化其他master节点</h5><blockquote><p>首先把master1上生成的ca证书等，拷贝到其他master节点上，最好免密，可使用pscp等批量任务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> #!/bin/bash</span><br><span class="line"><span class="meta">&gt;</span> #注意修改为自己的主机名</span><br><span class="line"><span class="meta">&gt;</span> export CONTROL_PLANE_IPS="master2 master3"  </span><br><span class="line"><span class="meta">&gt;</span> </span><br><span class="line"><span class="meta">&gt;</span> # 保证节点有/etc/kubernetes/pki目录</span><br><span class="line"><span class="meta">&gt;</span> # 把以下证书复制到其他master节点</span><br><span class="line"><span class="meta">&gt;</span> for host in $&#123;CONTROL_PLANE_IPS&#125;; do</span><br><span class="line"><span class="meta">&gt;</span> # ！！！修正拷贝证书的时候请指定特定证书拷贝（之前的已经备注，新加的有etcd目录，没有用外部etcd集群），因为在证书拷贝的情况下吃过亏，因此修改此处！！！</span><br><span class="line"><span class="meta">&gt;</span> # 附issue：https://github.com/kubernetes/kubeadm/issues/1321 </span><br><span class="line"><span class="meta">&gt;</span> # 找了好久终于！！！哭</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/pki/*.crt $host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/pki/*.key $host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/pki/*.pub $host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/admin.conf $host:/etc/kubernetes/admin.conf</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/ca.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/sa.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/front-proxy-ca.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/etcd/ca.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/etcd/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/admin.conf "$&#123;USER&#125;"@$host:/etc/kubernetes/</span><br><span class="line"><span class="meta">&gt;</span> done</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> tree /etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> /etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-etcd-client.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-etcd-client.key</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver.key</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-kubelet-client.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-kubelet-client.key</span><br><span class="line"><span class="meta">&gt;</span> ├── ca.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── ca.key</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-ca.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-ca.key</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-client.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-client.key</span><br><span class="line"><span class="meta">&gt;</span> ├── sa.key</span><br><span class="line"><span class="meta">&gt;</span> └── sa.pub</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#</span> 分别修改对应ip 参数`--node-name`，在在master2、3执行master1出现的join命令即可 步骤如下：</span><br><span class="line"><span class="meta">#</span> 对于控制平面node 增加 `--experimental-control-plane` 即可，只有master node采用，更方便。当然还有复杂的通过原子操作来add etcd node 增加 etcd-cluster</span><br><span class="line">kubeadm join x.x.x.4:8443 --token bnnsb7.amapp1t78llxn54d --discovery-token-ca-cert-hash sha256:520ef89be84c30e480db6d441a7e4179634a9455f0009e249ebe8f35fa792087 --experimental-control-plane --node-name=x.x.x.2#(对应主机ip) </span><br><span class="line"><span class="meta">#</span> 等待kube-proxy flannel启动成功即可</span><br><span class="line"><span class="meta">#</span> 这种方案，kubectl get cs直观的看不到etcd集群的，可通过一下命令：</span><br><span class="line">kubectl exec -n kube-system etcd-x.x.x.1 -- etcdctl --ca-file /etc/kubernetes/pki/etcd/ca.crt --cert-file /etc/kubernetes/pki/etcd/peer.crt --key-file /etc/kubernetes/pki/etcd/peer.key --endpoints=https://x.x.x.1:2379 member list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 这里把master2、3节点采用原子操作加入etcd集群步骤写下来：</span><br><span class="line"><span class="meta">#</span> 配置证书</span><br><span class="line">kubeadm init phase certs all --config kubernetes.yaml </span><br><span class="line"><span class="meta">#</span> etcd证书</span><br><span class="line">kubeadm init phase etcd local --config kubernetes.yaml </span><br><span class="line"><span class="meta">#</span> 生成kubelet配置文件</span><br><span class="line">kubeadm init phase kubeconfig kubelet --config kubernetes.yaml </span><br><span class="line"><span class="meta">#</span> 启动kubelet</span><br><span class="line">kubeadm init phase kubelet-start --config kubernetes.yaml </span><br><span class="line"><span class="meta">#</span> 配置kubectl命令</span><br><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br><span class="line"><span class="meta">#</span> etcd集群加节点</span><br><span class="line">kubectl exec -n kube-system etcd-x.x.x.1 -- etcdctl --ca-file /etc/kubernetes/pki/etcd/ca.crt --cert-file /etc/kubernetes/pki/etcd/peer.crt --key-file /etc/kubernetes/pki/etcd/peer.key --endpoints=https://x.x.x.1:2379 member add etcd2 https://x.x.x.2:2380</span><br><span class="line"><span class="meta">#</span> 启动 kube-apiserver、kube-controller-manager、kube-scheduler</span><br><span class="line">kubeadm init phase kubeconfig all --config kubernetes.yaml</span><br><span class="line">kubeadm init phase control-plane all --config kubernetes.yaml</span><br><span class="line"><span class="meta">#</span> 标记master</span><br><span class="line">kubeadm init phase mark-control-plane --config kubernetes.yaml</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">kubectl get po -n kube-system</span><br><span class="line">NAME                                  READY     STATUS    RESTARTS   AGE</span><br><span class="line">coredns-9f9d9c76-4zrt4                  1/1     Running   0          2d</span><br><span class="line">coredns-9f9d9c76-dqd4c                  1/1     Running   0          2d</span><br><span class="line">kube-apiserver-zjjh-rq-k8s-1            1/1     Running   0          2d</span><br><span class="line">kube-apiserver-zjjh-rq-k8s-2            1/1     Running   0          2d</span><br><span class="line">kube-apiserver-zjjh-rq-k8s-3            1/1     Running   0          2d</span><br><span class="line">kube-controller-manager-zjjh-rq-k8s-1   1/1     Running   0          2d</span><br><span class="line">kube-controller-manager-zjjh-rq-k8s-2   1/1     Running   0          2d</span><br><span class="line">kube-controller-manager-zjjh-rq-k8s-3   1/1     Running   0          2d</span><br><span class="line">kube-flannel-ds-amd64-7ghn7             1/1     Running   1          2d</span><br><span class="line">kube-flannel-ds-amd64-9cqts             1/1     Running   0          2d</span><br><span class="line">kube-flannel-ds-amd64-f57nh             1/1     Running   1          2d</span><br><span class="line">kube-proxy-8fwts                        1/1     Running   0          2d</span><br><span class="line">kube-proxy-95tjb                        1/1     Running   0          2d</span><br><span class="line">kube-proxy-bls94                        1/1     Running   0          2d</span><br><span class="line">kube-scheduler-zjjh-rq-k8s-1            1/1     Running   0          2d</span><br><span class="line">kube-scheduler-zjjh-rq-k8s-2            1/1     Running   0          2d</span><br><span class="line">kube-scheduler-zjjh-rq-k8s-3            1/1     Running   0          2d</span><br><span class="line">kubernetes-dashboard-67d49f7868-x79wf   1/1     Running   0          76m</span><br></pre></td></tr></table></figure><h4 id="2、Work节点加入集群"><a href="#2、Work节点加入集群" class="headerlink" title="2、Work节点加入集群"></a>2、Work节点加入集群</h4><blockquote><p>输入master节点初始化成功之后出现的<code>join</code>命令，出现<code>kubectl get nodes</code>即成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> kubeadm join x.x.x.4:8443 --token bnnsb7.amapp1t78llxn54d --discovery-token-ca-cert-hash sha256:520ef89be84c30e480db6d441a7e4179634a9455f0009e249ebe8f35fa792087</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><h4 id="3、集群验证"><a href="#3、集群验证" class="headerlink" title="3、集群验证"></a>3、集群验证</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 节点状态</span><br><span class="line">[root@master] ~$ kubectl get nodes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 组件状态</span><br><span class="line">[root@master] ~$  kubectl get cs</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 服务账户</span><br><span class="line">[root@master] ~$ kubectl get serviceaccount</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 集群信息</span><br><span class="line">[root@master] ~$ kubectl cluster-info</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 验证dns功能</span><br><span class="line">[root@master] ~$ kubectl run curl --image=radial/busyboxplus:curl -it</span><br><span class="line">[ root@curl-66959f6557-r4crd:/ ]$ nslookup kubernetes.default</span><br><span class="line">Server:    10.96.0.10</span><br><span class="line">Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local</span><br><span class="line"></span><br><span class="line">Name:      kubernetes.default</span><br><span class="line">Address 1: 10.96.0.1 kubernetes.default.svc.cluster.local</span><br></pre></td></tr></table></figure><blockquote><p>附录：</p><p><strong><code>打算把以前kubernetes二进制安装的步骤，也迁过来。kubeadm已经GA，之后也会一直用kubeadm了</code></strong></p><p><strong><em><code>kubeadm token create --print-join-command</code></em></strong>可以获取 kubeadm join命令，比以前真的方便很多了         =。=</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> # kubelet.service配置文件 /use/lib/systemd/system/kubelet.service.d/10-kubeadm.conf</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><hr><p>参考链接：</p><p>kubeadm安装1.13.5：<a href="https://blog.csdn.net/fanren224/article/details/86573264#2master1_165" target="_blank" rel="noopener">https://blog.csdn.net/fanren224/article/details/86573264#2master1_165</a></p><p>二进制安装：<a href="https://github.com/mritd/ktool" target="_blank" rel="noopener">https://github.com/mritd/ktool</a></p><p>二进制安装kubernetes_v1.13.4：<a href="https://mritd.me/2019/03/16/set-up-kubernetes-1.13.4-cluster/" target="_blank" rel="noopener">https://mritd.me/2019/03/16/set-up-kubernetes-1.13.4-cluster/</a></p>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> Kubernetes_ha </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python_set集合操作</title>
      <link href="/sheldon_blog/passages/Python-set%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C/"/>
      <url>/sheldon_blog/passages/Python-set%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="Python-set集合类型小结"><a href="#Python-set集合类型小结" class="headerlink" title="Python_set集合类型小结"></a>Python_set集合类型小结</h2><p>下面来点简单的小例子说明把。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = set(<span class="string">'spam'</span>)</span><br><span class="line">y = set([<span class="string">'h'</span>,<span class="string">'a'</span>,<span class="string">'m'</span>])</span><br><span class="line">x, y</span><br><span class="line">(set([<span class="string">'a'</span>, <span class="string">'p'</span>, <span class="string">'s'</span>, <span class="string">'m'</span>]), set([<span class="string">'a'</span>, <span class="string">'h'</span>, <span class="string">'m'</span>]))</span><br></pre></td></tr></table></figure><p>再来些小应用。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; &gt; &gt; x &amp; y <span class="comment"># 交集</span></span><br><span class="line">&gt; &gt; &gt; set([<span class="string">'a'</span>, <span class="string">'m'</span>])</span><br><span class="line"></span><br><span class="line">&gt; &gt; &gt; x | y <span class="comment"># 并集</span></span><br><span class="line">&gt; &gt; &gt; set([<span class="string">'a'</span>, <span class="string">'p'</span>, <span class="string">'s'</span>, <span class="string">'h'</span>, <span class="string">'m'</span>])</span><br><span class="line"></span><br><span class="line">&gt; &gt; &gt; x - y <span class="comment"># 差集</span></span><br><span class="line">&gt; &gt; &gt; set([<span class="string">'p'</span>, <span class="string">'s'</span>])</span><br></pre></td></tr></table></figure><p>记得以前个网友提问怎么去除海量列表里重复元素，用hash来解决也行，只不过感觉在性能上不是很高，用set解决还是很不错的，示例如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">11</span>,<span class="number">22</span>]</span><br><span class="line">b = set(a)</span><br><span class="line">b</span><br><span class="line">set([<span class="number">33</span>, <span class="number">11</span>, <span class="number">44</span>, <span class="number">22</span>])</span><br><span class="line">c = [i <span class="keyword">for</span> i <span class="keyword">in</span> b]</span><br><span class="line">c</span><br><span class="line">[<span class="number">33</span>, <span class="number">11</span>, <span class="number">44</span>, <span class="number">22</span>]</span><br></pre></td></tr></table></figure><p>很酷把，几行就可以搞定。</p><h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>集合用于包含一组无序的对象。要创建集合，可使用set()函数并像下面这样提供一系列的项：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = set([<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">10</span>])      <span class="comment">#创建一个数值集合</span></span><br><span class="line">t = set(<span class="string">"Hello"</span>)         <span class="comment">#创建一个唯一字符的集合</span></span><br></pre></td></tr></table></figure><p>与列表和元组不同，集合是无序的，也无法通过数字进行索引。此外，集合中的元素不能重复。例如，如果检查前面代码中t集合的值，结果会是:</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; &gt; &gt; t</span><br><span class="line">set([<span class="string">'H'</span>, <span class="string">'e'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>])</span><br></pre></td></tr></table></figure><p>注意只出现了一个’l’。</p><p>集合支持一系列标准操作，包括并集、交集、差集和对称差集，例如：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = t | s          <span class="comment"># t 和 s的并集</span></span><br><span class="line">b = t &amp; s          <span class="comment"># t 和 s的交集</span></span><br><span class="line">c = t – s          <span class="comment"># 求差集（项在t中，但不在s中）</span></span><br><span class="line">d = t ^ s          <span class="comment"># 对称差集（项在t或s中，但不会同时出现在二者中）</span></span><br></pre></td></tr></table></figure><p>基本操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t.add(<span class="string">'x'</span>)            <span class="comment"># 添加一项</span></span><br><span class="line"></span><br><span class="line">s.update([<span class="number">10</span>,<span class="number">37</span>,<span class="number">42</span>])  <span class="comment"># 在s中添加多项</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">t.remove(<span class="string">'H'</span>)</span><br><span class="line"><span class="comment"># 使用remove()可以删除一项：</span></span><br><span class="line"></span><br><span class="line">len(s)</span><br><span class="line"><span class="comment"># set 的长度</span></span><br><span class="line"></span><br><span class="line">x <span class="keyword">in</span> s</span><br><span class="line"><span class="comment"># 测试 x 是否是 s 的成员</span></span><br><span class="line"></span><br><span class="line">x <span class="keyword">not</span> <span class="keyword">in</span> s</span><br><span class="line"><span class="comment"># 测试 x 是否不是 s 的成员</span></span><br><span class="line"></span><br><span class="line">s.issubset(t)</span><br><span class="line">s &lt;= t</span><br><span class="line"><span class="comment"># 测试是否 s 中的每一个元素都在 t 中</span></span><br><span class="line"></span><br><span class="line">s.issuperset(t)</span><br><span class="line">s &gt;= t</span><br><span class="line"><span class="comment"># 测试是否 t 中的每一个元素都在 s 中</span></span><br><span class="line"></span><br><span class="line">s.union(t)</span><br><span class="line">s | t</span><br><span class="line"><span class="comment"># 返回一个新的 set 包含 s 和 t 中的每一个元素</span></span><br><span class="line"></span><br><span class="line">s.intersection(t)</span><br><span class="line">s &amp; t</span><br><span class="line"><span class="comment"># 返回一个新的 set 包含 s 和 t 中的公共元素</span></span><br><span class="line"></span><br><span class="line">s.difference(t)</span><br><span class="line">s - t</span><br><span class="line"><span class="comment"># 返回一个新的 set 包含 s 中有但是 t 中没有的元素</span></span><br><span class="line"></span><br><span class="line">s.symmetric_difference(t)</span><br><span class="line">s ^ t</span><br><span class="line"><span class="comment"># 返回一个新的 set 包含 s 和 t 中不重复的元素</span></span><br><span class="line"></span><br><span class="line">s.copy()</span><br><span class="line"><span class="comment"># 返回 set “s”的一个浅复制</span></span><br></pre></td></tr></table></figure><blockquote><p>请注意：union(), intersection(), difference() 和 symmetric_difference() 的非运算符（non-operator，就是形如 s.union()这样的）版本将会接受任何 iterable 作为参数。相反，它们的运算符版本（operator based counterparts）要求参数必须是 sets。这样可以避免潜在的错误，如：为了更可读而使用 set(‘abc’) &amp; ‘cbs’ 来替代 set(‘abc’).intersection(‘cbs’)。从 2.3.1 版本中做的更改：以前所有参数都必须是 sets。</p><p>另外，Set 和 ImmutableSet 两者都支持 set 与 set 之间的比较。两个 sets 在也只有在这种情况下是相等的：每一个 set 中的元素都是另一个中的元素（二者互为subset）。一个 set 比另一个 set 小，只有在第一个 set 是第二个 set 的 subset 时（是一个 subset，但是并不相等）。一个 set 比另一个 set 打，只有在第一个 set 是第二个 set 的 superset 时（是一个 superset，但是并不相等）</p></blockquote><p><strong>子 set 和相等比较并不产生完整的排序功能。例如：任意两个 sets 都不相等也不互为子 set，因此以下的运算都会返回 False：a&lt;b, a==b, 或者a&gt;b。因此，sets 不提供 <strong>cmp</strong> 方法。</strong></p><h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">hash(s)</span><br><span class="line"><span class="comment"># 返回 s 的 hash 值</span></span><br><span class="line"></span><br><span class="line">s.update(t)</span><br><span class="line">s |= t</span><br><span class="line"><span class="comment"># 返回增加了 set “t”中元素后的 set “s”</span></span><br><span class="line"></span><br><span class="line">s.intersection_update(t)</span><br><span class="line">s &amp;= t</span><br><span class="line"><span class="comment"># 返回只保留含有 set “t”中元素的 set “s”</span></span><br><span class="line"></span><br><span class="line">s.difference_update(t)</span><br><span class="line">s -= t</span><br><span class="line"><span class="comment"># 返回删除了 set “t”中含有的元素后的 set “s”</span></span><br><span class="line"></span><br><span class="line">s.symmetric_difference_update(t)</span><br><span class="line">s ^= t</span><br><span class="line"><span class="comment"># 返回含有 set “t”或者 set “s”中有而不是两者都有的元素的 set “s”</span></span><br><span class="line"></span><br><span class="line">s.add(x)</span><br><span class="line"><span class="comment"># 向 set “s”中增加元素 x</span></span><br><span class="line"></span><br><span class="line">s.remove(x)</span><br><span class="line"><span class="comment"># 从 set “s”中删除元素 x, 如果不存在则引发 KeyError</span></span><br><span class="line"></span><br><span class="line">s.discard(x)</span><br><span class="line"><span class="comment"># 如果在 set “s”中存在元素 x, 则删除</span></span><br><span class="line"></span><br><span class="line">s.pop()</span><br><span class="line"><span class="comment"># 删除并且返回 set “s”中的一个不确定的元素, 如果为空则引发 KeyError，随机删除并打印</span></span><br><span class="line"></span><br><span class="line">s.clear()</span><br><span class="line"><span class="comment"># 删除 set “s”中的所有元素</span></span><br></pre></td></tr></table></figure><blockquote><p>请注意：非运算符版本的 update(), intersection_update(), difference_update()和symmetric_difference_update()将会接受任意 iterable 作为参数。从 2.3.1 版本做的更改：以前所有参数都必须是 sets。</p><p>还请注意：这个模块还包含一个 union_update() 方法，它是 update() 方法的一个别名。包含这个方法是为了向后兼容。程序员们应该多使用 update() 方法，因为这个方法也被内置的 set() 和 frozenset() 类型支持。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python_碎片化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python_list或dict合并</title>
      <link href="/sheldon_blog/passages/Python-list%E6%88%96dict%E5%90%88%E5%B9%B6/"/>
      <url>/sheldon_blog/passages/Python-list%E6%88%96dict%E5%90%88%E5%B9%B6/</url>
      
        <content type="html"><![CDATA[<h3 id="对于两个list、两个dict合并数据"><a href="#对于两个list、两个dict合并数据" class="headerlink" title="对于两个list、两个dict合并数据"></a>对于两个list、两个dict合并数据</h3><h4 id="1-两个字典："><a href="#1-两个字典：" class="headerlink" title="1.两个字典："></a>1.两个字典：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a= &#123;<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'b'</span>:<span class="number">2</span>,<span class="string">'c'</span>:<span class="number">3</span>&#125; </span><br><span class="line">b= &#123;<span class="string">'aa'</span>:<span class="number">11</span>,<span class="string">'bb'</span>:<span class="number">22</span>,<span class="string">'cc'</span>:<span class="number">33</span>&#125;</span><br></pre></td></tr></table></figure><p>合并1：dict(a,**b)  操作如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = dict(a,**b)</span><br></pre></td></tr></table></figure><p>合并2：dict(a.items()+b.items())  如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = dict(a.item() + b.items())</span><br></pre></td></tr></table></figure><p>合并3：c = {}  c.update(a)  c.update(b) 输出c 如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = &#123;&#125;</span><br><span class="line">c.update(a)</span><br><span class="line">c.update(b)</span><br></pre></td></tr></table></figure><h3 id="2-两个list合并："><a href="#2-两个list合并：" class="headerlink" title="2.两个list合并："></a>2.两个list合并：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>] </span><br><span class="line">b = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>]</span><br></pre></td></tr></table></figure><p>合并1：a+b 如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = a+b</span><br></pre></td></tr></table></figure><p>合并2：a+=b 这时a的值变成了合并后的结果，如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a += b  <span class="comment"># ====&gt; a = a+b</span></span><br></pre></td></tr></table></figure><p>合并3：a.extend(b) 和+=结果一样，输出a  如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.extend(b) <span class="comment"># a += b</span></span><br></pre></td></tr></table></figure><p>合并4：a.append(b)将b看成list一个元素和a合并成一个新的list，合并后的结果输入a 如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.append(b) <span class="comment"># list add other list &gt;&gt; [1,2,3,[1,2,3]]</span></span><br></pre></td></tr></table></figure><p> 合并5：a[0:0] = b 使用切片，如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>:<span class="number">0</span>] = b</span><br></pre></td></tr></table></figure><blockquote><p>附录：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># 方法一：</span></span><br><span class="line">&gt; list1 = [<span class="string">'k1'</span>,<span class="string">'k2'</span>,<span class="string">'k3'</span>]</span><br><span class="line">&gt; list2 = [<span class="string">'v1'</span>,<span class="string">'v2'</span>,<span class="string">'v3'</span>]</span><br><span class="line">&gt; dic = dict(map(<span class="keyword">lambda</span> x,y:[x,y],list1,list2))</span><br><span class="line">&gt; &gt;&gt;&gt; print(dic)</span><br><span class="line">&gt; &#123;<span class="string">'k3'</span>: <span class="string">'v3'</span>, <span class="string">'k2'</span>: <span class="string">'v2'</span>, <span class="string">'k1'</span>: <span class="string">'v1'</span>&#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># 方法二：</span></span><br><span class="line">&gt; &gt;&gt;&gt; dict(zip(list1,list2))</span><br><span class="line">&gt; &#123;<span class="string">'k3'</span>: <span class="string">'v3'</span>, <span class="string">'k2'</span>: <span class="string">'v2'</span>, <span class="string">'k1'</span>: <span class="string">'v1'</span>&#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># 方法三：</span></span><br><span class="line">&gt; &gt;&gt;&gt; l1=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">&gt; &gt;&gt;&gt; l2=[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line">&gt; &gt;&gt;&gt; &#123;k:v <span class="keyword">for</span> k,v <span class="keyword">in</span> zip(l1,l2)&#125;</span><br><span class="line">&gt; &#123;<span class="number">1</span>: <span class="number">4</span>, <span class="number">2</span>: <span class="number">5</span>, <span class="number">3</span>: <span class="number">6</span>, <span class="number">4</span>: <span class="number">7</span>, <span class="number">5</span>: <span class="number">8</span>, <span class="number">6</span>: <span class="number">9</span>&#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; &gt;&gt;&gt; x = &#123;<span class="number">1</span>: <span class="number">4</span>, <span class="number">2</span>: <span class="number">5</span>, <span class="number">3</span>: <span class="number">6</span>, <span class="number">4</span>: <span class="number">7</span>, <span class="number">5</span>: <span class="number">8</span>, <span class="number">6</span>: <span class="number">9</span>&#125;</span><br><span class="line">&gt; &gt;&gt;&gt; &#123;v:k <span class="keyword">for</span> k,v <span class="keyword">in</span> x.items()&#125;            <span class="comment">#反过来 将字典中的v和k调换</span></span><br><span class="line">&gt; &#123;<span class="number">4</span>: <span class="number">1</span>, <span class="number">5</span>: <span class="number">2</span>, <span class="number">6</span>: <span class="number">3</span>, <span class="number">7</span>: <span class="number">4</span>, <span class="number">8</span>: <span class="number">5</span>, <span class="number">9</span>: <span class="number">6</span>&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote></blockquote>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python_碎片化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python_list交集、差集和并集</title>
      <link href="/sheldon_blog/passages/Python-list%E4%BA%A4%E9%9B%86%E3%80%81%E5%B7%AE%E9%9B%86%E5%92%8C%E5%B9%B6%E9%9B%86/"/>
      <url>/sheldon_blog/passages/Python-list%E4%BA%A4%E9%9B%86%E3%80%81%E5%B7%AE%E9%9B%86%E5%92%8C%E5%B9%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>举例说明</p></blockquote><p>a_list = [1,2,3,4]<br>b_list = [1,4,5]</p><h3 id="一-差集"><a href="#一-差集" class="headerlink" title="一. 差集"></a>一. 差集</h3><p>很明显结果是[2,3,5]，下面我们说一下具体方法。<br>方法a.正常法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ret_list = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> a_list:</span><br><span class="line">    <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> b_list:</span><br><span class="line">        ret_list.append(item)</span><br></pre></td></tr></table></figure><p>方法b.简化版：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret_list = [item <span class="keyword">for</span> item <span class="keyword">in</span> a_list <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> b_list]</span><br></pre></td></tr></table></figure><p>方法c.高级版：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret_list = list(set(a_list)^set(b_list))</span><br></pre></td></tr></table></figure><h3 id="二-并集"><a href="#二-并集" class="headerlink" title="二. 并集"></a>二. 并集</h3><p>很明显结果是[1,2,3,4,5],下面是具体方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret_list = list(set(a_list).union(set(b_list)))</span><br></pre></td></tr></table></figure><h3 id="三-交集"><a href="#三-交集" class="headerlink" title="三. 交集"></a>三. 交集</h3><p>很明显结果是[1,4]，下面是具体方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret_list = list( ( set(a_list).union(set(b_list)) )^( set(a_list)^set(b_list) ) )</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python_碎片化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python_问题小结(2)</title>
      <link href="/sheldon_blog/passages/Python-%E9%97%AE%E9%A2%98%E5%B0%8F%E7%BB%93-2/"/>
      <url>/sheldon_blog/passages/Python-%E9%97%AE%E9%A2%98%E5%B0%8F%E7%BB%93-2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>环境：未特别注明的话，均为Python 3.6.5，IDE：VS code</p><p>遇到的都是基础问题，分了两篇。</p><p>担心一篇写多了会看不下去</p><p><a href="https://blog.csdn.net/xinzechen/article/details/89446322" target="_blank" rel="noopener">https://blog.csdn.net/xinzechen/article/details/89446322</a>  vscode的问题</p></blockquote><h2 id="『1』关于python无法显示中文的问题：SyntaxError-Non-ASCII-character-‘-xe4’-in-file-test-py-on-line-3-but-no-encoding-declared。"><a href="#『1』关于python无法显示中文的问题：SyntaxError-Non-ASCII-character-‘-xe4’-in-file-test-py-on-line-3-but-no-encoding-declared。" class="headerlink" title="『1』关于python无法显示中文的问题：SyntaxError: Non-ASCII character ‘\xe4’ in file test.py on line 3, but no encoding declared。"></a>『1』关于python无法显示中文的问题：SyntaxError: Non-ASCII character ‘\xe4’ in file test.py on line 3, but no encoding declared。</h2><p>python：2.7.15</p><p>解决办法：  在以后的每一个需要显示汉字的python文件中， 可以采用如下方法在 #!/usr/bin/python的下一行加上一句话来定义编码格式， 我以utf-8编码为例。<a id="more"></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 第一种：</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 第二种：</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 第三种：</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#vim: set fileencoding:utf-8</span></span><br></pre></td></tr></table></figure><h2 id="『2』有时候在去数据的时候会遇到数据内有中文，但是取出来的是unicode码，用了很多方法也转不了中文"><a href="#『2』有时候在去数据的时候会遇到数据内有中文，但是取出来的是unicode码，用了很多方法也转不了中文" class="headerlink" title="『2』有时候在去数据的时候会遇到数据内有中文，但是取出来的是unicode码，用了很多方法也转不了中文"></a>『2』有时候在去数据的时候会遇到数据内有中文，但是取出来的是unicode码，用了很多方法也转不了中文</h2><p>解决:</p><p>“反编码”我自己起的名字，大概意思就是我得到一串字符，是unicode码，如：‘\u53eb\u6211’，进行反编码后得到其对应的汉字。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="string">'\u53eb\u6211'</span></span><br><span class="line"><span class="keyword">print</span> f</span><br><span class="line">print(f.decode(<span class="string">'unicode-escape'</span>))</span><br><span class="line"></span><br><span class="line">list_words为列表类型</span><br><span class="line">str(list_words).decode( <span class="string">'string_escape'</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"> </span><br><span class="line">list_words = [ <span class="string">'你'</span>, <span class="string">'我'</span>, <span class="string">'他'</span> ]</span><br><span class="line">print( list_words )                                        </span><br><span class="line">print( str(list_words).decode( <span class="string">'string_escape'</span> ) )         <span class="comment"># 正常显示汉字（可靠性不高，原因尚不明确）</span></span><br><span class="line"> </span><br><span class="line">list_words_result = json.dumps( list_words, encoding=<span class="string">'UTF-8'</span>, ensure_ascii=<span class="literal">False</span> )   <span class="comment"># 正常显示汉字 （经实验可靠性较高）</span></span><br></pre></td></tr></table></figure><p>结果为: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\u53eb\u6211 </span><br><span class="line">叫我</span><br></pre></td></tr></table></figure><h2 id="『3』在编译时会出现这样的错：IndentationError-expected-an-indented-block"><a href="#『3』在编译时会出现这样的错：IndentationError-expected-an-indented-block" class="headerlink" title="『3』在编译时会出现这样的错：IndentationError:expected an indented block"></a>『3』在编译时会出现这样的错：<strong>IndentationError:expected an indented block</strong></h2><p>说明此处需要缩进，你只要在出现错误的那一行，按空格或Tab（但不能混用）键缩进就行。</p><h2 id="『4』SyntaxError-invalid-syntax-：语法错误。"><a href="#『4』SyntaxError-invalid-syntax-：语法错误。" class="headerlink" title="『4』SyntaxError:invalid syntax ：语法错误。"></a>『4』<strong>SyntaxError:invalid syntax</strong> ：语法错误。</h2><p>最常见的，最基础的错误</p><p>英文是“非法语句”的意思。漏标点符号（例如漏分号，漏&amp;号），多标点符号，拼写错，等等都会造成这种错</p><h2 id="『5』url连接超时解决："><a href="#『5』url连接超时解决：" class="headerlink" title="『5』url连接超时解决："></a>『5』<strong>url连接超时解决</strong>：</h2><p>1）使用的是urllib不是urllib2，所以无法直接在urlopen里面加timeout参数，只能是设置全局脚本的超时时间</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">socket.setdefaulttimeout(<span class="number">60</span>)</span><br></pre></td></tr></table></figure><p>设置全局的超时时间为60s。</p><p>2）urllib，urllib2常会一起使用（两者分别提供不同的功能）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">html = urllib.urlopen(url).read()</span><br><span class="line"><span class="comment"># 修改为</span></span><br><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line">html = urllib2.urlopen(url, timeout=<span class="number">60</span>).read()</span><br></pre></td></tr></table></figure><h2 id="『6』UnboundLocalError-local-variable-‘appname’-referenced-before-assignment："><a href="#『6』UnboundLocalError-local-variable-‘appname’-referenced-before-assignment：" class="headerlink" title="『6』UnboundLocalError: local variable ‘appname’ referenced before assignment："></a>『6』<strong>UnboundLocalError: local variable ‘appname’ referenced before assignment：</strong></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;u&apos;batchrealnameverifytask&apos;: 99.41, u&apos;bptask100000188408&apos;: 98.77, u&apos;clsexpflowmaintask576&apos;: 101.28&#125;</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;get_app_cpu_from_influxdb.py&quot;, line 89, in &lt;module&gt;</span><br><span class="line">    appname = get_sql_info(key)</span><br><span class="line">  File &quot;get_app_cpu_from_influxdb.py&quot;, line 28, in get_sql_info</span><br><span class="line">    return appname</span><br></pre></td></tr></table></figure><p>变量问题：变量在被赋值之前被使用定义</p><h2 id="『7』TypeError-sequence-item-1-expected-string-or-Unicode-NoneType-found"><a href="#『7』TypeError-sequence-item-1-expected-string-or-Unicode-NoneType-found" class="headerlink" title="『7』TypeError: sequence item 1: expected string or Unicode, NoneType found"></a>『7』<strong>TypeError: sequence item 1: expected string or Unicode, NoneType found</strong></h2><p>期望值未发现：str或者unicode类型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">message = <span class="string">u"应用的CPU利用率超过%s,请检查应用:%s"</span>%(str(threshold)+<span class="string">'%'</span>,<span class="string">","</span>.join(app_name))</span><br><span class="line"></span><br><span class="line"><span class="comment"># =====================&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line"></span><br><span class="line">message = <span class="string">"应用的CPU利用率超过%s,请检查应用:%s"</span>%(str(threshold)+<span class="string">'%'</span>,<span class="string">","</span>.join(app_name))</span><br></pre></td></tr></table></figure><h2 id="『8』UnicodeDecodeError-‘ascii’-codec-can’t-decode-byte-0xe5-in-position-1-ordinal-not-in-range-128"><a href="#『8』UnicodeDecodeError-‘ascii’-codec-can’t-decode-byte-0xe5-in-position-1-ordinal-not-in-range-128" class="headerlink" title="『8』UnicodeDecodeError: ‘ascii’ codec can’t decode byte 0xe5 in position 1: ordinal not in range(128)"></a>『8』<strong>UnicodeDecodeError: ‘ascii’ codec can’t decode byte 0xe5 in position 1: ordinal not in range(128)</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关于编码问题：</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding( <span class="string">"utf-8"</span> )</span><br></pre></td></tr></table></figure><h2 id="『9』IndentationError-unindent-does-not-match-any-outer-indentation-level"><a href="#『9』IndentationError-unindent-does-not-match-any-outer-indentation-level" class="headerlink" title="『9』IndentationError: unindent does not match any outer indentation level"></a>『9』<strong>IndentationError: unindent does not match any outer indentation level</strong></h2><p>【问题】</p><p>一个python脚本，本来都运行好好的，然后写了几行代码，而且也都确保每行都对齐了，但是运行的时候，却出现语法错误：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IndentationError: unindent does not match any outer indentation level</span><br></pre></td></tr></table></figure><p>【解决过程】</p><p>1.对于此错误，最常见的原因是，的确没有对齐。但是我根据错误提示的行数，去代码中看了下，没啥问题啊。</p><p>都是用TAB键，对齐好了的，没有不对齐的行数啊。</p><p>2.以为是前面的注释的内容影响后面的语句的语法了，所以把前面的注释也删除了。</p><p>结果还是此语法错误。</p><p>3.后来折腾了半天，突然想到了，把当前python脚本的所有字符都显示出来看看有没有啥特殊的字符。tab与空格混用了</p><h2 id="『10』request-https报错："><a href="#『10』request-https报错：" class="headerlink" title="『10』request  https报错："></a>『10』<strong>request  https报错：</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  忽略警告：InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised.</span></span><br><span class="line">requests.packages.urllib3.disable_warnings(）</span><br></pre></td></tr></table></figure><h2 id="『11』python安装MySQLdb的时候一直有问题"><a href="#『11』python安装MySQLdb的时候一直有问题" class="headerlink" title="『11』python安装MySQLdb的时候一直有问题"></a>『11』<strong>python安装MySQLdb的时候一直有问题</strong></h2><p>在Linux下 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install MySQL-python</span><br></pre></td></tr></table></figure><p>如果安装之后仍不能正常运行，尝试用yum install MySQL-python，因为这个模块需要一些第三方程序来运行的。 </p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python_problem </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python_问题小结(1)</title>
      <link href="/sheldon_blog/passages/Python-%E9%97%AE%E9%A2%98%E5%B0%8F%E7%BB%93-1/"/>
      <url>/sheldon_blog/passages/Python-%E9%97%AE%E9%A2%98%E5%B0%8F%E7%BB%93-1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>环境：未特别注明的话，均为Python 3.6.5，IDE：VS code</p></blockquote><h2 id="『1』TypeError-unbound-method-问题"><a href="#『1』TypeError-unbound-method-问题" class="headerlink" title="『1』TypeError: unbound method 问题"></a>『1』TypeError: unbound method 问题</h2><p>今天执行了下之前写的Python接口文件，源码如下:<a id="more"></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__author__ = <span class="string">'Administrator'</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> readData <span class="keyword">import</span> dictionary</span><br><span class="line">readIt = &#123;&#125;</span><br><span class="line">readIt = dictionary.onlyCellValue(<span class="string">"E:\python\API\eadData.xls"</span>, <span class="string">"Sheet1"</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">print</span> readIt</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> readIt:</span><br><span class="line">    temp_list = readIt[key]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(temp_list)):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"第"</span>+(i+<span class="number">1</span>)+<span class="string">"个参数为"</span>+temp_list[i]</span><br></pre></td></tr></table></figure><p>在运行时报错：TypeError: unbound method onlyCellValue() must be called with dictionary instance as first argument (got str instance instead)，后经在网上查看，发现时由于调用其他类时，未在后面添加括号，添加括号后，运行正常。这是由于未添加括号情况下，未被认为是类的实例，故报此错；</p><blockquote><p>改正后的：readIt = dictionary().onlyCellValue(“E:\python\API\eadData.xls”, “Sheet1”, 1)</p></blockquote><h2 id="『2』Python访问MySQL"><a href="#『2』Python访问MySQL" class="headerlink" title="『2』Python访问MySQL"></a>『2』Python访问MySQL</h2><p>听说很多人都使用著名的<a href="http://sourceforge.net/projects/mysql-python/" target="_blank" rel="noopener">MySQLdb</a>来访问MySQL(当然还有pymysql)，但是它并不支持Python 3.x的版本。所以要另寻出路。那就是<a href="https://pypi.python.org/pypi/mysql-connector-python" target="_blank" rel="noopener">mysql-connector-python</a>，这个貌似是MySQL官方提供的，并且它不依赖于MySQL C客户端library，我下载的是1.1.4版本，下载解压之后，会看到setup.py文件，这样安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python3.2 setup.py install</span><br></pre></td></tr></table></figure><p>然后在程序中就可以用了。<br>下面给出一段查询MySQL记录的示例代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mysql.connector</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"> </span><br><span class="line">__author__ = <span class="string">'codelast'</span></span><br><span class="line"> </span><br><span class="line">username = <span class="string">'root'</span></span><br><span class="line">password = <span class="string">'xxx'</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">db = <span class="string">'mydb'</span></span><br><span class="line"> </span><br><span class="line">connection = mysql.connector.connect(user=username, password=password, host=host, database=db)</span><br><span class="line">cursor = connection.cursor()</span><br><span class="line"> </span><br><span class="line">sql = <span class="string">"SELECT * FROM my_table WHERE id = 9"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 打印查询到的记录的行数</span></span><br><span class="line">    data = cursor.fetchall()</span><br><span class="line">    print(len(data))</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 输出所有记录</span></span><br><span class="line">    <span class="keyword">for</span> (ID, name) <span class="keyword">in</span> data:</span><br><span class="line">        print(<span class="string">"name:[%s]"</span> % (name))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">    print(<span class="string">"Failed to query table, detail: &#123;&#125;"</span>.format(err.msg))</span><br><span class="line">    sys.exit()</span><br><span class="line"> </span><br><span class="line">connection.commit()</span><br><span class="line">cursor.close()</span><br><span class="line">connection.close()</span><br></pre></td></tr></table></figure><p>上面的代码很简单，无非就是从my_table表里查询一些记录，再打印出来。<br>注意 for (ID, name) 中的括号里要写全该表中，你查询的所有字段名，否则会报错。还有其他遍历查询结果的方法，后面会继续陈述。</p><h2 id="『3』逆序遍历list"><a href="#『3』逆序遍历list" class="headerlink" title="『3』逆序遍历list"></a>『3』逆序遍历list</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myList = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> reversed(myList):</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>注意是 reversed 不是 reverse。这只是逆序遍历，myList中的数据顺序并不会改变。</p><h2 id="『4』使用MySQLdb访问数据库时，“TypeError-execute-takes-at-most-3-arguments-4-given-”错误的解决办法"><a href="#『4』使用MySQLdb访问数据库时，“TypeError-execute-takes-at-most-3-arguments-4-given-”错误的解决办法" class="headerlink" title="『4』使用MySQLdb访问数据库时，“TypeError: execute() takes at most 3 arguments (4 given)”错误的解决办法"></a>『4』使用MySQLdb访问数据库时，“TypeError: execute() takes at most 3 arguments (4 given)”错误的解决办法</h2><p>Python版本：2.7.3<br>使用2.7.3版本的Python时，访问MySQL的最佳方案应该数使用<a href="http://sourceforge.net/projects/mysql-python/" target="_blank" rel="noopener">MySQLdb</a>了。<br>如果在执行SQL时，你遇到了上面所说的问题，那么你可能是像下面这样写导致的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">"INSERT INTO my_table (field1, field2) VALUES (%s, %s)"</span></span><br><span class="line">cursor.execute(sql, <span class="string">"a"</span>, <span class="string">"b"</span>)</span><br></pre></td></tr></table></figure><p>这是错误的，其实这货根本不是这样用的，当参数多于一个时，你要把它们放在一个tuple里传进去：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sql = <span class="string">"INSERT INTO my_table (field1, field2) VALUES (%s, %s)"</span></span><br><span class="line">cursor.execute(sql, (<span class="string">"a"</span>, <span class="string">"b"</span>))</span><br></pre></td></tr></table></figure><p>例如<a href="http://stackoverflow.com/questions/17505067/mysql-and-python-execution-only-takes-3-arguments-4-given" target="_blank" rel="noopener">这个</a>链接有个例子。</p><h2 id="『5』使用-lxml-库生成XML（字符串）"><a href="#『5』使用-lxml-库生成XML（字符串）" class="headerlink" title="『5』使用 lxml 库生成XML（字符串）"></a>『5』使用 lxml 库生成XML（字符串）</h2><p>Python版本：2.7.3<br>直接看代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:UTF-8</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">XML生成器。文件名：xmlGenerator.py</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"> </span><br><span class="line">__author__ = <span class="string">'Darran Zhang @ codelast.com'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMLGenerator</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate_xml</span><span class="params">(self)</span>:</span></span><br><span class="line">        commands = etree.Element(<span class="string">'Commands'</span>)</span><br><span class="line">        command = etree.SubElement(commands, <span class="string">'Command'</span>)</span><br><span class="line">        from_user = etree.SubElement(command, <span class="string">'FromUser'</span>)</span><br><span class="line">        from_user.text = <span class="string">u'abc'</span></span><br><span class="line">        cmd = etree.SubElement(command, <span class="string">'Cmd'</span>)</span><br><span class="line">        cmd.text = <span class="string">u'mmmmmmmmmmmmmm'</span></span><br><span class="line">        cmd_extra_data = etree.SubElement(command, <span class="string">'CmdExtraData'</span>)</span><br><span class="line">        cmd_extra_data.text = <span class="string">u'eeeeeeeeee'</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> etree.tostring(commands, pretty_print=<span class="literal">True</span>, xml_declaration=<span class="literal">True</span>, encoding=<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure><p>测试代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xmlGenerator <span class="keyword">import</span> XMLGenerator</span><br><span class="line"> </span><br><span class="line">xmlGen = XMLGenerator()</span><br><span class="line">print(xmlGen.generate_xml())</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&apos;1.0&apos; encoding=&apos;utf-8&apos;?&gt;</span><br><span class="line">&lt;Commands&gt;</span><br><span class="line">  &lt;Command&gt;</span><br><span class="line">    &lt;FromUser&gt;abc&lt;/FromUser&gt;</span><br><span class="line">    &lt;Cmd&gt;mmmmmmmmmmmmmm&lt;/Cmd&gt;</span><br><span class="line">    &lt;CmdExtraData&gt;eeeeeeeeee&lt;/CmdExtraData&gt;</span><br><span class="line">  &lt;/Command&gt;</span><br><span class="line">&lt;/Commands&gt;</span><br></pre></td></tr></table></figure><p>可见非常简单。</p><h2 id="『6』在PyCharm中无法安装MySQL-python这个package的一个解决办法"><a href="#『6』在PyCharm中无法安装MySQL-python这个package的一个解决办法" class="headerlink" title="『6』在PyCharm中无法安装MySQL-python这个package的一个解决办法"></a>『6』在PyCharm中无法安装MySQL-python这个package的一个解决办法</h2><p>在PyCharm中可以直接搜索Python package并安装，我遇到的一个问题是：无法安装，错误提示的其中一段为：</p><blockquote><p>EnvironmentError: mysql_config not found</p></blockquote><p>你需要保证你的Ubuntu已经安装了以下这些东西：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mysql-server mysql-client libmysqlclient-dev</span><br></pre></td></tr></table></figure><p>然后再试，一切OK。</p><h2 id="『7』”ValueError-zero-length-field-name-in-format”错误的解决办法"><a href="#『7』”ValueError-zero-length-field-name-in-format”错误的解决办法" class="headerlink" title="『7』”ValueError: zero length field name in format”错误的解决办法"></a>『7』”ValueError: zero length field name in format”错误的解决办法</h2><p>Python版本：2.6.6<br>错误出在如下语句：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"&#123;&#125;\t&#123;&#125;"</span>.format(<span class="number">123</span>, <span class="number">456</span>)</span><br></pre></td></tr></table></figure><p>我遇到的出问题的Python版本为2.6.6（不知道是不是2.6.*及低版本都有此问题），反正Python 2.7.3就没有这个问题了。<br>上面的代码无非主就是把123和456代替两个大括号。在旧版本的Python上（具体从哪个版本开始不用这样写，我不确定），你要有多个需要format的field时，需要指定它们的顺序：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"&#123;0&#125;\t&#123;1&#125;"</span>.format(<span class="number">123</span>, <span class="number">456</span>)</span><br></pre></td></tr></table></figure><p>这样就没问题了。</p><h2 id="『8』对一个字典-dict-，按value进行排序"><a href="#『8』对一个字典-dict-，按value进行排序" class="headerlink" title="『8』对一个字典(dict)，按value进行排序"></a>『8』对一个字典(dict)，按value进行排序</h2><p>Python版本：2.6.6，2.6.9均测试可用（Python3里没有cmp方法了，所以不能用）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sortedList = sorted(myDict.items(), <span class="keyword">lambda</span> x, y: cmp(x[<span class="number">1</span>], y[<span class="number">1</span>]), reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> (k, v) <span class="keyword">in</span> sortedList:</span><br><span class="line">    print(<span class="string">"&#123;0&#125;\t&#123;1&#125;"</span>.format(k,v))</span><br></pre></td></tr></table></figure><p>其中，myDict是你要将其排序的字典，sortedList是排序之后的结果，变成了一个list，里面是若干个tuple，每个tuple里是一对(key,value)，所以后面用那样的方式对它进行了遍历。</p><h2 id="『9』判断一个字典（dict）中是否包含指定的key"><a href="#『9』判断一个字典（dict）中是否包含指定的key" class="headerlink" title="『9』判断一个字典（dict）中是否包含指定的key"></a>『9』判断一个字典（dict）中是否包含指定的key</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">d = dict()</span><br><span class="line"><span class="comment"># 向字典中添加两个元素</span></span><br><span class="line">d[<span class="number">1</span>] = <span class="string">'abc'</span></span><br><span class="line">d[<span class="number">2</span>] = <span class="string">'def'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 检查 3 这个key是否在字典中，结果输出的是“NO”</span></span><br><span class="line"><span class="keyword">if</span> <span class="number">3</span> <span class="keyword">in</span> d:</span><br><span class="line">    print(<span class="string">'YES'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'NO'</span>)</span><br></pre></td></tr></table></figure><h2 id="『10』Python正则简单示例"><a href="#『10』Python正则简单示例" class="headerlink" title="『10』Python正则简单示例"></a>『10』Python正则简单示例</h2><p>先看代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">code = <span class="string">'String url = "http://item.jd.com/1148104.html?erpad_source=abc";'</span></span><br><span class="line">pattern = re.compile(<span class="string">'.*\"(.*)\"'</span>)</span><br><span class="line">match = pattern.match(code)</span><br><span class="line"><span class="keyword">if</span> match:</span><br><span class="line">    print(match.group(<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://item.jd.com/1148104.html?erpad_source=abc</span><br></pre></td></tr></table></figure><p>说明：上面的代码是想把字符串“code”中的双引号里的那个URL打印出来。正则表达式 .<em>\”(.</em>)\” 中的小括号就是第1个group，匹配上的话可以用 group(1) 获取之。</p><h2 id="『11』try…except的示例参考"><a href="#『11』try…except的示例参考" class="headerlink" title="『11』try…except的示例参考"></a>『11』try…except的示例参考</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:               <span class="comment"># 可能会出现异常的一段代码</span></span><br><span class="line">    command_1   <span class="comment"># 如果command_1出现异常，则不执行command_1以及之后的语句</span></span><br><span class="line">    command_2   <span class="comment"># command_1如果正常，则会执行</span></span><br><span class="line"><span class="keyword">except</span>:         <span class="comment"># try中任意一行语句出现异常，直接跳转至except，程序继续运行</span></span><br><span class="line">    command_3</span><br><span class="line">    command_4</span><br></pre></td></tr></table></figure><h2 id="『』To-be-added…"><a href="#『』To-be-added…" class="headerlink" title="『』To be added…"></a>『』To be added…</h2>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python_problem </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker的问题总结</title>
      <link href="/sheldon_blog/passages/Docker%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/"/>
      <url>/sheldon_blog/passages/Docker%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h3 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h3><h4 id="1、Docker18-06-1-ce安装-RHEL7-后启动失败-原因-xfsprogs版本过低"><a href="#1、Docker18-06-1-ce安装-RHEL7-后启动失败-原因-xfsprogs版本过低" class="headerlink" title="1、Docker18.06.1-ce安装(RHEL7)后启动失败, 原因(xfsprogs版本过低)"></a>1、Docker18.06.1-ce安装(RHEL7)后启动失败, 原因(xfsprogs版本过低)</h4><p>* 问题分析: </p><blockquote><p>使用/usr/bin/dockerd启动测试发现是文件系统无法创建 <a id="more"></a></p><p>1 WARN[2018-09-15T10:47:39.886191433+08:00] Usage of loopback devices is strongly discouraged for production use. Please use <code>--storage-opt dm.thinpooldev</code> or use <code>man dockerd</code> to refer to dm.thinpooldev section.  storage-driver=devicemapper </p><p>2 INFO[2018-09-15T10:47:40.220046362+08:00] Creating filesystem xfs on device docker-253:4-17133027-base, mkfs args: [-m crc=0,finobt=0 /dev/mapper/docker-253:4-17133027-base]  storage-driver=devicemapper </p><p>3 INFO[2018-09-15T10:47:40.221230038+08:00] Error while creating filesystem xfs on device docker-253:4-17133027-base: exit status 1  storage-driver=devicemapper </p><p>4 ERRO[2018-09-15T10:47:40.221258767+08:00] [graphdriver] prior storage driver devicemapper failed: exit status 1 </p><p>5 Error starting daemon: error initializing graphdriver: exit status 1 </p><p>第三行日志可以找到mkfs的执行参数, 执行发现参数不正确 </p><p>1 2 INFO[2018-09-15T10:47:40.220046362+08:00] Creating filesystem xfs on device docker-253:4-17133027-base, mkfs args: [-m crc=0,finobt=0 /dev/mapper/docker-253:4-17133027-base]  storage-driver=devicemapper </p></blockquote><p>* 解决问题 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install xfsprogs </span><br><span class="line"><span class="meta">#</span> 但是内核版本过低，操作系统7.0</span><br><span class="line"><span class="meta">#</span> 18.06最好升级系统版本到7.4，只能装会1.12版本,问题来了，私有镜像库登入不了</span><br><span class="line"><span class="meta">#</span> 17.12.0兼容</span><br></pre></td></tr></table></figure><h4 id="2、docker-rm-container-失败"><a href="#2、docker-rm-container-失败" class="headerlink" title="2、docker rm container 失败"></a>2、docker rm container 失败</h4><p>现象：</p><blockquote><p>docker version：17.12.0-ce </p><p>偶尔出现docker跟daemon守护进程失去联系 </p></blockquote><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABUQAAABqCAYAAAB04lu2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACZgSURBVHhe7ZxtblzLllx7au6hGT0+/zHg6Txj62Lb0fEid2ZWFckqcYWwwIyPPEVKtx8awoH+47/+53/96z//x3/+6z/+4z/+HyX3Jc1OeOQOAAAAAAAAAAAAwKv5P//7f/3z95UnfyG6ynY8cgcAAAAAAAAAAADg1ZTqL0X5C1EAAAAAAAAAAAD467l6Q7Sl2SnpXsoAAAAAAAAAAAAAvorS8g3RHrTU++4EV9oAAAAAAAAAAAAAfBXjG6IAAAAAAAAAAAAAfxOl8Q1RAAAAAAAAAAAAgL8F3hAFAAAAAAAAAACAX0OJN0QBAAAAAAAAAADgV8AbogAAAAAAAAAAAPBrKPGGKAAAAAAAAAAAAPwKeEMUAAAAAAAAAAAAfg0l3hCFv4pSOgMAAAAAAAAAABy/IapK/TuiSv0rcKVN4UqbppW678L16OZVqFKv6EbPj9BK3bO0Ugf/jir1p6hWeUk7Z9fvcH3VpuX5RCt1N7RSV0wdAAAAAAAAwFdSOnpDtJTyn+Dke/GN+1eQnvlMpuz6ryR9tmfuV9mr2X2G9np+hlc9J/GVz/6beNXv0+o5KV9lLe9OSXc9c58y9zfZjkfuJNJzVN4BAAAAAAAAfAdXb4im/CfYfS+pT9mzpGc+kym7/itJn+2Z+1X2alafsVO6c8qz9ye+8tl/E6/4fbp9xrSfuh3pbsoc37i/yXY8cicxPWfqAAAAAAAAAL6S0tNviLb0XFrtWt7vNpN8l+48m7W6d1Zdyj1Tpb5RtZ82Je/TpqSdblPmfpW9mt1naK/nG1TtfdO5ardp733aOa5V71vf7WjpuZQ6vdPnV7NS2k68+s7UFar22vV5yhzfuN9lqrRptfdN5632N70ydQAAAAAAAABfycveEG2lrkidZ+5vMqX7/urn5D3Tc/uSZsrUFUnapa1mnbsveaY+Ze490/MuU3l/Sit1zm6nvZ5P8TstzTrfZcmXPEtnJeWrrOT5La1d1+qz7naslLbF1J3Q91W+aVqpa6beu1bKWto5ralrTRvP0rl9SbPO3ZdOe2fqAAAAAAAAAL6S0kv+DdFHes/c32RK9/3VzynTc/KrbMon9I6eV5n7FWm3ylTeqU+Z+1W2Q++szsoqb7TX8ynpziNZyZ+TUKW+WCntPHuE6Tnarc5fgX7uI7Q8U+9M/apb5UrapMzxjftHMz2vMveJtElZM3UAAAAAAAAAX8lL3xBNeZN6z9zfZIr2Kt10l87J32Q7/I77lLlfkXYpc3Sj51XmfpXd0kpdsep2SncSaftIpueJ3vXXxNQpp7sd03O0W52/gmefn+6nTJn6VbfKlbRJmeMb949mel5l7hNpk7Jm6gAAAAAAAAC+ktJf8YaoZnre0Uq5+5Jn6leZknrPWpp1vsvcp8y9Z3peZe5X2avZfYb2ej7F77Q063yXuU+Zej0rKT/NHmF6jnar81fw7PPTfc30PGXNbaeZnleZ+5S5n7KSZ+ncvqRZ51Om5/YlzZSpAwAAAAAAAPhKXvKGaNLJ7tFN4Up9OjutqSu1X/Uq3fjOu0alftqVvD/ZJO023p9uXs30Odrp+RaV+mlX8n63aaWt7rwr7fqSb05ISp16P7+apLTb4Xq2V+22t/2rNi3frnYl9dOuNPXqU+/qDQAAAAAAAMBXU3rJG6LvSCt1j/DKZ8FjTH8G2ukZAAAAAAAAAACguXpDtJX638Bv/tl/GlXqAQAAAAAAAAAATigdvSH621GlHgAAAAAAAAAAAN6f4zdEAQAAAAAAAAAAAD6dEm+IAgAAAAAAAAAAwK+AN0QBAAAAAAAAAADg11DiDVEAAAAAAAAAAAD4FfCGKADAG/Pnf6BDDv/A78/z8HsIAAAAAAC/jRJviMLTqFL/jrRSB1+PKvVOK3WfRCt1iWmrSn2hSv2n87f+XN/Jp/4eqlZ5STtn1+9wfdWm5flEK3U3tFJXTF1zsjlh9xxX2hSt1CmqVV7S7gZX2iit1O1wpY3SSt0NqlVe0i6hWuUl7RTXri/5Rmmlrmml7gRX2uxwrXrPn0W1ylvan9BKneNKm0a16ld5KXWJ061q6kren2ySfKO0UldMnaKa+tQ1rdQpqlVe0s456VWPbgDgZxjfEJ2kO/jdfPJ/D5/8vX8Vqva+eSU3z7/ZfhWv+B5e8Qzl5HknG/gcfvuf5+rnT/kqa3l3SrrrmfuUub/JdjxyJ5Geo/KuUaX+FFXqi9RNWX9dsepTnrId6U7KnJONk+6kzDnZTKzupzxlzapL+aOZ+xNO7pxsEuleyibS/jR7hul5U3fDyXPSJmVTXqhSX0xdo0q9Mm1S55n7lLk/Id1ReefsNt3310R3/XXFqk/5Kmt516TOM/erDGb4PXsfVO1980mUxjdESycZ/F4++b+HT/7evwL//Whp9mpunn+z/Spe8T284hnKyfNONvA5/OY/z9uffdpP3Y50N2WOb9zfZDseuZOYnjN1zcnmhOk5qZuy/rpi1ys32ybdSZlzsnHSnZQ5J5uJ1f2Up6xZdSl/NHN/wsmdk00i3UvZRNqfZo+ye9auP+XkOWmTsilXps3UOSfbaZM6z9ynzP0J052pK3Z90Zv+muiuv65Y9SlPWXPbeeZ+lcEMv2fvgf85tDT7NLb/huif0s79VfOSnku3G+9Kq963vtvR0nNptWt5nzYl73zXveJKne900yTtNt6fsFLa+F433pU877Pmfb5B1d43nbdSX7g877PmfVZcqfOdbppW6k5Y3U25K3W7TLuUF6r2vtnR0nPJd96Xpk6luxP6jiptWt45r9pMtPRcSv0qa+m51P3pZtdpr+fSaldS77sTVO2nTSl1vkubJN351rubXs8l33lfWvW+9d2OV9+ZukLVXrs+T5njG/e7TJU2rfa+6bzV/qZXpq7ZbVTtfTPlReo8U69nZaW0bVa9K22aVa9q75vOW6lXVhtVe990rtr1Le11P2VJvmtWXco9c2mXNu0f2XSuSv1p1vKNnk8ylW9O+5QrrrQpVKu+v7ZWmylbSTe6TXnRnco3za5L8o36lLlPmUu7tGnvm+bRrtGNnhXN9ayslLbF1BVTnzrP3E9Za7V5Far2u03qpl1r2jSuqVPp7oSWnkurXcvzPmveZ8W16qbM85J238nqs1OuWnXTrjVtGlfaTJS2b4iqvG9aqWtaqStSt8pKnt/SSl2ROs/cp6zl2eRT1vJs8ilzv8pO2d1tpa5InWatdO7NCb5vadb55E+yVjr3JvmUtTxT31nJ81NO76adZ+5X2U3e0uyUlmeTv8lu0WfoObHri1dtdrRSV6TOs5Zn7kueqd/lRcuzdG5f0uwUv9fyTH3KWp6pX2WK9+6VXVfybPJTVvL8hr6v8k3TSl0z9d61UtbSzmlNXWvaeJbO7Uuade6+dNo7U9dMG+9ammmX8ibJ+3RO7PqitepOspu8pVnnk1dWnectzTo/yW7zlDVT1+w2SWnXeJ98yTP3Jc06P81c3rsvrfopK3l24zVT+cZJG8/cd1byTH1nLt/0LuXKtGl5pn6XK7tN0iMbxfvkS5opJ51qtfGzormeE7u+eMUm6XaTfEmzV+HPbXk2+c5KnrkveTb5m+wRWqkrUqdZK517k3zK3KfM/SqbWCltJ07v+M59ZyXP3Jc8m/wqm3joDdHE1DW7TepPs0fYPWel3S71u8x9ytxPmWrXt3x3yu7uI71mJ+cT0j5lnat2fUv73Tn5lLlfZc9y+sy088z9KrvNU3ZCuueZ+5vsFlXqle/c7Ng9I/WeuU+Z+1U25UXqNNPzlO04vZN2nrm/yRxX2hS3nWcr6aZ3nt3S8ky9M/WrbpUraZMyxzfuH830vMrcJ9ImZc3UNavNKl/xzH4l3StT56TtSmnnWZO6lHWuWm1SXqRulSX5rrenecqaqSt2fWJ3x3v3KXM/ZUm+c3Sj5xVp82ymWvWeqXdWvSv1J5mz2qxyZdqkLmVTrpxslJP9buO9+1XW7LqSZ967fJ+kG2Xqil3fnO6ak71u9PzV3HyWK/W7zH3K3N9kj7B7zkra787Jn2R61izJd9/Bzee6Ur/L3KfM/SqbKL3k3xBNmbPbpP40e4Tdc3b9Cr/nPmXuU+Z+lTm+cf8su+c90mt2cj4h7U8y96tM0X51Tj5l7lfZs5w+M+08c7/KbvOUnZDueeb+Jruln9FfJ75zs2P3jNR75j5l7lfZlBep00zPU7bj9E7aeeb+JlO8d6/cdv4s9ytOdxPpGSlTpn7VrXIlbVLm+Mb9o1lp9xz3ibRJWTN1zWqzylfc7HfbZ3slbVPm7DapP8ncrzIl9afZitU25SlrHu1WnNzxjfuUub/Jdvgd94m0eTTb+ZtMSb1n7m8yZeqnrpk2qUvZlCsnm+Zk+8jG/SprbruUNVPX7DZTP3XOq7e+cf+VnH6W79yfZu5T5v4me4Tdc2761Tn5k0zPU/ZTnH4vvnN/mrlPmftVNnH1huht5uw2qT/NHmH3nNR75j5lLc8mnzL3KXOfMver7JTd3Ud6zU7OJ/i+pVnnkz/JTs7Jp8z9lJU8vyHd98x9ypIvaabdSd7S7JR0zzP3z2YTutdzYtcXr9rs2D3D+5Zn6lPmfpVNeZE6zfTcvqTZKemeZ+5T5v7RTM/JK7edZ+5vslvSMzTT85Q1t51mel5l7lPmfspKnqVz+5JmnU+ZntuXNFOmrpk2qUvZlDsnu91m1af8kUzPqyz5kmad3/iUJV/SrPOT7DZPWbPqUp4yJfUnWfIlz9yXNOv8JGtWXco10/MuK3l2408yPd9k7jsreaZembpi1xfTpuWZ+l2unGyKk13anGTJlzRTbruUNVPX7DarPuUpa6ZOOdmtNilfZSXPb0j3Pdv508x9ytw/m+3Y3Um9Zifn5FdZ56VVd5J9F+mzPdv508x9ytyvsonS8g3RSbud9qebtNv1Jd+ckHSy2/WltPGtb7wvrbrTrNWd4kqbE5Ju+tUu5er9fIpK/bRr7TYpV+/ntC+tuinTXLNHcL1io9471+kzTlFNmecl7RRX2qxouS+lzPXqzSlJu5361E370snGtbpzmvXXR3DdblRTlrrSri9NXSttpszzknapL/nmFNezvWq3ve1ftWn5drUrqZ92palXn3rXzWa1nTrVaqe54zrZlKZeO8U1dS3d+E79tGtNXUnv+079tCt5nzalqddOSZq6kt73nXeNa7dRf7vxXWnqvVNcj/a+9Z33rd3mtm+SvPNd974reackTV3LN77v3nOX7lbbVa+5okp94dpt1Kfe1ZvV1vuv3JSmrrS731rtNFdUqW9cq03Kb3GdbEqpW2Wq6Z7nJe0UV9pMJJ3sUq7ez2lf0k5ppa5wpc134jrZlFK3ylTTPc9L2p2wfUMUnufPb3DIAQDgveB/rwEAAADgnWilDgAepzT+G6LwPKWUAwDAe8H/XgMAAADAO8H/fwrwNfCG6BejSj0AAPwcrrQBAAAAAACAv4sSb4gCAAAAAAAAAADAr4A3RAEAAAAAAAAAAODXUOINUQAAAAAAAAAAAPgV8IYoAAAAAAAAAAAA/BpKb/eGaCnlcA6/hwAAAADwG+D/7wWAr+Bv/d+Wn/i5fuIzJ/h+3oef/Nm/5Q3RVuoS01aV+kKV+t/Ap/7sqlVe0s7Z9TtcX7VpeT7RSt0NrdQVU9ecbE7YPceVNkUrdYpqlZe0u8GVNkordTtcaaO0UneDapWXtEuoVnlJO8W160u+UVqpa1qpO8GVNjtcq97zZ1Gt8pb2J7RS57jSplGt+lVeSl3idKuaupL3J5sk3yit1BVTp6imPnVNK3WKapWXtHNOetWjG/g++DN4L1qp+1tp+Rnem1bqiqk7QZX6n+Invp+f+MyJT/t+Wql7llbqvoOf/uztG6KllN/wimcoJ8872bwTn/b9vprVz5/yVdby7pR01zP3KXN/k+145E4iPUflXaNK/Smq1Bepm7L+umLVpzxlO9KdlDknGyfdSZlzsplY3U95yppVl/JHM/cnnNw52STSvZRNpP1p9gzT86buhpPnpE3KprxQpb6YukaVemXapM4z9ylzf0K6o/LO2W2676+J7vrrilWf8lXW8q5JnWfuVxk8T/q9hs/gt/3ZtfzsG8/g//NTvz/f8bnf8RnvzLv9/J/6/ZzuHuErnz3xU5/bHL0h+mcQ8hte8Qzl5Hknm3fi077fV3L7s0/7qduR7qbM8Y37m2zHI3cS03OmrjnZnDA9J3VT1l9X7HrlZtukOylzTjZOupMy52Qzsbqf8pQ1qy7lj2buTzi5c7JJpHspm0j70+xRds/a9aecPCdtUjblyrSZOudkO21S55n7lLk/YbozdcWuL3rTXxPd9dcVqz7lKWtuO8/crzJ4Hn5fP5d3/rPbKd3Zoff0rKxy+Ief+v35js/9js94Z97t5//U7+d09whf+eyJn/rcprR8Q3SS7k7oO6q0aXnnvGqzQ9V+2pRS57u0SdKdb7276fVc8p33pVXvW9/tePWdqStU7bXr85Q5vnG/y1Rp02rvm85b7W96Zeqa3UbV3jdTXqTOM/V6VlZK22bVu9KmWfWq9r7pvJV6ZbVRtfdN56pd39Je91OW5Ltm1aXcM5d2adP+kU3nqtSfZi3f6PkkU/nmtE+54kqbQrXq+2trtZmylXSj25QX3al80+y6JN+oT5n7lLm0S5v2vmke7Rrd6FnRXM/KSmlbTF0x9anzzP2UtXYbz29RtZ82pdT57nbTuHab9qlz9cZ3mjuu1PlONze4Vr1vbzfelVa9b6fdo6ja+6Zz1cmmNG3a++Y70c/Xc/uV0s7v6Oa02+28b3nnu+4V16r3rfdJvfGt5zeo2u82K1Spb3b9RGvKWnoude+7knerXqXbU1b3VFM25d7rueS77lNetPRcSv0qa+m51L2z61rtfdO5ardp733aOa5V71vfdZ/yRtV+2pS83/Ejb4jqObHri1dtJvx+yzP1KWt5pn6VKd67V3ZdybPJT1nJ8xv6vso3TSt1zdR710pZSzunNXWtaeNZOrcvada5+9Jp70xdM228a2mmXcqbJO/TObHri9aqO8lu8pZmnU9eWXWetzTr/CS7zVPWTF2z2ySlXeN98iXP3Jc06/w0c3nvvrTqp6zk2Y3XTOUbJ208c99ZyTP1nbl807uUK9Om5Zn6Xa7sNkmPbBTvky9pppx0qtXGz4rmek7s+uIVm6TbTfIlzab8Br/f8kx9ylqeuS95NvmUJV/SrHPPEtMudZ61PFN/QrqzykqeK63UFalbZSXPlVbqTvC7Lc0632XuU5Z8SbN35OR7bKWu8M59ZyXPJp+ylmeTn7KS58quL1qpO8HvtjRTbjr3ytSdkO571vJM/S5vtNfzI0z3U+fZzmteSp2y27RSV6TOs5Zn6m/zlmad77LkS56ls5LyVVby3Jk23rU8U7/KJkrf9m+ItlKvfOdmxendtPPM/U3muNKmuO08W0k3vfPslpZn6p2pX3WrXEmblDm+cf9opudV5j6RNilrpq5ZbVb5imf2K+lemTonbVdKO8+a1KWsc9Vqk/IidassyXe9Pc1T1kxdsesTuzveu0+Z+ylL8p2jGz2vSJtnM9Wq90y9s+pdqT/JnNVmlSvTJnUpm3LlZKOc7Hcb792vsmbXlTzz3uX7JN0oU1fs+uZ015zsdaPnr+b0s9LOM/cpc5+ylVb7idPttEudZ+5X2Y6V0s4zZ7dJ/Wn2atJnrLKk3c479Y+wU7rzCk6efbpRpf40U6V+l7m/yZyTzbOkz0hZM3WFK22KqTsh3ffM/SqbcqWVulNO7utGz4prtUm58opN6j1zf5M1qXsk0/OEKvXFSmnnmTNtpk5Ju5RNfPsbov114js3K07vpp1n7m8yxXv3ym3nmfsVp7uJ9IyUKVO/6la5kjYpc3zj/tFMz6vMfSJtUtZMXbParPIVN/vd9tleSduUObtN6k8y96tMSf1ptmK1TXnKmke7FSd3fOM+Ze5vsh1+x30ibR7Ndv4mU1LvmfubTJn6qWumTepSNuXKyaY52T6ycb/KmtsuZc3UNbvN1E+d8+qtb9x/JaeflXaeuU+Z+5S5d3a9crqddqnzzP0q23F652S326T+NHs16TNOsxP0np4/jZPvfbfx3v1N5vjGfcrc32TOyeZZ0mekrLnp3CtTd0K675n7VTblSit1p5zc142eV5n7Xa68YpN6z9zfZE3qHsn0PNG7/pqYOuVkN22mTkm7lE2UHnpDNGUTutdzYtcXr9pMpPueuU+Z+0czPSev3Haeub/JbknP0EzPU9bcdprpeZW5T5n7KSt5ls7tS5p1PmV6bl/STJm6ZtqkLmVT7pzsdptVn/JHMj2vsuRLmnV+41OWfEmzzk+y2zxlzapLecqU1J9kyZc8c1/SrPOTrFl1KddMz7us5NmNP8n0fJO576zkmXpl6opdX0yblmfqd7lysilOdmlzkiVf0ky57VLWTF2z26z6lKesmTrlZLfapHyVlTy/Id33zH3K3KfMfcrcp8z9V2RNSX3K3K+yHafPSZmz26T+NHNaqTvB77Y063yXvWrzjqTv0TP3jvfuTzP3KWt5NvmbzEkbz1qa3eB3W5opN517ZepO8Pstz9SvsilvtNfzDTf3Wqtu8ru82fXNbud9yzP1KXPveN/SrPNd5j5l6vWspPw0U3Z9kTaeuV9lE0dviBautFnRcl9KmevVmxtctxvVlKWutOtLU9dKmynzvKRd6ku+OcX1bK/abW/7V21avl3tSuqnXWnq1afedbNZbadOtdpp7rhONqWp105xTV1LN75TP+1aU1fS+75TP+1K3qdNaeq1U5KmrqT3fedd49pt1N9ufFeaeu8U16O9b33nfWu3ue2bJO98173vSt4pSVPX8o3vu/fcpbvVdtVrrqhSX7h2G/Wpd/VmtfX+KzelqSvt7rdWO80VVeob17RJ3Q2u241qlamme56XtLvZFK5VrtL7abvqpuwU164vPbJJu11f8o3uUneKSv20K+36km/SLm3eEdfUlbQ/2alOs1Z3uvGtb7wv7fqSbxrXqvf8BpX61Lt6M22nrqXPOEWlPnXTPml1Z5WdcLNvpa5Iuul745mTtNupT92U9XmFSv20K3m/27TSVnfelXZ9KW08S7ge3UyUtm+IAgAAAAAAAMDvoJRygB3v9t8O38/78G4/+/EbogAAAAAAAADw9/PnLwlCDgDwt1DiDVEAAAAAAAAA+POXBK3UAwD8DfCGKAAAAAAAAAAAAPwaSrwhCgAAAAAAAAAAAL8C3hAFAAAAAAAAAACAX0OJN0QBAAAAAAAAAADgV/CWb4j++YZC/gl88vcO/x3+LAF+D/zfOwAAAAAAwO+h9HZviJZS/pO0UqfsNq3UPUsrdXDPO/5etlL3LrRSB/Cu/M3/zapS/920dl3LN+9CK3UAAAAAAPDevOwN0T8PCfnfxO5n3PXN6e4RvvLZn8Bv+Pk/4Wf8hO/xE+D38Xl+++/hu/78q++r5ed35d2/PwAAAAAAyJRe8oZoKeV/E7ufcdc3p7tH+MpnfwK/4ef/hJ/xE77HT4Dfx+f57b+H7/rzr74vzfX8rnzC9wgAAAAAAP/O+IZoS8+ltEnSnW+9u+n1XPKd96VV79u0KbXXXtl1rfa+6Vy127T3Pu0c16r3re9OULWfNqXU+S5tknTnW+9uej2XfOd9adX7Nm1K7bW/IWm38d437b1PO6eVuhtU7adNKXW+u900rt2mfepcvfGt57eo2k+bUup8d7tpXLtN+9S5euM7zR1X6nynm1Naei6tdq1d3/I+3dFMc9VuM/XtfeO5npVW6k5oTVlLz6XudTdtWtOmcaV8tVc/3QEAAAAAgH8ojW+ItjxTv8oU790ru67k2eSnrOR5d+5LmimrzvOWZp3vsuRLnqWzkvJVVvJcO1fauS95pj5lLc/UrzLFe/fKrit5NvkpK3nenfuSZqeke565T1nyJc/S2Wml7hS/3/JMfcpanrkveTb5lCVf0qxzz5xW6k7x+y3P1Kes5Zn7kmeTT1nyJc069ywx7VLnWcsz9ae0UlekLmVTXqTOM/cpc++ZntuXNLuhlbpT0n3PWp6tvJ6VlmeT9+zk3L7kmXoAAAAAADj4N0T/lA9mjittitvOs5V00zvPmtSlbMqL1D2S6XlClfpipbTz7IbT+2nnmfubzHGlTXHbebaSbnrnWZO6lJ3iSv2U6XlClfpXcfr8tPPMfcrcp2yl1X7iZvsop5+Rdp65T5n7lK202k+cbqdd6jxzv8pO2N1babVNeZG6Vaba9S3tdb/KvpP0+Z65T5lKcyV1nrn3rM+rr437VQYAAAAA8Nspbd8QfTRTvHev3HaeuV8x7VKXsikvUvdIpueJ3vXXxNQpp7sVp/fTzjP3N5nivXvltvPM/Yppl7qUPYo/y71nep7oXX/9Kk6fn3aeuU+Z+5S5d3a9crN9lNPPSDvP3KfMfcrcO7teOd1Ou9R55n6VnbC7t+uVaZu6lDm+ce+kPmXfSfp8z9ynrH1/TaTOM/ee9Xn1tXG/ygAAAAAAfjtf+oaoZnpOXrntPHN/kzXetTTr3DPF+5Zmne8y9ylTr2cl5afZLekZnrlPmftHMz0nr9x2nrm/yRrvWpqddEXqPHOfMvcpU69np5W6U9J9z9ynzH3K3KfMfcrcP5O1NLsl3ffMfcrcp8x9ytynzP1XZE3qPHO/yk7Y3Ut9yqa88K7lmfqUufdMz+1Lmt3QSt0pfr/lmfqUqdezknLP3HvW59XXxv0qAwAAAAD47ZSWb4iqpix1pV1fmrpW2kyZ5yXtUl+aNup9oz6hUj/tSt7vNq201Z13pV1f8s0prtuNaspSV9r1palrpc2UeV7SLvWlaaN+tfO8STrZ3W5aaas77Ty/xXW7Ua0y1XTP85J2N5vCteo9v8V1u1GtMtV0z/OSdjebwrXKVXo/bVfdlJ2QdLI72ZSmjfrUt7pTXFOv3ncntFJ3g0p96nb70zurzPOSdt3vfGvKAAAAAADg4A1RWPPnNy7kAAAAAAAAAAAA8J6Uxn9DFAAAAAAAAAAAAOBvgTdEAQAAAAAAAAAA4NdQ4g1RAAAAAAAAAAAA+BXwhigAAAAAAAAAAAD8Gkq8IQoAAAAAAAAAAAC/At4QBQAAAAAAAAAAgF9DiTdE4SlKKf8KvvOzmp/4zIl3+35exXf8XK/+jFc/DwAAAAAAAAC+no96Q7SVOvg5pj8TVepvedVzbviJz5x4t+8noUp94mb7KNNnqFKfuNkCAAAAAAAAwHtQim+IqvxCS/Pv4qc+F57jU//c3u37frfvZ8fp93u6+w5Ov5fT3VfzLt8HAAAAAAAAwKcwviH6pxC/y7+Dn/xseJxP/XN7t+/73b6fHaff7+nuOzj9Xk53X827fB8AAAAAAAAAn0Jp/DdES5PXXJW6XXZC31H5ZterpszzknYntPRc8p33pZSv9pqvaPVZ8z4rqkd65WQzoZp6PZd8d8PqvmrKptx7PZd8133KmyTvfNe94np0U0xdkzYt7/WsqB7plWc3LT2XVruW97vNJN0BAAAAAAAAwH/n6N8Q/TOQr073U3ayOaHl2Y0/zUrdTfd2tDybvGcn5xNa6ey7yStT15xsTpie0/JM/Q3T3dR5tvOal1KnTJvUedbybPIpc7/KplxZbVrp7LvJK1PXvGLTSl2ROs/c32QAAAAAAAAAsKY0viHalFJepM4z96tsR7qzylTe9yadNUvy3Y50x7OVfL/6eoruV2fNVN43U9ecbE6YnpO6lJ1wck83elZcq03KldONKvW7zH3K3K+yKW+mXrvVWTOV983UNbvNri92m9R75v4mAwAAAAAAAIA1R2+IFn9GIS9S55n7VbYj3fFs51Ou5yl7hPQcz9w73a++nqL71fnEK1PXnGxOmJ6TupSdcHJPN3peZe53uXKycfyO+5S5T5n7VTblzdRrtzqfeGXqmt1m1xe7Teo9c3+TAQAAAAAAAMCa0o+8IdrS7IR0x7OdV1qr7iTbke545t6zPq++nqL71fnEK1PXnGxOmJ6TupTtuLnTWnWT3+XNri/SxrOWZ5NPmftVNuXF1BXar84nXpm6ZtpMnbLbpd4z989mAAAAAAAAAPAP2zdEk3yTdruNet+tUE2Z5y3tfZe6wpU2E6op87ykXfeT36FS7+e0b01d62ZzwqS0mbITbvat1BVJN31vPHOS0sa3vvG+dLuZ5Dv1ikq9n9O+NXWtm03v1CeSTnaPbgpX2gAAAAAAAADAP5SO3hAF+A2UUv5TvPL7eeWznuWdvpdTPvF7BgAAAAAAAIB/5/jfEAWAz+bP/6GHHAAAAAAAAADgN1HiDVGAvxxV6gEAAAAAAAAAfgu8IQoAAAAAAAAAAAC/hvoLUd4QBShOfqV7AAAAAAAAAADwMfCGKEBz8ivdAwAAAAAAAACAj4G/EAVoTn6lewAAAAAAAAAA8DHwF6Lw1/HnP+hw3nLyK90DAAAAAAAAAICP4fgvRFWpf0dUqX8FrrQpXGnTtFL3Xbge3bwKVeoV3eh5y8mvdA8AAAAAAAAAAD6Gq78QTflPcPK9+Mb9K0jPfCZTdv1Xkj7bM/er7NXsPkN7PR9x8ivdAwAAAAAAAACAj+Gv/AvR1KfsWdIzn8mUXf+VpM/2zP0qezWrz9gp3fk3Tn6lewAAAAAAAAAA8DG85C9EW3ourXYt73ebSb5Ld57NWt07qy7lnqlS36jaT5uS92lT0k63KXO/yl7N7jO01/MRJ7/SPQAAAAAAAAAA+Bhe9oZoK3VF6jxzf5Mp3fdXPyfvmZ7blzRTpq5I0i5tNevcfckz9Slz75med5nK+1NaqXN2O+31fMTJr3QPAAAAAAAAAAA+hpf+hWjKm9R75v4mU7rvr35OmZ6TX2VTPqF39LzK3K9Iu1Wm8k59ytyvsh16Z3VWVnmjvZ6POPmV7gEAAAAAAAAAwMfwV/+FaJ9buukunZO/yXb4Hfcpc78i7VLm6EbPq8z9Krullbpi1e2U7vwbJ7/SPQAAAAAAAAAA+Bj+mr8Q1UzPO1opd1/yTP0qU1LvWUuzzneZ+5S590zPq8z9Kns1u8/QXs9HnPxK9wAAAAAAAAAA4GP45y9E//Wv/wvI/RQqZRXRfQAAAABJRU5ErkJggg==" alt="img"></p><p>docker rm不掉容器 </p><p>解决方法：docker守护进程重启了，现在只能重启解决 </p><p>链接： <a href="https://github.com/moby/moby/issues/36002" target="_blank" rel="noopener">https://github.com/moby/moby/issues/36002</a></p><h4 id="3、"><a href="#3、" class="headerlink" title="3、"></a>3、</h4><h3 id="指北："><a href="#指北：" class="headerlink" title="指北："></a>指北：</h3><h4 id="一、"><a href="#一、" class="headerlink" title="一、"></a>一、</h4><p><img src="data:image/png;base64,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" alt="img"></p><p>原因：版本不兼容   7.2版本 升级系统7.4可解决</p><h4 id="二、no-matching-entries-in-passwd-file"><a href="#二、no-matching-entries-in-passwd-file" class="headerlink" title="二、no matching entries in passwd file"></a>二、<strong>no matching entries in passwd file</strong></h4><blockquote><p>进不去容器 </p><p>重启docker </p></blockquote><h4 id="三、standard-init-linux-go-195-exec-user-process-caused-“exec-format-error”"><a href="#三、standard-init-linux-go-195-exec-user-process-caused-“exec-format-error”" class="headerlink" title="三、standard_init_linux.go:195: exec user process caused “exec format error”"></a>三、<strong>standard_init_linux.go:195: exec user process caused “exec format error”</strong></h4><blockquote><p>进不去容器； </p><p>启动脚本错误 </p><p>启动脚本=======》 #！/bin/bash </p></blockquote><h4 id="四、内核：enterd-disabled-state"><a href="#四、内核：enterd-disabled-state" class="headerlink" title="四、内核：enterd disabled state"></a>四、内核：<strong>enterd disabled state</strong></h4><blockquote><p>被禁用状态 </p><p>主机内核有问题 </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> Docker_problem </tag>
            
            <tag> Docker的一些东西 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安静写点东西</title>
      <link href="/sheldon_blog/passages/%E5%AE%89%E9%9D%99%E5%86%99%E7%82%B9%E4%B8%9C%E8%A5%BF/"/>
      <url>/sheldon_blog/passages/%E5%AE%89%E9%9D%99%E5%86%99%E7%82%B9%E4%B8%9C%E8%A5%BF/</url>
      
        <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Come on ٩(๑.◡.๑)۶ ，Please ecter Password (*ﾉ▽ﾉ)." />    <label for="pass">Come on ٩(๑.◡.๑)۶ ，Please ecter Password (*ﾉ▽ﾉ).</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/sheldon_blog/lib/crypto-js.js"></script><script src="/sheldon_blog/lib/blog-encrypt.js"></script><link href="/sheldon_blog/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> 生活需要一点方式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes_填坑</title>
      <link href="/sheldon_blog/passages/Kubernetes-%E5%A1%AB%E5%9D%91/"/>
      <url>/sheldon_blog/passages/Kubernetes-%E5%A1%AB%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<h2 id="更新19-4-5"><a href="#更新19-4-5" class="headerlink" title="更新19.4.5"></a>更新19.4.5</h2><h3 id="一、etcd-单点问题"><a href="#一、etcd-单点问题" class="headerlink" title="一、etcd 单点问题"></a>一、etcd 单点问题<a id="more"></a></h3><p>默认<code>kubeadm</code>创建的集群会在内部启动一个单点的 etcd，当然大部分情况下 etcd 还是很稳定的，<strong>但是一但 etcd 由于某种原因挂掉，这个问题会非常严重，会导致整个集群不可用</strong>。具体原因是 etcd 存储着 kubernetes 各种元数据信息；包括 <code>kubectl get pod</code>等等基础命令实际上全部是调用 RESTful API 从 etcd 中获取的信息；<strong>所以一但 etcd 挂掉以后，基本等同于<code>kubectl</code>命令不可用，集群各节点也会因无法从 etcd 获取数据而出现无法调度，最终挂掉</strong>。</p><p><strong>解决办法：是在使用<code>kubeadm</code>创建集群时使用 –external-etcd-endpoints 参数指定外部 etcd 集群，此时<code>kubeadm</code> 将不会在内部创建 etcd，转而使用外部我们指定的 etcd 集群，如果外部 etcd 集群配置了 SSL 加密，那么还需要配合 –external-etcd-cafile、–external-etcd-certfile、–external-etcd-keyfile 三个参数指定 etcd 的 CA证书、CA签发的使用证书和私钥文件，命令如下</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 非 SSL</span><br><span class="line"><span class="meta">#</span> kubeadm init --external-etcd-endpoints http://x.x.x.1:2379</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> etcd SSL</span><br><span class="line"><span class="meta">#</span> kubeadm init --external-etcd-endpoints https://x.x.x.1:2379 --external-etcd-cafile /path/to/ca --external-etcd-certfile /path/to/cert --external-etcd-keyfile /path/to/privatekey</span><br></pre></td></tr></table></figure><h3 id="二、etcd-不可与-master-同在"><a href="#二、etcd-不可与-master-同在" class="headerlink" title="二、etcd 不可与 master 同在"></a>二、etcd 不可与 master 同在</h3><p>‘愿上帝与你同在’……这个坑是由于<code>kubeadm</code>的 check 机制的 bug 造成的，目前还没有修复；表现为 <strong>当 etcd 与 master 在同一节点时，kubeadm init 会失败，同时报错信息提示’已经存在了 /var/lib/etcd 目录，或者 2379 端口被占用’</strong>；因为默认<code>kubeadm</code>会创建 etcd，而默认的 etcd 会占用这个目录和 2379 端口，<strong>即使你加了<code>--external-etcd-endpoints</code>参数，<code>kubeadm</code>仍然会检测这两项条件是否满足，不满足则禁止 init 操作</strong></p><p><strong>解决办法：就是要么外部的 etcd 更换数据目录(/var/lib/etcd)和端口，要么干脆不要和 master 放在同一主机即可</strong></p><h3 id="三、巨大的日志"><a href="#三、巨大的日志" class="headerlink" title="三、巨大的日志"></a>三、巨大的日志</h3><p>熟悉的小伙伴应该清楚，基本上每个 kubernetes 组件都会有个通用的参数 <code>--v</code>；这个参数用于控制 kubernetes 各个组件的日志级别，在早期(alpha)的 kubeadm 版本中，如果不进行调整，默认创建集群所有组件日志级别全部为 <code>--v=4</code> 即最高级别输出，这会导致在业务量大的时候磁盘空间以 <strong>‘我去尼玛’</strong> 的速度增长，尤其是 <code>kube-proxy</code> 组件的容器，会疯狂吃掉你的磁盘空间，然后剩下懵逼的你不知为何。在后续的版本中(beta)发现日志级别已经降到了 <code>--v=2</code>，不过对于完全不怎么看日志的我来说还是无卵用……</p><p><strong>解决办法有两种方案:</strong></p><p><strong>1、如果已经 –v=4 跑起来了(检查方法就是随便 describe 一个 kube-proxy 的容器，看下 command 字段就能看到)，并且无法停止重建集群，那么最简单的办法就是使用<code>kubectl edit ds xxx</code>方式编译一下相关 ds 文件等，然后手动杀掉相关 pod，让 kubernetes 自动重建即可，如果命令行用着不爽也可以通过 dashboard 更改</strong></p><p><strong>2、如果还没开始搭建，或者可以停掉重建，那么只需在<code>kubeadm init</code>之前<code>export KUBE_COMPONENT_LOGLEVEL=&#39;--v=0&#39;</code>即可</strong></p><h3 id="四、新节点加入-dns-要你命"><a href="#四、新节点加入-dns-要你命" class="headerlink" title="四、新节点加入 dns 要你命"></a>四、新节点加入 dns 要你命</h3><p>当 kubeadm 创建好集群以后，如果有需要增加新节点，那么在 <code>kubeadm join</code> 之后务必检查 <code>kube-dns</code> 组件，dns 在某些(weave 启动不完整或不正常)情况下，会由于新节点加入而挂掉，此时整个集群 dns 失效，<strong>所以最好 join 完观察一会 dns 状态，如果发现不正常马上杀掉 dns pod，让 kubernetes 自动重建；如果情况允许最好全部 join 完成后直接干掉 dns 让 kubernetes 重建一下</strong></p><h3 id="五、单点的-dns-浪起来让你怕（更新-19-4-5）"><a href="#五、单点的-dns-浪起来让你怕（更新-19-4-5）" class="headerlink" title="五、单点的 dns 浪起来让你怕（更新-19.4.5）"></a>五、单点的 dns 浪起来让你怕（更新-19.4.5）</h3><p>kubeadm 创建的 dns 默认也是单点的，而 dns 至关重要，只要一挂瞬间整个集群全部 <code>game over</code>；<strong>不过暂时还是没有发现能在 init 时候创建多个 dns 的方法；不过在集群创建后可以通过<code>kubectl edit deploy kube-dns</code>的方式修改其副本数量，让其创建多个副本即可</strong>，<strong><em>目前新版本kubernetes所使用的dns已经不是单pod三container，而是启动两个pod的coredns，解决单点问题</em></strong></p><h3 id="六、coredns一直处于ContainerCreating状态"><a href="#六、coredns一直处于ContainerCreating状态" class="headerlink" title="六、coredns一直处于ContainerCreating状态"></a>六、coredns一直处于ContainerCreating状态</h3><blockquote><p>Node加入集群中后一直处于NotReady状态，查看kube-system的状态，发现coredns一直处于ContainerCreating状态，flannel启动正常</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> kubectl get nodes</span><br><span class="line">NAME              STATUS     ROLES    AGE     VERSION</span><br><span class="line">master1.rsq.com   NotReady   master   16h     v1.13.0</span><br><span class="line">node01.rsq.com    NotReady   &lt;none&gt;   16h     v1.13.0</span><br><span class="line">node02.rsq.com    NotReady   &lt;none&gt;   8m39s   v1.13.0</span><br></pre></td></tr></table></figure><p>查看kubelet服务状态，看最后几行的报错</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> systemctl status kubelet</span><br><span class="line">● kubelet.service - kubelet: The Kubernetes Node Agent</span><br><span class="line">   Loaded: loaded (/etc/systemd/system/kubelet.service; enabled; vendor preset: disabled)</span><br><span class="line">  Drop-In: /etc/systemd/system/kubelet.service.d</span><br><span class="line">           └─10-kubeadm.conf</span><br><span class="line">   Active: active (running) since Wed 2018-12-12 09:24:44 CST; 6min ago</span><br><span class="line">     Docs: https://kubernetes.io/docs/</span><br><span class="line"> Main PID: 123631 (kubelet)</span><br><span class="line">   Memory: 35.2M</span><br><span class="line">   CGroup: /system.slice/kubelet.service</span><br><span class="line">           └─123631 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/config.yaml --cgrou...</span><br><span class="line"></span><br><span class="line">Dec 12 09:30:57 master1.rsq.com kubelet[123631]: E1212 09:30:57.187292  123631 pod_workers.go:190] Error syncing pod cea84a11-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-fzs9l_kube-...</span><br><span class="line">Dec 12 09:30:57 master1.rsq.com kubelet[123631]: E1212 09:30:57.187480  123631 pod_workers.go:190] Error syncing pod cea7ebef-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-hrwvk_kube-...</span><br><span class="line">Dec 12 09:30:59 master1.rsq.com kubelet[123631]: E1212 09:30:59.187419  123631 pod_workers.go:190] Error syncing pod cea84a11-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-fzs9l_kube-...</span><br><span class="line">Dec 12 09:30:59 master1.rsq.com kubelet[123631]: E1212 09:30:59.187607  123631 pod_workers.go:190] Error syncing pod cea7ebef-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-hrwvk_kube-...</span><br><span class="line">Dec 12 09:31:00 master1.rsq.com kubelet[123631]: W1212 09:31:00.454147  123631 cni.go:203] Unable to update cni config: No networks found in /etc/cni/net.d</span><br><span class="line">Dec 12 09:31:00 master1.rsq.com kubelet[123631]: E1212 09:31:00.454242  123631 kubelet.go:2192] Container runtime network not ready: NetworkReady=false reason:NetworkPluginNot...initialized</span><br><span class="line">Dec 12 09:31:01 master1.rsq.com kubelet[123631]: E1212 09:31:01.188877  123631 pod_workers.go:190] Error syncing pod cea7ebef-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-hrwvk_kube-...</span><br><span class="line">Dec 12 09:31:01 master1.rsq.com kubelet[123631]: E1212 09:31:01.189259  123631 pod_workers.go:190] Error syncing pod cea84a11-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-fzs9l_kube-...</span><br><span class="line">Dec 12 09:31:03 master1.rsq.com kubelet[123631]: E1212 09:31:03.187200  123631 pod_workers.go:190] Error syncing pod cea84a11-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-fzs9l_kube-...</span><br><span class="line">Dec 12 09:31:03 master1.rsq.com kubelet[123631]: E1212 09:31:03.187730  123631 pod_workers.go:190] Error syncing pod cea7ebef-fd24-11e8-a282-000c291e37c2 ("coredns-86c58d9df4-hrwvk_kube-...</span><br><span class="line">Hint: Some lines were ellipsized, use -l to show in full.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 附加PS</span><br><span class="line"><span class="meta">#</span> 报错10.244.0.1 网络已存在（更新）</span><br></pre></td></tr></table></figure><p>产生问题原因：</p><p>一直报网络NotReady，我就感觉flannel组件出了问题， 最后网上搜了一些资料解决<br>参考博客：<a href="http://www.cnblogs.com/effortsing/p/10014611.html" target="_blank" rel="noopener">coreDNS一直处于创建中解决</a><br>解决办法：所有节点执行（我只在master节点先执行就解决问题了）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> rm -rf /var/lib/cni/flannel/* &amp;&amp; rm -rf /var/lib/cni/networks/cbr0/* &amp;&amp; ip link delete cni0</span><br><span class="line"><span class="meta">#</span> rm -rf /var/lib/cni/networks/cni0/*</span><br></pre></td></tr></table></figure><p>删除flannel组件，重新下载</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> docker rmi quay.io/coreos/flannel:v0.10.0-amd64</span><br><span class="line"><span class="meta">#</span> kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br></pre></td></tr></table></figure><p>查看节点状态已经处于Ready状态</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> kubectl get nodes</span><br><span class="line">NAME              STATUS   ROLES    AGE   VERSION</span><br><span class="line">master1.rsq.com   Ready    master   16h   v1.13.0</span><br><span class="line">node01.rsq.com    Ready    &lt;none&gt;   16h   v1.13.0</span><br><span class="line">node02.rsq.com    Ready    &lt;none&gt;   39m   v1.13.0</span><br></pre></td></tr></table></figure><h3 id="七、kubeadm-join报错"><a href="#七、kubeadm-join报错" class="headerlink" title="七、kubeadm join报错"></a>七、kubeadm join报错</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在部署服务过程中，初始化之后重启了master节点，然后node节点在join进群的时候报错，提示证书是否过期等问题，报错信息如下：</span><br><span class="line"><span class="meta">#</span> kubeadm join 10.0.0.100:6443 --token qxl5b3.5b78nwu3gm1r4u6o --discovery-token-ca-cert-hash sha256:3e20fa8054cbc9000cf3d3586a05a01d8af5721b577856e93c7e243877393d21 --ignore-preflight-errors=Swap</span><br><span class="line"></span><br><span class="line">[preflight] Running pre-flight checks</span><br><span class="line">[WARNING Swap]: running with swap on is not supported. Please disable swap</span><br><span class="line">[WARNING SystemVerification]: this Docker version is not on the list of validated versions: 18.09.0. Latest validated version: 18.06</span><br><span class="line">[discovery] Trying to connect to API Server "10.0.0.100:6443"</span><br><span class="line">[discovery] Created cluster-info discovery client, requesting info from "https://10.0.0.100:6443"</span><br><span class="line">[discovery] Failed to request cluster info, will try again: [Get https://10.0.0.100:6443/api/v1/namespaces/kube-public/configmaps/cluster-info: dial tcp 10.0.0.100:6443: connect: connection refused]</span><br><span class="line">[discovery] Failed to request cluster info, will try again: [Get https://10.0.0.100:6443/api/v1/namespaces/kube-public/configmaps/cluster-info: dial tcp 10.0.0.100:6443: connect: connection refused]</span><br></pre></td></tr></table></figure><blockquote><p>产生原因：有可能是时间不同步造成的，在初始化后重启master，重启后会报错</p></blockquote><p>找了好多资料，没有找到可行的，最后kubeadm reset完美解决<br>参考博文： <a href="https://www.cnblogs.com/justmine/p/8886675.html" target="_blank" rel="noopener">k8s踩坑记 - kubeadm join 之 token 失效</a><br>reset之后重新初始化</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> kubeadm reset</span><br><span class="line"><span class="meta">#</span> kubeadm init --kubernetes-version=v1.13.0 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12 --token-ttl=0 --ignore-preflight-errors=Swap</span><br></pre></td></tr></table></figure><p>创建所需文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> mkdir -p $HOME/.kube</span><br><span class="line"><span class="meta">#</span> cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line"><span class="meta">#</span> chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure><p>查看节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> kubectl get nodes</span><br><span class="line">NAME              STATUS     ROLES    AGE     VERSION</span><br><span class="line">master1.rsq.com   NotReady   master   2m49s   v1.13.0</span><br></pre></td></tr></table></figure><h3 id="八、Etcd二进制安装目录也会报错哦"><a href="#八、Etcd二进制安装目录也会报错哦" class="headerlink" title="八、Etcd二进制安装目录也会报错哦"></a>八、Etcd二进制安装目录也会报错哦</h3><p><strong>etcd服务启动后报错etcd cluster ID mismatch：</strong>检查service配置cluster选项有无问题，若无问题，则可能是此前的etcd bootstrap加速启动缓存残留导致，坑爹的是<code>rm -rf /var/lib/etcd/*</code>删除完了之后还是报错，必须<code>rm -rf /var/lib/etcd/</code>才能彻底清除，删除完成后记得再创建该路径mkdir /var/lib/etcd，否则会有类似报错：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">etcd.service: Failed at step CHDIR spawning /usr/local/bin/etcd: No such file or directory</span><br></pre></td></tr></table></figure><h3 id="九、二进制安装后重建相关组件会出现secrets报错"><a href="#九、二进制安装后重建相关组件会出现secrets报错" class="headerlink" title="九、二进制安装后重建相关组件会出现secrets报错"></a>九、二进制安装后重建相关组件会出现secrets报错</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">May 27 10:34:45 kube-node3 journal: E0527 02:34:45.767392      1 config.go:322] Expected to load root CA config from /var/run/secrets/kubernetes.io/serviceaccount/ca.crt, but got err: open /var/run/secrets/kubernetes.io/serviceaccount/ca.crt: no such file or directory </span><br><span class="line"></span><br><span class="line">May 27 10:34:45 kube-node3 journal: E0527 02:34:45.767392      1 config.go:322] Expected to load root CA config from /var/run/secrets/kubernetes.io/serviceaccount/ca.crt, but got err: open /var/run/secrets/kubernetes.io/serviceaccount/ca.crt: no such file or directory</span><br></pre></td></tr></table></figure><blockquote><p>分析：产生这个错误是因为Kubernetes默认创建的secrets资源不包含用于访问kube-apiserver的根证书 </p><p>需要给apiserver设置安全证书，然后删除默认secrets，系统会自动产生新的secrets </p><p>secrets一般集群安装时默认自动创建 </p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> kubectl delete secret secretname -n Xxx</span><br></pre></td></tr></table></figure><h3 id="十、kubeadm生成集群，加入节点时发现忘记了join-token-怎么办？"><a href="#十、kubeadm生成集群，加入节点时发现忘记了join-token-怎么办？" class="headerlink" title="十、kubeadm生成集群，加入节点时发现忘记了join token 怎么办？"></a>十、kubeadm生成集群，加入节点时发现忘记了join token 怎么办？</h3><blockquote><p>1.生成一条永久有效的token </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> # kubeadm token create --ttl 0 </span><br><span class="line"><span class="meta">&gt;</span> o4avtg.65ji6b778nyacw68 </span><br><span class="line"><span class="meta">&gt;</span> </span><br><span class="line"><span class="meta">&gt;</span> # kubeadm token list </span><br><span class="line"><span class="meta">&gt;</span> TOKEN                     TTL         EXPIRES                     USAGES                   DESCRIPTION   EXTRA GROUPS </span><br><span class="line"><span class="meta">&gt;</span> dxnj79.rnj561a137ri76ym   &lt;invalid&gt;   2018-11-\#02T14:06:43+08:00   authentication,signing   &lt;none&gt;        system:bootstrappers:kubeadm:default-node-token </span><br><span class="line"><span class="meta">&gt;</span> o4avtg.65ji6b778nyacw68   &lt;forever&gt;   &lt;never&gt;                     authentication,signing   &lt;none&gt;        system:bootstrappers:kubeadm:default-node-token </span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>2.获取ca证书sha256编码hash值 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> # openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //' </span><br><span class="line"><span class="meta">&gt;</span> </span><br><span class="line"><span class="meta">&gt;</span> 2cc3029123db737f234186636330e87b5510c173c669f513a9c0e0da395515b0 </span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>3.node节点加入 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> # kubeadm join x.x.x.x:6443 --token o4avtg.65ji6b778nyacw68 --discovery-token-ca-cert-hash sha256:2cc3029123db737f234186636330e87b5510c173c669f513a9c0e0da395515b0 </span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote></blockquote><p>###十一、</p>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> kubernetes_problem </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes安装-kubeadm_1.13.5</title>
      <link href="/sheldon_blog/passages/Kubernetes%E5%AE%89%E8%A3%85-kubeadm-1-13-5/"/>
      <url>/sheldon_blog/passages/Kubernetes%E5%AE%89%E8%A3%85-kubeadm-1-13-5/</url>
      
        <content type="html"><![CDATA[<h2 id="环境描述"><a href="#环境描述" class="headerlink" title="环境描述"></a>环境描述</h2><blockquote><p>kubernetes version：1.13.5</p><p>docker version：18.6.3</p><p>Redhat：7.6</p></blockquote><a id="more"></a><table><thead><tr><th style="text-align:left">x.x.x.1</th><th style="text-align:center">master-1</th><th>kube-apiserver、kube-controller-manager、kube-scheduler、etcd、keepalive、docker</th></tr></thead><tbody><tr><td style="text-align:left"><strong>x.x.x.2</strong></td><td style="text-align:center"><strong>master-2</strong></td><td><strong>kube-apiserver、kube-controller-manager、kube-scheduler、etcd、keepalive、docker</strong></td></tr><tr><td style="text-align:left"><strong>x.x.x.3</strong></td><td style="text-align:center"><strong>master-3</strong></td><td><strong>kube-apiserver、kube-controller-manager、kube-scheduler、etcd、keepalive、docker</strong></td></tr><tr><td style="text-align:left"><strong>x.x.x.4</strong></td><td style="text-align:center"><strong>vip</strong></td><td></td></tr><tr><td style="text-align:left"><strong>x.x.x.5</strong></td><td style="text-align:center"><strong>node-1</strong></td><td><strong>kubelet、docker</strong></td></tr><tr><td style="text-align:left"><strong>x.x.x.6</strong></td><td style="text-align:center"><strong>node-2</strong></td><td><strong>kubelet、docker</strong></td></tr></tbody></table><p>因为担心kubeadm起来的etcd不稳定，这里用到的etcd对于kubernetes来说作为外部etcd集群。即使用二进制安装etcd集群，其余组件用kubeadm来完成安装。</p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><h3 id="1、准备工作"><a href="#1、准备工作" class="headerlink" title="1、准备工作"></a>1、准备工作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">echo "1" &gt; /proc/sys/net/bridge/bridge-nf-call-iptables</span><br><span class="line"><span class="meta">#</span> 停防火墙</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta">#</span> 关闭Swap</span><br><span class="line">swapoff -a</span><br><span class="line">sed 's/.*swap.*/#&amp;/' /etc/fstab</span><br><span class="line"><span class="meta">#</span> 关闭防火墙</span><br><span class="line">systemctl disable firewalld &amp;&amp; systemctl stop firewalld &amp;&amp; systemctl status firewalld</span><br><span class="line"><span class="meta">#</span> 关闭Selinux</span><br><span class="line">setenforce  0</span><br><span class="line">sed -i "s/^SELINUX=enforcing/SELINUX=disabled/g" /etc/sysconfig/selinux</span><br><span class="line">sed -i "s/^SELINUX=enforcing/SELINUX=disabled/g" /etc/selinux/config</span><br><span class="line">sed -i "s/^SELINUX=permissive/SELINUX=disabled/g" /etc/sysconfig/selinux</span><br><span class="line">sed -i "s/^SELINUX=permissive/SELINUX=disabled/g" /etc/selinux/config</span><br></pre></td></tr></table></figure><h3 id="2、docker安装"><a href="#2、docker安装" class="headerlink" title="2、docker安装"></a>2、docker安装</h3><h4 id="1、下载设置源"><a href="#1、下载设置源" class="headerlink" title="1、下载设置源"></a>1、下载设置源</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils \</span><br><span class="line">  device-mapper-persistent-data \</span><br><span class="line">  lvm2</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager \</span><br><span class="line">--add-repo \</span><br><span class="line">https://download.daocloud.io/docker/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><h4 id="2、安装docker"><a href="#2、安装docker" class="headerlink" title="2、安装docker"></a>2、安装docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | sort -r  # 列出docker-ce的版本list</span><br><span class="line">yum install docker-ce-&lt;版本号&gt; -y # -y 安装docker需要的依赖，其中有个container-selinux的也可以单独下载</span><br><span class="line"><span class="meta">#</span> rpm -ivh container-selinux-2.33-1.git86f33cd.el7.noarch.rpm</span><br></pre></td></tr></table></figure><h4 id="3、启动docker"><a href="#3、启动docker" class="headerlink" title="3、启动docker"></a>3、启动docker</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line">docker version # 验证docker安装是否完成并启动成功</span><br></pre></td></tr></table></figure><h3 id="3、kubeadm-kubelet-kubectl安装"><a href="#3、kubeadm-kubelet-kubectl安装" class="headerlink" title="3、kubeadm/kubelet/kubectl安装"></a>3、kubeadm/kubelet/kubectl安装</h3><blockquote><p>各节点安装</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum install -y kubelet-1.13.5 kubeadm-1.13.5 kubectl-1.13.5 --disableexcludes=kubernetes  #禁用除kubernetes之外的仓库,要用 -y 参数，会自动安装kube-cni等插件</span><br><span class="line"></span><br><span class="line">systemctl start kubelet</span><br><span class="line">systemctl enable kubelet # kubeadm 要求kubelet保持开机自启状态</span><br></pre></td></tr></table></figure><h3 id="4、keepalive安装"><a href="#4、keepalive安装" class="headerlink" title="4、keepalive安装"></a>4、keepalive安装</h3><blockquote><p>master节点安装：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">yum install -y keepalived</span><br><span class="line">systemctl start keepalived</span><br><span class="line"></span><br><span class="line">vim /etc/keepalived/keepalived.conf</span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id LVS_k8s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_script CheckK8sMaster &#123;</span><br><span class="line">    script &quot;curl -k https://10.70.49.130:6443&quot;</span><br><span class="line">    interval 3</span><br><span class="line">    timeout 9</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface ens256 # 网卡</span><br><span class="line">    virtual_router_id 61</span><br><span class="line">    # 主节点权重最高 依次减少</span><br><span class="line">    priority 120</span><br><span class="line">    advert_int 1</span><br><span class="line">    #修改为本地IP </span><br><span class="line">    mcast_src_ip x.x.x.2</span><br><span class="line">    nopreempt</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass sqP05dQgMSlzrxHj</span><br><span class="line">    &#125;</span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">        x.x.x.1</span><br><span class="line">        #x.x.x.2</span><br><span class="line">        x.x.x.3</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        x.x.x.4</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        CheckK8sMaster</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="kubernetes部署"><a href="#kubernetes部署" class="headerlink" title="kubernetes部署"></a>kubernetes部署</h2><h3 id="1、etcd二进制部署"><a href="#1、etcd二进制部署" class="headerlink" title="1、etcd二进制部署"></a>1、etcd二进制部署</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 1.cfssl签发证书</span><br><span class="line">wget https://pkg.cfssl.org/R1.2/cfssl_linux-amd64</span><br><span class="line">chmod +x cfssl_linux-amd64</span><br><span class="line">mv cfssl_linux-amd64 /usr/local/bin/cfssl</span><br><span class="line">wget https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64</span><br><span class="line">chmod +x cfssljson_linux-amd64</span><br><span class="line">mv cfssljson_linux-amd64 /usr/local/bin/cfssljson</span><br><span class="line">wget https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64</span><br><span class="line">chmod +x cfssl-certinfo_linux-amd64</span><br><span class="line">mv cfssl-certinfo_linux-amd64 /usr/local/bin/cfssl-certinfo</span><br><span class="line">export PATH=/usr/local/bin:$PATH</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 2.根据config.json文件的格式创建如下的ca-config.json文件,过期时间设置成了 87600h</span><br><span class="line">mkdir /root/ssl</span><br><span class="line">cd /root/ssl</span><br><span class="line">cfssl print-defaults config &gt; config.json</span><br><span class="line">cfssl print-defaults csr &gt; csr.json</span><br><span class="line"></span><br><span class="line">cat &gt; ca-config.json &lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">  "signing": &#123;</span><br><span class="line">    "default": &#123;</span><br><span class="line">      "expiry": "87600h"</span><br><span class="line">    &#125;,</span><br><span class="line">    "profiles": &#123;</span><br><span class="line">      "kubernetes": &#123;</span><br><span class="line">        "usages": [</span><br><span class="line">            "signing",</span><br><span class="line">            "key encipherment",</span><br><span class="line">            "server auth",</span><br><span class="line">            "client auth"</span><br><span class="line">        ],</span><br><span class="line">        "expiry": "87600h"</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">cat &gt; ca-csr.json &lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">  "CN": "kubernetes",</span><br><span class="line">  "key": &#123;</span><br><span class="line">    "algo": "rsa",</span><br><span class="line">    "size": 2048</span><br><span class="line">  &#125;,</span><br><span class="line">  "names": [</span><br><span class="line">    &#123;</span><br><span class="line">      "C": "CN",</span><br><span class="line">      "ST": "BeiJing",</span><br><span class="line">      "L": "BeiJing",</span><br><span class="line">      "O": "k8s",</span><br><span class="line">      "OU": "System"</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cfssl gencert -initca ca-csr.json | cfssljson -bare ca</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 3.创建kubernetes-etcd证书</span><br><span class="line">cat &gt; kubernetes-etcd-csr.json &lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">    "CN": "kubernetes",</span><br><span class="line">    "hosts": [</span><br><span class="line">      "x.x.x.1",</span><br><span class="line">      "x.x.x.2",</span><br><span class="line">      "x.x.x.3",</span><br><span class="line">      "x.x.x.4",</span><br><span class="line">      "127.0.0.1",</span><br><span class="line">      "10.254.0.1",</span><br><span class="line">      "kubernetes",</span><br><span class="line">      "kubernetes.default",</span><br><span class="line">      "kubernetes.default.svc",</span><br><span class="line">      "kubernetes.default.svc.cluster",</span><br><span class="line">      "kubernetes.default.svc.cluster.local"</span><br><span class="line">    ],</span><br><span class="line">    "key": &#123;</span><br><span class="line">        "algo": "rsa",</span><br><span class="line">        "size": 2048</span><br><span class="line">    &#125;,</span><br><span class="line">    "names": [</span><br><span class="line">        &#123;</span><br><span class="line">            "C": "CN",</span><br><span class="line">            "ST": "BeiJing",</span><br><span class="line">            "L": "BeiJing",</span><br><span class="line">            "O": "k8s",</span><br><span class="line">            "OU": "System"</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes kubernetes-etcd-csr.json | cfssljson -bare etcd</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 4.目录证书文件如下</span><br><span class="line">etcd-key.pem etcd.pem ca.pem ca.key</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 保证三节点证书一致</span><br><span class="line">scp /etc/etcd/ssl/* master2:/etc/etcd/ssl/</span><br><span class="line">scp /etc/etcd/ssl/* master3:/etc/etcd/ssl/</span><br></pre></td></tr></table></figure><blockquote><p>证书生成完毕之后，将CA证书ca.pem, etcd秘钥etcd-key.pem, etcd证书etcd.pem拷贝到各节点的/etc/etcd/ssl目录中。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 这里就用etcd 3.3.10版本</span><br><span class="line"><span class="meta">#</span> 一：</span><br><span class="line">wget https://github.com/coreos/etcd/releases/download/v3.3.10/etcd-v3.3.10-linux-amd64.tar.gz</span><br><span class="line"><span class="meta">#</span> 解压缩etcd-v3.3.10-linux-amd64.tar.gz，将其中的etcd和etcdctl两个可执行文件复制到各节点的/usr/bin和/usr/local/bin目录。</span><br><span class="line">tar zxvf etcd-v3.3.10-linux-amd64.tar.gz</span><br><span class="line">cp etcd-v3.3.10-linux-amd64/etcd* /usr/local/bin/</span><br><span class="line">cp etcd-v3.3.10-linux-amd64/etcd* /usr/bin/</span><br><span class="line">mkdir /var/lib/etcd     #etcd的数据目录</span><br><span class="line">mkdir /etc/etcd        #etcd的配置文件目录</span><br><span class="line"><span class="meta">#</span> 二：</span><br><span class="line">yum -y install etcd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 安装好etcd之后，就可以修改etcd配置以及启动service，文件路径为：/etc/etcd/etcd.conf和/usr/lib/systemd/system/etcd.service</span><br><span class="line">cat &gt; /etc/etcd/etcd.conf &lt;&lt; EOF</span><br><span class="line"><span class="meta">#</span> [member]</span><br><span class="line">ETCD_NAME=etcd1 # etcd名字 三节点的话为 etcd1 etcd2 etcd3</span><br><span class="line">ETCD_DATA_DIR="/data/etcd" # etcd数据目录指定</span><br><span class="line">ETCD_LISTEN_PEER_URLS="https://x.x.x.1:2380" # 修改每个master节点的ip</span><br><span class="line">ETCD_LISTEN_CLIENT_URLS="https://x.x.x.1:2379"</span><br><span class="line"><span class="meta">#</span>[cluster]</span><br><span class="line">ETCD_INITIAL_ADVERTISE_PEER_URLS="https://x.x.x.1:2380"</span><br><span class="line">ETCD_INITIAL_CLUSTER_TOKEN="etcd-cluster"</span><br><span class="line">ETCD_ADVERTISE_CLIENT_URLS="https://x.x.x.1:2379"</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt; /usr/lib/systemd/system/etcd.service &lt;&lt; EOF</span><br><span class="line">[Unit]</span><br><span class="line">Description=Etcd Server</span><br><span class="line">After=network.target</span><br><span class="line">After=network-online.target</span><br><span class="line">Wants=network-online.target</span><br><span class="line">Documentation=https://github.com/coreos</span><br><span class="line">[Service]</span><br><span class="line">Type=notify</span><br><span class="line">WorkingDirectory=/var/lib/etcd/</span><br><span class="line">EnvironmentFile=-/etc/etcd/etcd.conf</span><br><span class="line">ExecStart=/usr/local/bin/etcd \</span><br><span class="line">  --name $&#123;ETCD_NAME&#125; \</span><br><span class="line">  --cert-file=/etc/etcd/ssl/etcd.pem \</span><br><span class="line">  --key-file=/etc/etcd/ssl/etcd-key.pem \</span><br><span class="line">  --peer-cert-file=/etc/etcd/ssl/etcd.pem \</span><br><span class="line">  --peer-key-file=/etc/etcd/ssl/etcd-key.pem \</span><br><span class="line">  --trusted-ca-file=/etc/etcd/ssl/ca.pem \</span><br><span class="line">  --peer-trusted-ca-file=/etc/etcd/ssl/ca.pem \</span><br><span class="line">  --initial-advertise-peer-urls $&#123;ETCD_INITIAL_ADVERTISE_PEER_URLS&#125; \</span><br><span class="line">  --listen-peer-urls $&#123;ETCD_LISTEN_PEER_URLS&#125; \</span><br><span class="line">  --listen-client-urls $&#123;ETCD_LISTEN_CLIENT_URLS&#125;,http://127.0.0.1:2379 \</span><br><span class="line">  --advertise-client-urls $&#123;ETCD_ADVERTISE_CLIENT_URLS&#125; \</span><br><span class="line">  --initial-cluster-token $&#123;ETCD_INITIAL_CLUSTER_TOKEN&#125; \</span><br><span class="line">  --initial-cluster etcd1=https://x.x.x.1:2380,etcd2=https://x.x.x.2:2380,etcd3=https://x.x.x.3:2380 \</span><br><span class="line">  --initial-cluster-state new \</span><br><span class="line">  --data-dir=$&#123;ETCD_DATA_DIR&#125;</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=5</span><br><span class="line">LimitNOFILE=65536</span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 上面在启动参数中指定了etcd的工作目录和数据目录分别是/var/lib/etcd和/data/etcd</span><br><span class="line"><span class="meta">#</span> –cert-file和–key-file分别指定etcd的公钥证书和私钥</span><br><span class="line"><span class="meta">#</span> –peer-cert-file和–peer-key-file分别指定了etcd的Peers通信的公钥证书和私钥。</span><br><span class="line"><span class="meta">#</span> –trusted-ca-file指定了客户端的CA证书</span><br><span class="line"><span class="meta">#</span> –peer-trusted-ca-file指定了Peers的CA证书</span><br><span class="line"><span class="meta">#</span> –initial-cluster-state new表示这是新初始化集群，–name指定的参数值必须在–initial-cluster中</span><br><span class="line"><span class="meta">#</span> 高可用etcd启动需要多节点同时启动才能起来服务</span><br><span class="line"><span class="meta">#</span> 分别在master节点同时启动etcd</span><br><span class="line">systemctl start etcd.service</span><br><span class="line">systemctl enable etcd.service</span><br></pre></td></tr></table></figure><blockquote><p>至此，etcd高可用集群搭建完成，可用一下命令验证etcd集群</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">etcdctl \</span><br><span class="line">  --ca-file=/etc/etcd/ssl/ca.pem \</span><br><span class="line">  --cert-file=/etc/etcd/ssl/etcd.pem \</span><br><span class="line">  --key-file=/etc/etcd/ssl/etcd-key.pem \</span><br><span class="line">  --endpoints=https://x.x.x.1:2379,https://x.x.x.2:2379,https://x.x.x.3:2379 \</span><br><span class="line">  cluster-health</span><br></pre></td></tr></table></figure><h3 id="2、kubeadm部署"><a href="#2、kubeadm部署" class="headerlink" title="2、kubeadm部署"></a>2、kubeadm部署</h3><h4 id="1、master部署"><a href="#1、master部署" class="headerlink" title="1、master部署"></a>1、master部署</h4><blockquote><p>部署之前请确保下载好相关image，翻墙下载或者国内dockerhub下载kubernetes镜像</p></blockquote><h5 id="1、初始化master1"><a href="#1、初始化master1" class="headerlink" title="1、初始化master1"></a>1、初始化master1</h5><blockquote><p>创建master1的初始化配置文件,网络插件采用flannel，CIDR地址是 “10.244.0.0/16”，如下为1.13.5新版本配置文件。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; kubeadm-master.yaml &lt;&lt; EOF</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta1</span><br><span class="line">kind: InitConfiguration</span><br><span class="line">localAPIEndpoint:</span><br><span class="line">  advertiseAddress: x.x.x.1  # 本机ip，这里为x.x.x.1-3</span><br><span class="line">  bindPort: 6443</span><br><span class="line">---</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta1</span><br><span class="line">kind: ClusterConfiguration</span><br><span class="line">kubernetesVersion: v1.13.5   # kubernetes版本 对应下载的image</span><br><span class="line">imageRepository: k8s.gcr.io  # 自己修改为自己的镜像库名</span><br><span class="line"></span><br><span class="line">apiServer:</span><br><span class="line">  certSANs:</span><br><span class="line">  - "master1"</span><br><span class="line">  - "master2"</span><br><span class="line">  - "master3"</span><br><span class="line">  - "x.x.x.1"</span><br><span class="line">  - "x.x.x.2"</span><br><span class="line">  - "x.x.x.3"</span><br><span class="line">  - "x.x.x.4"</span><br><span class="line">  - "127.0.0.1"</span><br><span class="line"></span><br><span class="line">controlPlaneEndpoint: "x.x.x.4:8443" # 控制台ip指定，即vip 实现apiserver高可用</span><br><span class="line">etcd:</span><br><span class="line">  external:</span><br><span class="line">     endpoints:</span><br><span class="line">     - https://x.x.x.1:2379</span><br><span class="line">     - https://x.x.x.2:2379</span><br><span class="line">     - https://x.x.x.3:2379</span><br><span class="line">networking:</span><br><span class="line">  podSubnet: "10.244.0.0/16"</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 运行初始化命令即可，前提要把相关设置关闭，详情至准备工作</span><br><span class="line"><span class="meta">#</span> 其中在kubelet配置里加入--pod-infra-container-image 参数指定 pause私有镜像库镜像</span><br><span class="line">kubeadm init --config kubeadm-master.yaml</span><br></pre></td></tr></table></figure><blockquote><p>在初始化配置里，对于etcd有两种高可用的选项，一个使用内部etcd，一个使用外部etcd(独立搭建的etcd集群，而不是在初始化中搭建的)，两者初始化配置文件略有不同。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 使用内部etcd的话，初始化yaml文件中etcd配置如下：</span><br><span class="line">etcd:</span><br><span class="line">  local:</span><br><span class="line">    extraArgs:</span><br><span class="line">      listen-client-urls: "https://127.0.0.1:2379,https://x.x.x.x:2379"</span><br><span class="line">      advertise-client-urls: "https://x.x.x.x:2379"</span><br><span class="line">      listen-peer-urls: "https://x.x.x.x:2380"</span><br><span class="line">      initial-advertise-peer-urls: "https://x.x.x.x:2380"</span><br><span class="line">      initial-cluster: "master1.hanli.com=https://x.x.x.x:2380"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 使用外部etcd的话，</span><br><span class="line">etcd:    #ETCD的地址</span><br><span class="line">   external:</span><br><span class="line">     endpoints:</span><br><span class="line">     - https://x.x.x.1:2379</span><br><span class="line">     - https://x.x.x.2:2379</span><br><span class="line">     - https://x.x.x.3:2379</span><br></pre></td></tr></table></figure><blockquote><p>init初始化之后，如果成功会出现<code>join</code>，这时就可以运行一下命令</p><p>机器上的用户要使用<code>kubectl</code>来管理集群操作集群</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure><blockquote><p>验证命令</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kubectl get cs # 如下信息</span><br><span class="line">NAME                 STATUS    MESSAGE              ERROR</span><br><span class="line">controller-manager   Healthy   ok</span><br><span class="line">scheduler            Healthy   ok</span><br><span class="line">etcd-1               Healthy   &#123;"health": "true"&#125;</span><br><span class="line">etcd-0               Healthy   &#123;"health": "true"&#125;</span><br><span class="line">etcd-2               Healthy   &#123;"health": "true"&#125;</span><br><span class="line"></span><br><span class="line">kubectl get node # notReady 状态，是因为没有安装网络插件 Name成ip，可修改kubelet的启动参数即可</span><br><span class="line">NAME         STATUS       ROLES     AGE     VERSION</span><br><span class="line">master1     NotReady      master     1m      v1.13.5</span><br></pre></td></tr></table></figure><h5 id="2、启动flannel服务"><a href="#2、启动flannel服务" class="headerlink" title="2、启动flannel服务"></a>2、启动flannel服务</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br><span class="line"><span class="meta">#</span> flannel 默认会使用主机的第一张网卡，如果你有多张网卡，需要通过配置单独指定。修改 kube-flannel.yml 中的以下部分</span><br><span class="line">cat kube-flannel.yml </span><br><span class="line"> containers:</span><br><span class="line">      - name: kube-flannel</span><br><span class="line">        image: quay.io/coreos/flannel:v0.11.0-amd64 # 修改下自己私有镜像库的flannel镜像名</span><br><span class="line">        command:</span><br><span class="line">        - /opt/bin/flanneld</span><br><span class="line">        args:</span><br><span class="line">        - --ip-masq</span><br><span class="line">        - --kube-subnet-mgr</span><br><span class="line">        - --iface=ens33              #添加</span><br></pre></td></tr></table></figure><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f kube-flannel.yml # 创建pod，因为是ds的所以后续集群里面加节点就会自动启动flannel</span><br><span class="line">kubectl get node # 会发现 node状态变成了 Ready</span><br><span class="line">NAME         STATUS       ROLES     AGE     VERSION</span><br><span class="line">master1       Ready      master     10m      v1.13.5</span><br><span class="line"></span><br><span class="line">kubectl get po --all-namespaces</span><br><span class="line">NAMESPACE     NAME                                       READY   STATUS    RESTARTS   AGE</span><br><span class="line">kube-system   coredns-86c58d9df4-r59rv                   1/1     Running   0          59m</span><br><span class="line">kube-system   coredns-86c58d9df4-rbzx5                   1/1     Running   0          59m</span><br><span class="line">kube-system   kube-apiserver-master1                     1/1     Running   0          58m</span><br><span class="line">kube-system   kube-controller-manager-master1            1/1     Running   16         58m</span><br><span class="line">kube-system   kube-flannel-ds-amd64-229j2                1/1     Running   0          42m</span><br><span class="line">kube-system   kube-proxy-4wrg5                           1/1     Running   0          59m</span><br><span class="line">kube-system   kube-scheduler-master1                     1/1     Running   13         58m</span><br></pre></td></tr></table></figure><blockquote><p>不是running状态，就说明出错了，通过查看</p><p>描述：kubectl describe pod kube-scheduler-master.hanli.com -n kube-system</p><p>日志：kubectl logs kube-scheduler-master.hanli.com -n kube-system</p><p>flannel服务启动成功后，coredns也就会自动启动成功，状态为Running</p></blockquote><h5 id="3、初始化其他master节点"><a href="#3、初始化其他master节点" class="headerlink" title="3、初始化其他master节点"></a>3、初始化其他master节点</h5><blockquote><p>首先把master1上生成的ca证书等，拷贝到其他master节点上，最好免密，可使用pscp等批量任务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> #!/bin/bash</span><br><span class="line"><span class="meta">&gt;</span> #注意修改为自己的主机名</span><br><span class="line"><span class="meta">&gt;</span> export CONTROL_PLANE_IPS="master2 master3"  </span><br><span class="line"><span class="meta">&gt;</span> </span><br><span class="line"><span class="meta">&gt;</span> # 保证节点有/etc/kubernetes/pki目录</span><br><span class="line"><span class="meta">&gt;</span> # 把以下证书复制到其他master节点</span><br><span class="line"><span class="meta">&gt;</span> for host in $&#123;CONTROL_PLANE_IPS&#125;; do</span><br><span class="line"><span class="meta">&gt;</span> # ！！！修正拷贝证书的时候请指定特定证书拷贝（之前的已经备注，新加的有etcd目录，没有用外部etcd集群），因为在证书拷贝的情况下吃过亏，因此修改此处！！！</span><br><span class="line"><span class="meta">&gt;</span> # 附issue：https://github.com/kubernetes/kubeadm/issues/1321 </span><br><span class="line"><span class="meta">&gt;</span> # 找了好久终于！！！哭</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/pki/*.crt $host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/pki/*.key $host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/pki/*.pub $host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> #scp /etc/kubernetes/admin.conf $host:/etc/kubernetes/admin.conf</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/ca.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/sa.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/front-proxy-ca.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/pki/etcd/ca.* "$&#123;USER&#125;"@$host:/etc/kubernetes/pki/etcd/</span><br><span class="line"><span class="meta">&gt;</span> scp /etc/kubernetes/admin.conf "$&#123;USER&#125;"@$host:/etc/kubernetes/</span><br><span class="line"><span class="meta">&gt;</span> done</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> tree /etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> /etc/kubernetes/pki/</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-etcd-client.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-etcd-client.key</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver.key</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-kubelet-client.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── apiserver-kubelet-client.key</span><br><span class="line"><span class="meta">&gt;</span> ├── ca.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── ca.key</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-ca.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-ca.key</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-client.crt</span><br><span class="line"><span class="meta">&gt;</span> ├── front-proxy-client.key</span><br><span class="line"><span class="meta">&gt;</span> ├── sa.key</span><br><span class="line"><span class="meta">&gt;</span> └── sa.pub</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>In v1.8.0, kubeadm introduced the <code>kubeadm alpha phase</code> command with the aim of making kubeadm more modular. In v1.13.0 this command graduated to <code>kubeadm init phase</code>. This modularity enables you to invoke atomic sub-steps of the bootstrap process. Hence, you can let kubeadm do some parts and fill in yourself where you need customizations.</p><p><code>kubeadm init phase</code> is consistent with the <a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/#init-workflow" target="_blank" rel="noopener">kubeadm init workflow</a>, and behind the scene both use the same code.</p><p>在v1.8.0中，kubeadm引入了该<code>kubeadm alpha phase</code>命令，目的是使kubeadm更加模块化。在v1.13.0中，此命令逐渐变为<code>kubeadm init phase</code>。此模块化使您可以调用引导过程的原子子步骤。因此，您可以让kubeadm执行某些操作，并在需要自定义的位置填写您自己的位置。</p><p><code>kubeadm init phase</code>与<a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/#init-workflow" target="_blank" rel="noopener">kubeadm init工作流程</a>一致，并且在场景后面都使用相同的代码。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl init --config kube-master.yaml</span><br><span class="line"><span class="meta">#</span> 分别修改对应ip，在在master2-3并执行即可 步骤如master1</span><br><span class="line"><span class="meta">#</span> 等待kube-proxy flannel启动成功即可</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">kubectl get po -n kube-system</span><br><span class="line">NAME                                  READY     STATUS    RESTARTS   AGE</span><br><span class="line">coredns-9f9d9c76-4zrt4                  1/1     Running   0          2d</span><br><span class="line">coredns-9f9d9c76-dqd4c                  1/1     Running   0          2d</span><br><span class="line">kube-apiserver-zjjh-rq-k8s-1            1/1     Running   0          2d</span><br><span class="line">kube-apiserver-zjjh-rq-k8s-2            1/1     Running   0          2d</span><br><span class="line">kube-apiserver-zjjh-rq-k8s-3            1/1     Running   0          2d</span><br><span class="line">kube-controller-manager-zjjh-rq-k8s-1   1/1     Running   0          2d</span><br><span class="line">kube-controller-manager-zjjh-rq-k8s-2   1/1     Running   0          2d</span><br><span class="line">kube-controller-manager-zjjh-rq-k8s-3   1/1     Running   0          2d</span><br><span class="line">kube-flannel-ds-amd64-7ghn7             1/1     Running   1          2d</span><br><span class="line">kube-flannel-ds-amd64-9cqts             1/1     Running   0          2d</span><br><span class="line">kube-flannel-ds-amd64-f57nh             1/1     Running   1          2d</span><br><span class="line">kube-proxy-8fwts                        1/1     Running   0          2d</span><br><span class="line">kube-proxy-95tjb                        1/1     Running   0          2d</span><br><span class="line">kube-proxy-bls94                        1/1     Running   0          2d</span><br><span class="line">kube-scheduler-zjjh-rq-k8s-1            1/1     Running   0          2d</span><br><span class="line">kube-scheduler-zjjh-rq-k8s-2            1/1     Running   0          2d</span><br><span class="line">kube-scheduler-zjjh-rq-k8s-3            1/1     Running   0          2d</span><br><span class="line">kubernetes-dashboard-67d49f7868-x79wf   1/1     Running   0          76m</span><br></pre></td></tr></table></figure><h4 id="2、Work节点加入集群"><a href="#2、Work节点加入集群" class="headerlink" title="2、Work节点加入集群"></a>2、Work节点加入集群</h4><blockquote><p>输入master节点初始化成功之后出现的<code>join</code>命令，出现<code>kubectl get nodes</code>即成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> kubeadm join x.x.x.4:8443 --token bnnsb7.amapp1t78llxn54d --discovery-token-ca-cert-hash sha256:520ef89be84c30e480db6d441a7e4179634a9455f0009e249ebe8f35fa792087</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><h4 id="3、集群验证"><a href="#3、集群验证" class="headerlink" title="3、集群验证"></a>3、集群验证</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 节点状态</span><br><span class="line">[root@master] ~$ kubectl get nodes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 组件状态</span><br><span class="line">[root@master] ~$  kubectl get cs</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 服务账户</span><br><span class="line">[root@master] ~$ kubectl get serviceaccount</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 集群信息</span><br><span class="line">[root@master] ~$ kubectl cluster-info</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 验证dns功能</span><br><span class="line">[root@master] ~$ kubectl run curl --image=radial/busyboxplus:curl -it</span><br><span class="line">[ root@curl-66959f6557-r4crd:/ ]$ nslookup kubernetes.default</span><br><span class="line">Server:    10.96.0.10</span><br><span class="line">Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local</span><br><span class="line"></span><br><span class="line">Name:      kubernetes.default</span><br><span class="line">Address 1: 10.96.0.1 kubernetes.default.svc.cluster.local</span><br></pre></td></tr></table></figure><blockquote><p>附录：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span># kubelet.service配置文件 /use/lib/systemd/system/kubelet.service.d/10-kubeadm.conf</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><hr><p>参考链接：</p><p>kubeadm安装1.13.5：<a href="https://blog.csdn.net/fanren224/article/details/86573264#2master1_165" target="_blank" rel="noopener">https://blog.csdn.net/fanren224/article/details/86573264#2master1_165</a></p><p>二进制安装：<a href="https://github.com/mritd/ktool" target="_blank" rel="noopener">https://github.com/mritd/ktool</a></p><p>二进制安装kubernetes_v1.13.4：<a href="https://mritd.me/2019/03/16/set-up-kubernetes-1.13.4-cluster/" target="_blank" rel="noopener">https://mritd.me/2019/03/16/set-up-kubernetes-1.13.4-cluster/</a></p>]]></content>
      
      
      <categories>
          
          <category> Kubernetes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kubernetes </tag>
            
            <tag> Kubernetes_ha </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一点Haproxy参数的文档</title>
      <link href="/sheldon_blog/passages/%E8%AE%B0%E4%B8%80%E7%82%B9Haproxy%E5%8F%82%E6%95%B0%E7%9A%84%E6%96%87%E6%A1%A3/"/>
      <url>/sheldon_blog/passages/%E8%AE%B0%E4%B8%80%E7%82%B9Haproxy%E5%8F%82%E6%95%B0%E7%9A%84%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<p>Haproxy的一些配置参数，/etc/haproxy/haproxy.cfg</p><blockquote><p>主要是配置项的超时参数，如下：<a id="more"></a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> # 反映连接haproxy集群报错，查看应用服务器进程大量的端口连接处于colse_wait状态。</span><br><span class="line"><span class="meta">&gt;</span> # 这个haproxy的redis集群类似配置已经好几组了，配置都相同问啥别的都好好的这个却有问题。</span><br><span class="line"><span class="meta">&gt;</span> # 自己尝试使用redis-cli连接（haproxy做的redis分片集群），确实能够正常连接操作，但是连接状态马上就会变成close_wait状态，重新执行命令这个close_wait状态会恢复ESTABLISHED，但是细心看端口号已经变化，也就是redis-cli发生了重新连接。于是问题清晰了：用户客户端工具建立链接后，没有自动重连来保持连接，导致超时，服务器主动断开连接，客户端再次链接的时候socket已经损坏不可用了，导致报错</span><br><span class="line"><span class="meta">&gt;</span> # 解决办法：调整haproxy的超时参数：</span><br><span class="line"><span class="meta">&gt;</span> timeout connect 5s</span><br><span class="line"><span class="meta">&gt;</span> timeout queue   5s</span><br><span class="line"><span class="meta">&gt;</span> timeout client 30s</span><br><span class="line"><span class="meta">&gt;</span> timeout server 30s</span><br><span class="line"><span class="meta">&gt;</span> timeout client-fin 30s</span><br><span class="line"><span class="meta">&gt;</span> timeout server-fin 30s</span><br><span class="line"><span class="meta">&gt;</span> timeout tunnel  1h</span><br><span class="line"><span class="meta">&gt;</span> # 参数解释：</span><br><span class="line"><span class="meta">&gt;</span> timeout connect      连接尝试成功连接到server的超时时间</span><br><span class="line"><span class="meta">&gt;</span> timeout queue        在队列等待连接槽释放的超时时间</span><br><span class="line"><span class="meta">&gt;</span> timeout server       server端非活动状态超时时间</span><br><span class="line"><span class="meta">&gt;</span> timeout client       客户端非活动状态超时时间</span><br><span class="line"><span class="meta">&gt;</span> timeout server-fin   半关闭状态连接，server端非活动超时时间</span><br><span class="line"><span class="meta">&gt;</span> timeout client-fin   半关闭状态连接，client端非活动超时时间</span><br><span class="line"><span class="meta">&gt;</span> timeout tunnel       客户端和服务器端通道非活动超时时间</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Haproxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python_list去重</title>
      <link href="/sheldon_blog/passages/Python-list%E5%8E%BB%E9%87%8D/"/>
      <url>/sheldon_blog/passages/Python-list%E5%8E%BB%E9%87%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="Python-list去重集中记录一下方法"><a href="#Python-list去重集中记录一下方法" class="headerlink" title="Python_list去重集中记录一下方法"></a>Python_list去重集中记录一下方法</h2><h3 id="怎么快速的对列表进行去重呢，去重之后原来的顺序会不会改变呢？"><a href="#怎么快速的对列表进行去重呢，去重之后原来的顺序会不会改变呢？" class="headerlink" title="怎么快速的对列表进行去重呢，去重之后原来的顺序会不会改变呢？"></a>怎么快速的对列表进行去重呢，去重之后原来的顺序会不会改变呢？</h3><h4 id="1-以下的几种情况结果是一样的，去重之后顺序会改变"><a href="#1-以下的几种情况结果是一样的，去重之后顺序会改变" class="headerlink" title="1.以下的几种情况结果是一样的，去重之后顺序会改变:"></a>1.以下的几种情况结果是一样的，去重之后顺序会改变:<a id="more"></a></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最常用</span></span><br><span class="line">ids = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">news_ids = []</span><br><span class="line"><span class="keyword">for</span> id <span class="keyword">in</span> ids:</span><br><span class="line">    <span class="keyword">if</span> id <span class="keyword">not</span> <span class="keyword">in</span> news_ids:</span><br><span class="line">        news_ids.append(id)</span><br><span class="line"><span class="keyword">print</span> news_ids</span><br></pre></td></tr></table></figure><h4 id="或用set"><a href="#或用set" class="headerlink" title="或用set"></a>或用set</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用set如果列表里面有字典活着其他数据结构，貌似不会去重。</span></span><br><span class="line">ids = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">ids = list(set(ids))</span><br></pre></td></tr></table></figure><h4 id="或使用itertools-grouby"><a href="#或使用itertools-grouby" class="headerlink" title="或使用itertools.grouby"></a>或使用itertools.grouby</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">ids = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">ids.sort()</span><br><span class="line">it = itertools.groupby(ids)</span><br><span class="line"><span class="keyword">for</span> k, g <span class="keyword">in</span> it:</span><br><span class="line">    <span class="keyword">print</span> k</span><br></pre></td></tr></table></figure><blockquote><p>关于itertools.groupby的原理可以看这里：</p><p>(1) <a href="http://docs.python.org/2/library/itertools.html#itertools.groupby" target="_blank" rel="noopener">http://docs.python.org/2/library/itertools.html#itertools.groupby</a></p><p>(2)<a href="https://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001415616001996f6b32d80b6454caca3d33c965a07611f000" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001415616001996f6b32d80b6454caca3d33c965a07611f000</a></p></blockquote><h4 id="2-怎么能不改变原来的顺序呢？-要用到reduce-关于reduce的介绍-http-docs-python-org-2-library-functions-html-reduce"><a href="#2-怎么能不改变原来的顺序呢？-要用到reduce-关于reduce的介绍-http-docs-python-org-2-library-functions-html-reduce" class="headerlink" title="2.怎么能不改变原来的顺序呢？(要用到reduce 关于reduce的介绍　 http://docs.python.org/2/library/functions.html#reduce)"></a>2.怎么能不改变原来的顺序呢？(要用到reduce 关于reduce的介绍　 <a href="http://docs.python.org/2/library/functions.html#reduce" target="_blank" rel="noopener">http://docs.python.org/2/library/functions.html#reduce</a>)</h4><blockquote><p>关于lambda的文章:<a href="http://www.cnblogs.com/nyist-xsk/p/7404675.html" target="_blank" rel="noopener">http://www.cnblogs.com/nyist-xsk/p/7404675.html</a></p><p>关于reduce的文章: </p><p>(1) <a href="http://www.cnblogs.com/XXCXY/p/5180245.html" target="_blank" rel="noopener">http://www.cnblogs.com/XXCXY/p/5180245.html</a></p><p>(2) <a href="http://www.pythoner.com/46.html" target="_blank" rel="noopener">http://www.pythoner.com/46.html</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">5</span>]: ids = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">In [<span class="number">6</span>]: func = <span class="keyword">lambda</span> x,y:x <span class="keyword">if</span> y <span class="keyword">in</span> x <span class="keyword">else</span> x + [y]</span><br><span class="line">In [<span class="number">7</span>]: reduce(func, [[], ] + ids)</span><br><span class="line">Out[<span class="number">7</span>]: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure><blockquote><p>其中的 lambda x,y:x if y in x else x + [y] 等价于 lambda x,y: y in x and x or x+[y] 。<br>思路其实就是先把ids变为[[], 1,4,3,……] ,然后在利用reduce的特性.</p></blockquote><h4 id="去列表去重，不改变原来的顺序，还可以使用一个空列表把原列表里面不重复的数据”装起来”，例如："><a href="#去列表去重，不改变原来的顺序，还可以使用一个空列表把原列表里面不重复的数据”装起来”，例如：" class="headerlink" title="去列表去重，不改变原来的顺序，还可以使用一个空列表把原列表里面不重复的数据”装起来”，例如："></a>去列表去重，不改变原来的顺序，还可以使用一个空列表把原列表里面不重复的数据”装起来”，例如：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">list2 = []</span><br><span class="line">list1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> list2:</span><br><span class="line">        list2.append(i)</span><br><span class="line">list2</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>]</span><br><span class="line">或者使用删除元素索引的方法对列表去重，并且不改变原列表的顺序</span><br><span class="line"><span class="comment"># python for删除的时候会往前移(垃圾回收机制)，未遍历到的后一个占了前一个被删除的"位置"，导致这个数不会被遍历到，而使最后的结果错误</span></span><br><span class="line"><span class="comment"># 局部变量在栈内存中存在,当for循环语句结束,那么变量会及时被gc(垃圾回收器)及时的释放掉,不浪费空间；</span></span><br><span class="line"><span class="comment"># 如果使用循环之后还想去访问循环语句中控制那个变量,使用while循环。</span></span><br><span class="line"><span class="comment"># 所以使用while循环删除nums中的Val(的下标)</span></span><br><span class="line">nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line">val = <span class="number">3</span></span><br><span class="line"><span class="keyword">while</span> val <span class="keyword">in</span> nums:</span><br><span class="line">      nums.pop(nums.index(val))</span><br><span class="line"><span class="keyword">print</span> nums</span><br><span class="line"><span class="keyword">return</span> len(nums)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Python_碎片化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang_问题</title>
      <link href="/sheldon_blog/passages/Golang-%E9%97%AE%E9%A2%98/"/>
      <url>/sheldon_blog/passages/Golang-%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>（持续更新）</p><h2 id="一、gorm遇到invalid-connection报错"><a href="#一、gorm遇到invalid-connection报错" class="headerlink" title="一、gorm遇到invalid connection报错"></a>一、gorm遇到invalid connection报错</h2><blockquote><p>(/data/dcops_workspace/src/x.x.x.x/xxxx/model/containerappid_info.go:76)<br>[2019-04-09 14:41:40]  invalid connection<a id="more"></a></p><p>现象：今天使用gorm时，总遇到invalid connection报错，导致<strong>过一段时间</strong>调一下接口服务容器就会重启</p><p>网上查了文档看了gorm的mysql连接池的参数：</p><p>dcosdb.DB().SetMaxIdleConns(10)  // SetMaxIdleConns设置idle connection pool的最大连接数。如果MaxOpenConns的值 &gt; 0，但是小于这里设置的MaxIdleConns，则MaxIdleConns将自动降到与MaxOpenConns的限制相同。如果 &lt;= 0, 则没有空闲连接会被保留。<strong><em>最大空闲连接数</em></strong></p><p>dcosdb.DB().SetMaxOpenConns(100)  //SetMaxOpenConns用于设置Database最大可以打开的连接数。如果 &lt;= 0, 则没有连接限制。且默认值为0（无限制）。<strong><em>数据库最大连接数</em></strong></p><p>dcosdb.DB().SetConnMaxLifetime(time.Second <em> 5)  // SetConnMaxLifetime用于设置连接可被重新使用的最大时间间隔。如果超时，则连接会在重新使用前被关闭。如果 d &lt;= 0, 则连接将被永久保留。**</em>连接最长存活期，超过这个时间连接将不再被复用***</p><p>原因是：程序在重复使用数据库tcp连接池中的某个连接时，该命中连接可能已被服务器过期丢弃，而客户端这边认为该连接为过期，还有效。此时会报错 invalid connection。随后将该连接重连接池中丢弃</p><p>原因参考：<a href="https://blog.csdn.net/dghpgyss/article/details/86480837" target="_blank" rel="noopener">https://blog.csdn.net/dghpgyss/article/details/86480837</a></p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发现我把dcosdb.DB().SetConnMaxLifetime(time.Second * 5)这个参数设置成了dcosdb.DB().SetConnMaxLifetime(time.Hour)导致了每次连接丢弃，但是客户端不知道。服务端主动关闭了连接，因为服务端对连接的保持超时时间到了也关闭的，所以可以设置客户端连接超时时间小于服务端DB.SetConnMaxLifetime(time.Second)</span></span><br><span class="line"><span class="comment">// SetConnMaxLifetime sets the maximum amount of time a connection may be reused.</span></span><br><span class="line">dcosdb.DB().SetConnMaxLifetime(time.Second * <span class="number">5</span>)</span><br><span class="line"><span class="comment">// dcosdb.DB().SetConnMaxLifetime(time.Hour) 设置成了1小时</span></span><br></pre></td></tr></table></figure><h2 id="二、"><a href="#二、" class="headerlink" title="二、"></a>二、</h2>]]></content>
      
      
      
        <tags>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang并发之原子操作</title>
      <link href="/sheldon_blog/passages/Golang%E5%B9%B6%E5%8F%91%E4%B9%8B%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/"/>
      <url>/sheldon_blog/passages/Golang%E5%B9%B6%E5%8F%91%E4%B9%8B%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p><strong><em>转自：<a href="http://ifeve.com/go-concurrency-atomic/" target="_blank" rel="noopener">http://ifeve.com/go-concurrency-atomic/</a></em></strong></p><blockquote><p>原理多，代码量偏少。</p></blockquote><p>我们已经知道，原子操作即是进行过程中不能被中断的操作。也就是说，针对某个值的原子操作在被进行的过程当中，CPU绝不会再去进行其它的针对该值的操作。无论这些其它的操作是否为原子操作都会是这样。为了实现这样的严谨性，原子操作仅会由一个独立的CPU指令代表和完成。只有这样才能够在并发环境下保证原子操作的绝对安全。<br>Go语言提供的原子操作都是非侵入式的。它们由标准库代码包sync/atomic中的众多函数代表。我们可以通过调用这些函数对几种简单的类型的值进行原子操作。这些类型包括int32、int64、uint32、uint64、uintptr和unsafe.Pointer类型，共6个。这些函数提供的原子操作共有5种，即：增或减、比较并交换、载入、存储和交换。它们分别提供了不同的功能，且适用的场景也有所区别。下面，我们就根据这些种类对Go语言提供的原子操作进行逐一的讲解。<a id="more"></a></p><p> \1. 增或减<br>被用于进行增或减的原子操作（以下简称原子增/减操作）的函数名称都以“Add”为前缀，并后跟针对的具体类型的名称。例如，实现针对uint32类型的原子增/减操作的函数的名称为AddUint32。事实上，sync/atomic包中的所有函数的命名都遵循此规则。<br>顾名思义，原子增/减操作即可实现对被操作值的增大或减小。因此，被操作值的类型只能是数值类型。更具体的讲，它只能是我们在前面提到的int32、int64、uint32、uint64和uintptr类型。例如，我们如果想原子的把一个int32类型的变量i32的值增大3的话，可以这样做：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newi32 := atomic.AddInt32(&amp;i32, <span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>我们将指向i32变量的值的指针值和代表增减的差值3作为参数传递给了atomic.AddInt32函数。之所以要求第一个参数值必须是一个指针类型的值，是因为该函数需要获得到被操作值在内存中的存放位置，以便施加特殊的CPU指令。从另一个角度看，对于一个不能被取址的数值，我们是无法进行原子操作的。此外，这类函数的第二个参数的类型被操作值的类型总是相同的。因此，在前面那个调用表达式被求值的时候，字面量3会被自动转换为一个int32类型的值。函数atomic.AddInt32在被执行结束之时会返回经过原子操作后的新值。不过不要误会，我们无需把这个新值再赋给原先的变量i32。因为它的值已经在atomic.AddInt32函数返回之前被原子的修改了。<br>与该函数类似的还有atomic.AddInt64函数、atomic.AddUint32函数、atomic.AddUint64函数和atomic.AddUintptr函数。这些函数也可以被用来原子的增/减对应类型的值。例如，如果我们要原子的将int64类型的变量i64的值减小3话，可以这样编写代码：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i64 <span class="keyword">int64</span></span><br><span class="line">atomic.AddInt64(&amp;i64, <span class="number">-3</span>)</span><br></pre></td></tr></table></figure><p>不过，由于atomic.AddUint32函数和atomic.AddUint64函数的第二个参数的类型分别是uint32和uint64，所以我们无法通过传递一个负的数值来减小被操作值。那么，这是不是就意味着我们无法原子的减小uint32或uint64类型的值了呢？幸好，不是这样。Go语言为我们提供了一个可以迂回的达到此目的办法。<br>如果我们想原子的把uint32类型的变量ui32的值增加NN（NN代表了一个负整数），那么我们可以这样调用atomic.AddUint32函数：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">atomic.AddUint32(&amp;ui32, ^<span class="keyword">uint32</span>(-NN<span class="number">-1</span>))</span><br></pre></td></tr></table></figure><p>对于uint64类型的值来说也是这样。调用表达式</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">atomic.AddUint64(&amp;ui64, ^<span class="keyword">uint64</span>(-NN<span class="number">-1</span>))</span><br></pre></td></tr></table></figure><p>表示原子的把uint64类型的变量ui64的值增加NN（或者说减小-NN）。<br>之所以这种方式可以奏效，是因为它利用了二进制补码的特性。我们知道，一个负整数的补码可以通过对它按位（除了符号位之外）求反码并加一得到。我们还知道，一个负整数可以由对它的绝对值减一并求补码后得到的数值的二进制表示来代表。例如，如果NN是一个int类型的变量且其值为-35，那么表达式</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uint32</span>(<span class="keyword">int32</span>(NN))</span><br></pre></td></tr></table></figure><p>和</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^<span class="keyword">uint32</span>(-NN<span class="number">-1</span>)</span><br></pre></td></tr></table></figure><p>的结果值就都会是11111111111111111111111111011101。由此，我们使用^uint32(-NN-1)和^uint64(-NN-1)来分别表示uint32类型和uint64类型的NN就顺理成章了。这样，我们就可以合理的绕过uint32类型和uint64类型对值的限制了。<br>以上是官方提供一种通用解决方案。除此之外，我们还有两个非通用的方案可供选择。首先，需要明确的是，对于一个代表负数的字面常量来说，它们是无法通过简单的类型转换将其转换为uint32类型或uint64类型的值的。例如，表达式uint32(-35)和uint64(-35)都是不合法的。它们都不能通过编译。但是，如果我们事先把这个字面量赋给一个变量然后再对这个变量进行类型转换，那么就可以得到Go语言编译器的认可。我们依然以值为-35的变量NN为例，下面这条语句可以通过编译并被正常执行：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Printf(<span class="string">"The variable: %b.\n"</span>, <span class="keyword">uint32</span>(NN))</span><br></pre></td></tr></table></figure><p>其输出内容为：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The variable: <span class="number">11111111111111111111111111011101.</span></span><br></pre></td></tr></table></figure><p>可以看到，表达式uint32(NN)的结果值的二进制表示与前面的uint32(int32(NN))表达式以及^uint32(-NN-1)表达式的结果值是一致的。它们都可以被用来表示uint32类型的-35。因此，我们也可以使用下面的调用表达式来原子的把变量ui32的值减小-NN：<br>atomic.AddUint32(&amp;ui32, uint32(NN))<br>不过，这样的编写方式仅在NN是数值类型的变量的时候才可以通过编译。如果NN是一个常量，那么也会使表达式uint32(NN)不合法并无法通过编译。它与表达式uint32(-35)造成的编译错误是一致的。在这种情况下，我们可以这样来达到上述目的：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">atomic.AddUint32(&amp;ui32, NN&amp;math.MaxUint32)</span><br></pre></td></tr></table></figure><p>其中，我们用到了标准库代码包math中的常量MaxUint32。math.MaxUint32常量表示的是一个32位的、所有二进制位上均为1的数值。我们把NN和math.MaxUint32进行按位与操作的意义是使前者的值能够被视为一个uint32类型的数值。实际上，对于表达式NN&amp;math.MaxUint32来说，其结果值的二进制表示与前面uint32(int32(NN))表达式以及^uint32(-NN-1)表达式的结果值也是一致的。<br>我们在这里介绍的这两种非官方的解决方案是不能混用的。更具体地说，如果NN是一个常量，那么表达式uint32(NN)是无法通过编译的。而如果NN是一个变量，那么表达式NN&amp;math.MaxUint32就无法通过编译。前者的错误在于代表负整数的字面常量不能被转换为uint32类型的值。后者的错误在于这个按位与运算的结果值的类型不是uint32类型而是int类型，从而导致数据溢出的错误。相比之下，官方给出的那个解决方案的适用范围更广。<br>有些读者可能会有这样的疑问：为什么如此曲折的实现这一功能？直接声明出atomic.SubUint32()函数和atomic.SubUint64()函数不好吗？作者理解，不这样做是为了让这些原子操作的API可以整齐划一，并且避免在扩充它们的时候使sync/atomic包中声明的程序实体成倍增加。（作者向Go语言官方提出了这个问题并引发了一些讨论，他们也许会使用投票的方式来选取更好一些的方案）<br>注意，并不存在名为atomic.AddPointer的函数，因为unsafe.Pointer类型值之间既不能被相加也不能被相减。<br>\2. 比较并交换<br>有些读者可能很熟悉比较并交换操作的英文称谓——Compare And Swap，简称CAS。在sync/atomic包中，这类原子操作由名称以“CompareAndSwap”为前缀的若干个函数代表。<br>我们依然以针对int32类型值的函数为例。该函数名为CompareAndSwapInt32。其声明如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CompareAndSwapInt32</span><span class="params">(addr *<span class="keyword">int32</span>, old, <span class="built_in">new</span> <span class="keyword">int32</span>)</span> <span class="params">(swapped <span class="keyword">bool</span>)</span></span></span><br></pre></td></tr></table></figure><p>可以看到，CompareAndSwapInt32函数接受三个参数。第一个参数的值应该是指向被操作值的指针值。该值的类型即为*int32。后两个参数的类型都是int32类型。它们的值应该分别代表被操作值的旧值和新值。CompareAndSwapInt32函数在被调用之后会先判断参数addr指向的被操作值与参数old的值是否相等。仅当此判断得到肯定的结果之后，该函数才会用参数new代表的新值替换掉原先的旧值。否则，后面的替换操作就会被忽略。这正是“比较并交换”这个短语的由来。CompareAndSwapInt32函数的结果swapped被用来表示是否进行了值的替换操作。<br>与我们前面讲到的锁相比，CAS操作有明显的不同。它总是假设被操作值未曾被改变（即与旧值相等），并一旦确认这个假设的真实性就立即进行值替换。而使用锁则是更加谨慎的做法。我们总是先假设会有并发的操作要修改被操作值，并使用锁将相关操作放入临界区中加以保护。我们可以说，使用锁的做法趋于悲观，而CAS操作的做法则更加乐观。<br>CAS操作的优势是，可以在不形成临界区和创建互斥量的情况下完成并发安全的值替换操作。这可以大大的减少同步对程序性能的损耗。当然，CAS操作也有劣势。在被操作值被频繁变更的情况下，CAS操作并不那么容易成功。有些时候，我们可能不得不利用for循环以进行多次尝试。示例如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value <span class="keyword">int32</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addValue</span><span class="params">(delta <span class="keyword">int32</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">v := value</span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;value, v, (v + delta)) &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到，为了保证CAS操作的成功完成，我们仅在CompareAndSwapInt32函数的结果值为true时才会退出循环。这种做法与自旋锁的自旋行为相似。addValue函数会不断的尝试原子的更新value的值，直到这一操作成功为止。操作失败的缘由总会是value的旧值已不与v的值相等了。如果value的值会被并发的修改的话，那么发生这种情况是很正常的。<br>CAS操作虽然不会让某个Goroutine阻塞在某条语句上，但是仍可能会使流程的执行暂时停滞。不过，这种停滞的时间大都极其短暂。<br>请记住，当想并发安全的更新一些类型（更具体的讲是，前文所述的那6个类型）的值的时候，我们总是应该优先选择CAS操作。<br>与此对应，被用来进行原子的CAS操作的函数共有6个。除了我们已经讲过的CompareAndSwapInt32函数之外，还有CompareAndSwapInt64、CompareAndSwapPointer、CompareAndSwapUint32、CompareAndSwapUint64 和CompareAndSwapUintptr函数。这些函数的结果声明列表与CompareAndSwapInt32函数的完全一致。而它们的参数声明列表与后者也非常类似。虽然其中的那三个参数的类型不同，但其遵循的规则是一致的，即：第二个和第三个参数的类型均为与第一个参数的类型（即某个指针类型）紧密相关的那个类型。例如，如果第一个参数的类型为*unsafe.Pointer，那么后两个参数的类型就一定是unsafe.Pointer。这也是由这三个参数的含义决定的。<br>\3. 载入<br>在前面示例的for循环中，我们使用语句v := value为变量v赋值。但是，要注意，其中的读取value的值的操作并不是并发安全的。在该读取操作被进行的过程中，其它的对此值的读写操作是可以被同时进行的。它们并不会受到任何限制。<br>在第7章的第1节的最后，我们举过这样一个例子：在32位计算架构的计算机上写入一个64位的整数。如果在这个写操作未完成的时候有一个读操作被并发的进行了，那么这个读操作很可能会读取到一个只被修改了一半的数据。这种结果是相当糟糕的。<br>为了原子的读取某个值，sync/atomic代码包同样为我们提供了一系列的函数。这些函数的名称都以“Load”为前缀，意为载入。我们依然以针对int32类型值的那个函数为例。<br>我们下面利用LoadInt32函数对上一个示例稍作修改：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addValue</span><span class="params">(delta <span class="keyword">int32</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">v := atomic.LoadInt32(&amp;value)</span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;value, v, (v + delta)) &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>函数atomic.LoadInt32接受一个<em>int32类型的指针值，并会返回该指针值指向的那个值。在该示例中，我们使用调用表达式atomic.LoadInt32(&amp;value)替换掉了标识符value。替换后，那条赋值语句的含义就变为：原子的读取变量value的值并把它赋给变量v。有了“原子的”这个形容词就意味着，在这里读取value的值的同时，当前计算机中的任何CPU都不会进行其它的针对此值的读或写操作。这样的约束是受到底层硬件的支持的。<br>注意，虽然我们在这里使用atomic.LoadInt32函数原子的载入value的值，但是其后面的CAS操作仍然是有必要的。因为，那条赋值语句和if语句并不会被原子的执行。在它们被执行期间，CPU仍然可能进行其它的针对value的值的读或写操作。也就是说，value的值仍然有可能被并发的改变。<br>与atomic.LoadInt32函数的功能类似的函数有atomic.LoadInt64、atomic.LoadPointer、atomic.LoadUint32、atomic.LoadUint64和atomic.LoadUintptr。<br>\4. 存储<br>与读取操作相对应的是写入操作。而sync/atomic包也提供了与原子的值载入函数相对应的原子的值存储函数。这些函数的名称均以“Store”为前缀。<br>在原子的存储某个值的过程中，任何CPU都不会进行针对同一个值的读或写操作。如果我们把所有针对此值的写操作都改为原子操作，那么就不会出现针对此值的读操作因被并发的进行而读到修改了一半的值的情况了。<br>原子的值存储操作总会成功，因为它并不会关心被操作值的旧值是什么。显然，这与前面讲到的CAS操作是有着明显的区别的。因此，我们并不能把前面展示的addValue函数中的调用atomic.CompareAndSwapInt32函数的表达式替换为对atomic.StoreInt32函数的调用表达式。<br>函数atomic.StoreInt32会接受两个参数。第一个参数的类型是</em>int 32类型的，其含义同样是指向被操作值的指针。而第二个参数则是int32类型的，它的值应该代表欲存储的新值。其它的同类函数也会有类似的参数声明列表。<br>\5. 交换<br>在sync/atomic代码包中还存在着一类函数。它们的功能与前文所讲的CAS操作和原子载入操作都有些类似。这样的功能可以被称为原子交换操作。这类函数的名称都以“Swap”为前缀。<br>与CAS操作不同，原子交换操作不会关心被操作值的旧值。它会直接设置新值。但它又比原子载入操作多做了一步。作为交换，它会返回被操作值的旧值。此类操作比CAS操作的约束更少，同时又比原子载入操作的功能更强。<br>以atomic.SwapInt32函数为例。它接受两个参数。第一个参数是代表了被操作值的内存地址的<em>int32类型值，而第二个参数则被用来表示新值。注意，该函数是有结果值的。该值即是被新值替换掉的旧值。atomic.SwapInt32函数被调用后，会把第二个参数值置于第一个参数值所表示的内存地址上（即修改被操作值），并将之前在该地址上的那个值作为结果返回。其它的同类函数的声明和作用都与此类似。<br>至此，我们快速且简要地介绍了sync/atomic代码包中的所有函数的功能和用法。这些函数都被用来对特定类型的值进行原子性的操作。如果我们想以并发安全的方式操作单一的特定类型（int32、int64、uint32、uint64、uintptr或unsafe.Pointer）的值的话，应该首先考虑使用这些函数来实现。请注意，原子的减小一些特定类型（确切地说，是uint32类型和uint64类型）的值的实现方式并不那么直观。在Go语言官方对此进行改进之前，我们应该按照他们为我们提供的那种方式来进行此类操作。<br>\6. 应用于实际<br>下面，我们就使用刚刚介绍的知识再次对在前面示例中创建的</em>myDataFile类型进行改造。在<em>myDataFile类型的第二个版本中，我们仍然使用两个互斥锁来对与roffset字段和woffset字段相关的操作进行保护。</em>myDataFile类型的方法中的绝大多数都包含了这些操作。<br>首先，我们来看对roffset字段的操作。在*myDataFile类型的Read方法中有这样一段代码：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取并更新读偏移量</span></span><br><span class="line"><span class="keyword">var</span> offset <span class="keyword">int64</span></span><br><span class="line">df.rmutex.Lock()</span><br><span class="line">offset = df.roffset</span><br><span class="line">df.roffset += <span class="keyword">int64</span>(df.dataLen)</span><br><span class="line">df.rmutex.Unlock()</span><br></pre></td></tr></table></figure><p>这段代码的含义是读取读偏移量的值并把它存入到局部变量中，然后增加读偏移量的值以使其它的并发的读操作能够被正确、有效的进行。为了使程序能够在并发环境下有序的对roffset字段进行操作，我们为这段代码应用了互斥锁rmutex。<br>字段roffset和变量offset都是int64类型的。后者代表了前者的旧值。而字段roffset的新值即为其旧值与dataLen字段的值的和。实际上，这正是原子的CAS操作的适用场景。我们现在用CAS操作来实现该段代码的功能：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取并更新读偏移量</span></span><br><span class="line"><span class="keyword">var</span> offset <span class="keyword">int64</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">offset = df.roffset</span><br><span class="line"><span class="keyword">if</span> atomic.CompareAndSwapInt64(&amp;df.roffset, offset,</span><br><span class="line">(offset + <span class="keyword">int64</span>(df.dataLen))) &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据roffset和offset的类型，我们选用atomic.CompareAndSwapInt64来进行CAS操作。我们在调用该函数的时候传入了三个参数，分别代表了被操作值的地址、旧值和新值。如果该函数的结果值是true，那么我们就退出for循环。这时，变量offset即是我们需要的读偏移量的值。另一方面，如果该函数的结果值是false，那么就说明在从完成读取到开始更新roffset字段的值的期间内有其它的并发操作对该值进行了更改。当遇到这种情况，我们就需要再次尝试。只要尝试失败，我们就会重新读取roffset字段的值并试图对该值进行CAS操作，直到成功为止。具体的尝试次数与具体的并发环境有关。<br>我们在前面说过，在32位计算架构的计算机上写入一个64位的整数也会存在并发安全方面的隐患。因此，我们还应该将这段代码中的offset = df.roffset语句修改为offset = atomic.LoadInt64(&amp;df.roffset)。<br>除了这里，在*myDataFile类型的Rsn方法中也有针对roffset字段的读操作：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df.rmutex.Lock()</span><br><span class="line"><span class="keyword">defer</span> df.rmutex.Unlock()</span><br><span class="line"><span class="keyword">return</span> df.roffset / <span class="keyword">int64</span>(df.dataLen)</span><br></pre></td></tr></table></figure><p>我们现在去掉施加在上面的锁定和解锁操作，转而使用原子操作来实现它。修改后的代码如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">offset := atomic.LoadInt64(&amp;df.roffset)</span><br><span class="line"><span class="keyword">return</span> offset / <span class="keyword">int64</span>(df.dataLen)</span><br></pre></td></tr></table></figure><p>这样，我们就在依然保证相关操作的并发安全的前提下去除了对互斥锁rmutex的使用。对于字段woffset和互斥锁wmutex，我们也应该如法炮制。读者可以试着按照上面的方法修改与之相关的Write方法和Wsn方法。<br>在修改完成之后，我们就可以把代表互斥锁的rmutex字段和wmutex字段从<em>myDataFile类型的基本结构中去掉了。这样，该类型的基本结构会显得精简了不少。<br>通过本次改造，我们减少了</em>myDataFile类型及其方法对互斥锁的使用。这对该程度的性能和可伸缩性都会有一定的提升。其主要原因是，原子操作由底层硬件支持，而锁则由操作系统提供的API实现。若实现相同的功能，前者通常会更有效率。读者可以为前面展示的这三个版本的*myDataFile类型的实现编写性能测试，以验证上述观点的正确性。<br>总之，我们要善用原子操作。因为它比锁更加简练和高效。不过，由于原子操作自身的限制，锁依然常用且重要。</p>]]></content>
      
      
      <categories>
          
          <category> Golang并发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang并发之sync.WaitGroup</title>
      <link href="/sheldon_blog/passages/Golang%E5%B9%B6%E5%8F%91%E4%B9%8Bsync-WaitGroup/"/>
      <url>/sheldon_blog/passages/Golang%E5%B9%B6%E5%8F%91%E4%B9%8Bsync-WaitGroup/</url>
      
        <content type="html"><![CDATA[<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br></pre></td></tr></table></figure><h2 id="sync-WaitGroup-Golang内置sync包"><a href="#sync-WaitGroup-Golang内置sync包" class="headerlink" title="sync.WaitGroup/ Golang内置sync包"></a>sync.WaitGroup/ Golang内置sync包<a id="more"></a></h2><blockquote><p>Wg变量：该类型有三个指针方法，即Add、Done和Wait。</p><p>类型sync.WaitGroup是一个结构体类型。当一个sync.WaitGroup类型的变量被声明之后，其值中的那个计数值将会是0。 </p><p>我们可以通过该值的Add方法增大或减少其中的计数值。 如下：</p><p>wg.Add(1) </p><p>与wg.Add(-1)的执行效果是一致的： </p><p>wg.Done() </p><p>总结:</p><p>1、使用Done方法禁忌与Add方法的一样——不要让相应的计数值变为负数。 </p><p>例如，这段代码中的第5条语句会引发一个运行时恐慌： </p><p>var wg sync.WaitGroup </p><p>wg.Add(2) </p><p>wg.Done() </p><p>wg.Done() </p><p>wg.Done() </p><p>2、当我们调用sync.WaitGroup类型值的Wait方法的时候，它会去检查该值中的计数值。如果这个计数值为0，那么该方法会立即返回，且不会对程序的运行产生任何影响。 但是，如果这个计数值大于0，那么该方法的调用方所属的那个Goroutine就会被阻塞。直到该计数值重新变为0之时，为此而被阻塞的所有Goroutine才会被唤醒。 </p></blockquote><h2 id="代码案例"><a href="#代码案例" class="headerlink" title="代码案例"></a>代码案例</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 协调多个Goroutine的运行。假设，在我们的程序中启用了4个Goroutine，分别是G1、G2、G3和G4。其中，G2、G3和G4是由G1中的代码启用并被用于执行某些特定任务的。G1在启用这3个Goroutine之后要等待这些特定任务的完成。</span></span><br><span class="line"><span class="comment">// 方案1（channel通道）</span></span><br><span class="line">sign := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">byte</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//G2</span></span><br><span class="line">    sign &lt;- <span class="number">2</span></span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//G3</span></span><br><span class="line">    sign &lt;- <span class="number">3</span></span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//G4</span></span><br><span class="line">    sign &lt;- <span class="number">4</span></span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ &#123;</span><br><span class="line">fmt.Printf(<span class="string">"G%d is ended.\n"</span>, &lt;-sign)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 方案2（sync.WaitGroup）</span></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">wg.Add(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//G2</span></span><br><span class="line">    wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//G3</span></span><br><span class="line">    wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//G4</span></span><br><span class="line">    wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line">wg.Wait()</span><br><span class="line">fmt.Println(<span class="string">"Finish"</span>)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">     <span class="string">"fmt"</span></span><br><span class="line">     <span class="string">"sync"</span></span><br><span class="line">     <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">     <span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">     <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i = i + <span class="number">1</span> &#123;</span><br><span class="line">          wg.Add(<span class="number">1</span>)</span><br><span class="line">          <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">               <span class="comment">// defer wg.Done()</span></span><br><span class="line">               <span class="keyword">defer</span> wg.Add(<span class="number">-1</span>)</span><br><span class="line">               EchoNumber(n)</span><br><span class="line">          &#125;(i) <span class="comment">// n = i</span></span><br><span class="line">     &#125;</span><br><span class="line">     wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">EchoNumber</span><span class="params">(i <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">     time.Sleep(<span class="number">3e9</span>)</span><br><span class="line">     fmt.Println(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Golang并发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo入坑-主题篇</title>
      <link href="/sheldon_blog/passages/Hexo%E5%85%A5%E5%9D%91-%E4%B8%BB%E9%A2%98%E7%AF%87/"/>
      <url>/sheldon_blog/passages/Hexo%E5%85%A5%E5%9D%91-%E4%B8%BB%E9%A2%98%E7%AF%87/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo入坑-安装篇</title>
      <link href="/sheldon_blog/passages/Hexo%E5%85%A5%E5%9D%91-%E5%AE%89%E8%A3%85%E7%AF%87/"/>
      <url>/sheldon_blog/passages/Hexo%E5%85%A5%E5%9D%91-%E5%AE%89%E8%A3%85%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><ul><li><font size="3">有一个github账号，没有的话去注册一个</font></li><li><font size="3">安装了git、node.js、npm，并了解相关基础知识</font><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">git --version</span><br></pre></td></tr></table></figure></li><li><p><font size="3">安装了git for Mac（或者其它git客户端）</font><a id="more"></a></p></li></ul><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="1-创建github仓库"><a href="#1-创建github仓库" class="headerlink" title="1. 创建github仓库"></a>1. 创建github仓库</h3><p>​    github上新建一个名为<code>用户名.github.io</code>的项目，例如：sheldon-lu.github.io，</p><p>这个项目名是用来做域名用的，当然也可以去申请一个属于自己的域名，一般推荐<a href="https://www.GoDaddy.com/" target="_blank" rel="noopener"><code>godaddy</code></a></p><h3 id="2-配置SSH-key免密上传"><a href="#2-配置SSH-key免密上传" class="headerlink" title="2. 配置SSH key免密上传"></a>2. 配置SSH key免密上传</h3><p>不详细讲了，命令如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br><span class="line"><span class="meta">#</span> 检查本机已存在的ssh密钥</span><br><span class="line"><span class="meta">#</span> 如果提示：No such file or directory 说明你是第一次使用git。</span><br><span class="line">ssh-keygen -t rsa -C "邮件地址"</span><br><span class="line"><span class="meta">#</span> 然后连续3次回车，最终会生成一个文件在用户目录下，打开用户目录，找到.ssh\id_rsa.pub文件，记事本打开并复制里面的内容，打开你的github主页，进入个人设置 -&gt; SSH and GPG keys -&gt; New SSH key</span><br><span class="line"><span class="meta">#</span> 测试是否成功，验证命令：</span><br><span class="line">ssh -T git@GitHub.com</span><br><span class="line"><span class="meta">#</span># Hi cnfeat! You've successfully authenticated, but GitHub does not provide shell access.出现这个就是成功了，之后可以测试一下push是否免密上传。</span><br><span class="line"><span class="meta">#</span> 此时你可能还需要配置，这个属于全局config，对于git项目完全可以git clone下来之后进行push等等操作：</span><br><span class="line">git config --global user.name "liuxianan"// 你的github用户名，非昵称</span><br><span class="line">git config --global user.email  "xxx@qq.com"// 填写你的github注册邮箱</span><br></pre></td></tr></table></figure><h3 id="3-Hexo安装及介绍"><a href="#3-Hexo安装及介绍" class="headerlink" title="3. Hexo安装及介绍"></a>3. Hexo安装及介绍</h3><p>官网： <a href="http://hexo.io" target="_blank" rel="noopener">http://hexo.io</a> </p><p>github: <a href="https://github.com/hexojs/hexo" target="_blank" rel="noopener">https://github.com/hexojs/hexo</a> </p><p>由于github pages存放的都是静态文件，博客存放的不只是文章内容，还有文章列表、分类、标签、翻页等动态内容，假如每次写完一篇文章都要手动更新博文目录和相关链接信息，相信谁都会疯掉，所以hexo所做的就是将这些md文件都放在本地，每次写完文章后调用写好的命令来批量完成相关页面的生成，然后再将有改动的页面提交到github。 </p><p>安装之前先来说几个注意事项： </p><ol><li><p>很多命令既可以用Windows的cmd来完成，也可以使用git bash来完成，但是部分命令会有一些问题，为避免不必要的问题，建议全部使用git bash来执行（对于windows用户而言）； </p></li><li><p>hexo不同版本差别比较大，网上很多文章的配置信息都是基于2.x的，所以注意不要被误导； </p></li><li><p>hexo有2种_config.yml文件，一个是根目录下的全局的_config.yml，一个是各个theme下的； </p></li></ol><p>这里给官网上的部署命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mkdir &lt;Your blog&gt; # 创建blog文档文件夹</span><br><span class="line">npm install hexo-cli -g # 安装hexo以及hexo命令</span><br><span class="line"><span class="meta">#</span> 初始化一个blog项目，其中'blog'为你的blog名字，hexo会自动下载一些文件到这个目录，包括node_modules.</span><br><span class="line">hexo init blog</span><br><span class="line">cd blog</span><br><span class="line">npm install</span><br><span class="line">hexo server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># 这两个命令是经常会用到的</span><br><span class="line">hexo s -g #生成并本地预览</span><br><span class="line">hexo d -g #生成并上传</span><br></pre></td></tr></table></figure><p>对于mac用户，如果遇到以下报错：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">安装npm install hexo-cli -g时报错</span><br><span class="line">npm install hexo -g</span><br><span class="line">npm WARN locking Error: EACCES, open &apos;/Users/lushenneng/.npm/_locks/hexo-4ded2cf5ea4a8daa.lock&apos;</span><br><span class="line">npm WARN locking at Error (native)</span><br><span class="line">npm WARN locking /Users/lushenneng/.npm/_locks/hexo-4ded2cf5ea4a8daa.lock failed &#123; [Error: EACCES, open &apos;/Users/lushenneng/.npm/_locks/hexo-4ded2cf5ea4a8daa.lock&apos;]</span><br><span class="line">npm WARN locking errno: -13,</span><br><span class="line">npm WARN locking code: &apos;EACCES&apos;,</span><br><span class="line">npm WARN locking path: &apos;/Users/lushenneng/.npm/_locks/hexo-4ded2cf5ea4a8daa.lock&apos; &#125;</span><br><span class="line">npm ERR! Darwin 14.0.0</span><br><span class="line">npm ERR! argv &quot;node&quot; &quot;/usr/bin/npm&quot; &quot;install&quot; &quot;hexo&quot; &quot;-g&quot;</span><br><span class="line">npm ERR! node v0.12.3</span><br><span class="line">npm ERR! npm v2.9.1</span><br><span class="line">npm ERR! Attempt to unlock /usr/lib/node_modules/hexo, which hasn&apos;t been locked</span><br><span class="line">npm ERR!</span><br><span class="line">npm ERR! If you need help, you may report this error at:</span><br><span class="line">npm ERR! https://github.com/npm/npm/issues</span><br><span class="line">npm ERR! Please include the following file with any support request:</span><br><span class="line">npm ERR! /Users/lushenneng/blog/npm-debug.log</span><br></pre></td></tr></table></figure><p>解决：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 可以先用这个命令：</span><br><span class="line">sudo npm install hexo-cli -g</span><br><span class="line"><span class="meta">#</span> 如果还是报错可以用这个命令：</span><br><span class="line">sudo npm install --unsafe-perm --verbose -g hexo</span><br><span class="line"><span class="meta">#</span> 加上sudo一般能解决很多问题</span><br></pre></td></tr></table></figure><h3 id="4-START-Hexo"><a href="#4-START-Hexo" class="headerlink" title="4. START Hexo"></a>4. START Hexo</h3><p>在blog目录下的_config.yml配置修改如下：(大概是在最后一行)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository:</span><br><span class="line">    github: git@github.com:sheldon-lu/sheldon_blog.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>我这里不指定用的github.io这个域名是因为我用sheldon-lu.github.io作主域名，sheldon_blog作文根，当然这样的话这边hexo内设置如下：(大概在14行左右开始)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># URL</span><br><span class="line">## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;</span><br><span class="line">url: https://sheldon-lu.github.io/</span><br><span class="line">root: /sheldon_blog</span><br><span class="line"># permalink: :year/:month/:day/:title/</span><br><span class="line">permalink: passages/:title/</span><br><span class="line">permalink_defaults:</span><br></pre></td></tr></table></figure><p>至此，就可以使用了，浏览器输入域名：<a href="https://sheldon-lu.github.io/sheldon_blog即可">https://sheldon-lu.github.io/sheldon_blog即可</a></p><hr><p><code>1、这里要说明一下，使用 hexo d 上传至github时如果需要用到 gh-pages 的话，记得在自己github的blog项目下创建个gh-pages的分支，即可;</code></p><p><code>2、_config.yml中配置repository时一定配置的要是ssh，别弄的什么https://github之类的</code></p><p>参考地址：<a href="https://ngwind.github.io/2018/07/27/%E4%BD%BF%E7%94%A8gh-pages+Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%BD%91%E9%A1%B5%E6%95%99%E7%A8%8B/" target="_blank" rel="noopener">https://ngwind.github.io/2018/07/27/%E4%BD%BF%E7%94%A8gh-pages+Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%BD%91%E9%A1%B5%E6%95%99%E7%A8%8B/</a></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
